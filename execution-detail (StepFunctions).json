{"flattenDefinition":{"AggregateResults":{"RawDefinition":"{\n  \"End\": true,\n  \"Parameters\": {\n    \"FunctionName\": \"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-AggregatorFunction-Y2rymTfjXt28\",\n    \"Payload.$\": \"$\"\n  },\n  \"Resource\": \"arn:aws:states:::lambda:invoke\",\n  \"Type\": \"Task\"\n}","Name":"AggregateResults","Type":"Task","Resource":"arn:aws:states:::lambda:invoke","Parameters":{"FunctionName":"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-AggregatorFunction-Y2rymTfjXt28","Payload.$":"$"},"End":true,"StartingState":false,"Parent":null,"Parallel":{"BranchNumber":null,"BranchCount":null},"RoleArn.$":null,"ExternalId.$":null},"ParallelScans":{"RawDefinition":"{\n  \"ItemsPath\": \"$.analysis_types\",\n  \"Iterator\": {\n    \"StartAt\": \"RunScanner\",\n    \"States\": {\n      \"RunScanner\": {\n        \"End\": true,\n        \"Parameters\": {\n          \"FunctionName.$\": \"$.function_name\",\n          \"Payload.$\": \"$.payload\"\n        },\n        \"Resource\": \"arn:aws:states:::lambda:invoke\",\n        \"Type\": \"Task\"\n      }\n    }\n  },\n  \"Next\": \"AggregateResults\",\n  \"ResultPath\": \"$.scan_results\",\n  \"Type\": \"Map\"\n}","Name":"ParallelScans","Type":"Map","Next":"AggregateResults","ResultPath":"$.scan_results","ItemsPath":"$.analysis_types","StartingState":true,"Parent":null,"Parallel":{"BranchNumber":null,"BranchCount":null},"Iterator":{"StartAt":"RunScanner","States":{"RunScanner":{"End":true,"Parameters":{"FunctionName.$":"$.function_name","Payload.$":"$.payload"},"Resource":"arn:aws:states:::lambda:invoke","Type":"Task"}}},"RoleArn.$":null,"ExternalId.$":null},"RunScanner":{"RawDefinition":"{\n  \"End\": true,\n  \"Parameters\": {\n    \"FunctionName.$\": \"$.function_name\",\n    \"Payload.$\": \"$.payload\"\n  },\n  \"Resource\": \"arn:aws:states:::lambda:invoke\",\n  \"Type\": \"Task\"\n}","Name":"RunScanner","Type":"Task","Resource":"arn:aws:states:::lambda:invoke","Parameters":{"FunctionName.$":"$.function_name","Payload.$":"$.payload"},"End":true,"StartingState":true,"Parent":"ParallelScans","Parallel":{"BranchNumber":null,"BranchCount":null},"RoleArn.$":null,"ExternalId.$":null}},"execution":{"$metadata":{"httpStatusCode":200,"requestId":"ddd59436-ea73-477a-9ffb-a0153612c98c","attempts":1,"totalRetryDelay":0},"executionArn":"arn:aws:states:us-east-1:390402580689:execution:AnalysisStateMachine-zuJ7oO11tsut:pr-belumume-sentinel-testbed-32-ba67c8c","input":"{\"repo_details\": {\"pull_request_id\": \"2625925773\", \"repository_full_name\": \"belumume/sentinel-testbed\", \"commit_sha\": \"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\", \"pr_number\": 32}, \"analysis_types\": [{\"type\": \"secrets\", \"function_name\": \"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-SecretScannerFunction-w0XQI2GV65HU\", \"payload\": {\"repo_details\": {\"pull_request_id\": \"2625925773\", \"repository_full_name\": \"belumume/sentinel-testbed\", \"commit_sha\": \"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\", \"pr_number\": 32}}}, {\"type\": \"vulnerabilities\", \"function_name\": \"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-VulnerabilityScannerFunction-Fk7ek2H2Mdqn\", \"payload\": {\"repo_details\": {\"pull_request_id\": \"2625925773\", \"repository_full_name\": \"belumume/sentinel-testbed\", \"commit_sha\": \"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\", \"pr_number\": 32}}}, {\"type\": \"ai_review\", \"function_name\": \"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-AIReviewerFunction-O4EWbVoTnbOd\", \"payload\": {\"repo_details\": {\"pull_request_id\": \"2625925773\", \"repository_full_name\": \"belumume/sentinel-testbed\", \"commit_sha\": \"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\", \"pr_number\": 32}}}]}","inputDetails":{"__type":"com.amazonaws.swf.base.model#CloudWatchEventsExecutionDataDetails","included":true},"name":"pr-belumume-sentinel-testbed-32-ba67c8c","output":"{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"aggregation_complete\":true,\"findings_summary\":{\"secrets_found\":22,\"vulnerabilities_found\":0,\"ai_suggestions\":21},\"github_comment_posted\":true},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"4a4c99d8-b8ff-4451-84ec-783a29b803f5\"],\"Content-Length\":[\"173\"],\"Date\":[\"Sat, 28 Jun 2025 08:12:00 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=2ef7bb7fce192f6a;Sampled=0;Lineage=2:d0648a6a:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"173\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:12:00 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"4a4c99d8-b8ff-4451-84ec-783a29b803f5\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=2ef7bb7fce192f6a;Sampled=0;Lineage=2:d0648a6a:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"4a4c99d8-b8ff-4451-84ec-783a29b803f5\"},\"StatusCode\":200}","outputDetails":{"__type":"com.amazonaws.swf.base.model#CloudWatchEventsExecutionDataDetails","included":true},"redriveCount":0,"redriveStatus":"NOT_REDRIVABLE","redriveStatusReason":"Execution is SUCCEEDED and cannot be redriven","startDate":"2025-06-28T08:11:23.568Z","stateMachineArn":"arn:aws:states:us-east-1:390402580689:stateMachine:AnalysisStateMachine-zuJ7oO11tsut","status":"SUCCEEDED","stopDate":"2025-06-28T08:12:00.389Z","traceHeader":"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=7a615567b42082a5;Sampled=0"},"historyHash":{"1":{"executionStartedEventDetails":{"input":"{\"repo_details\": {\"pull_request_id\": \"2625925773\", \"repository_full_name\": \"belumume/sentinel-testbed\", \"commit_sha\": \"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\", \"pr_number\": 32}, \"analysis_types\": [{\"type\": \"secrets\", \"function_name\": \"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-SecretScannerFunction-w0XQI2GV65HU\", \"payload\": {\"repo_details\": {\"pull_request_id\": \"2625925773\", \"repository_full_name\": \"belumume/sentinel-testbed\", \"commit_sha\": \"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\", \"pr_number\": 32}}}, {\"type\": \"vulnerabilities\", \"function_name\": \"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-VulnerabilityScannerFunction-Fk7ek2H2Mdqn\", \"payload\": {\"repo_details\": {\"pull_request_id\": \"2625925773\", \"repository_full_name\": \"belumume/sentinel-testbed\", \"commit_sha\": \"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\", \"pr_number\": 32}}}, {\"type\": \"ai_review\", \"function_name\": \"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-AIReviewerFunction-O4EWbVoTnbOd\", \"payload\": {\"repo_details\": {\"pull_request_id\": \"2625925773\", \"repository_full_name\": \"belumume/sentinel-testbed\", \"commit_sha\": \"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\", \"pr_number\": 32}}}]}","inputDetails":{"truncated":false},"roleArn":"arn:aws:iam::390402580689:role/devsecops-sentinel-StateMachineRole-pLZD37MpMyDm"},"id":1,"previousEventId":0,"timestamp":"2025-06-28T08:11:23.568Z","type":"ExecutionStarted","redriveId":0},"2":{"id":2,"previousEventId":0,"stateEnteredEventDetails":{"input":"{\"repo_details\": {\"pull_request_id\": \"2625925773\", \"repository_full_name\": \"belumume/sentinel-testbed\", \"commit_sha\": \"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\", \"pr_number\": 32}, \"analysis_types\": [{\"type\": \"secrets\", \"function_name\": \"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-SecretScannerFunction-w0XQI2GV65HU\", \"payload\": {\"repo_details\": {\"pull_request_id\": \"2625925773\", \"repository_full_name\": \"belumume/sentinel-testbed\", \"commit_sha\": \"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\", \"pr_number\": 32}}}, {\"type\": \"vulnerabilities\", \"function_name\": \"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-VulnerabilityScannerFunction-Fk7ek2H2Mdqn\", \"payload\": {\"repo_details\": {\"pull_request_id\": \"2625925773\", \"repository_full_name\": \"belumume/sentinel-testbed\", \"commit_sha\": \"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\", \"pr_number\": 32}}}, {\"type\": \"ai_review\", \"function_name\": \"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-AIReviewerFunction-O4EWbVoTnbOd\", \"payload\": {\"repo_details\": {\"pull_request_id\": \"2625925773\", \"repository_full_name\": \"belumume/sentinel-testbed\", \"commit_sha\": \"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\", \"pr_number\": 32}}}]}","inputDetails":{"truncated":false},"name":"ParallelScans"},"timestamp":"2025-06-28T08:11:23.600Z","type":"MapStateEntered","redriveId":0,"stepName":"ParallelScans"},"3":{"id":3,"mapStateStartedEventDetails":{"length":3},"previousEventId":2,"timestamp":"2025-06-28T08:11:23.600Z","type":"MapStateStarted","redriveId":0,"stepName":"ParallelScans"},"4":{"id":4,"mapIterationStartedEventDetails":{"index":0,"name":"ParallelScans"},"previousEventId":3,"timestamp":"2025-06-28T08:11:23.600Z","type":"MapIterationStarted","redriveId":0,"stepName":"ParallelScans"},"5":{"id":5,"mapIterationStartedEventDetails":{"index":1,"name":"ParallelScans"},"previousEventId":3,"timestamp":"2025-06-28T08:11:23.600Z","type":"MapIterationStarted","redriveId":0,"stepName":"ParallelScans"},"6":{"id":6,"mapIterationStartedEventDetails":{"index":2,"name":"ParallelScans"},"previousEventId":3,"timestamp":"2025-06-28T08:11:23.600Z","type":"MapIterationStarted","redriveId":0,"stepName":"ParallelScans"},"7":{"id":7,"previousEventId":4,"stateEnteredEventDetails":{"input":"{\"type\":\"secrets\",\"function_name\":\"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-SecretScannerFunction-w0XQI2GV65HU\",\"payload\":{\"repo_details\":{\"pull_request_id\":\"2625925773\",\"repository_full_name\":\"belumume/sentinel-testbed\",\"commit_sha\":\"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\",\"pr_number\":32}}}","inputDetails":{"truncated":false},"name":"RunScanner"},"timestamp":"2025-06-28T08:11:23.600Z","type":"TaskStateEntered","redriveId":0,"stepName":"RunScanner"},"8":{"id":8,"previousEventId":7,"taskScheduledEventDetails":{"parameters":{"FunctionName":"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-SecretScannerFunction-w0XQI2GV65HU","Payload":{"repo_details":{"pull_request_id":"2625925773","repository_full_name":"belumume/sentinel-testbed","commit_sha":"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f","pr_number":32}}},"region":"us-east-1","resource":"invoke","resourceType":"lambda"},"timestamp":"2025-06-28T08:11:23.600Z","type":"TaskScheduled","redriveId":0,"stepName":"RunScanner"},"9":{"id":9,"previousEventId":5,"stateEnteredEventDetails":{"input":"{\"type\":\"vulnerabilities\",\"function_name\":\"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-VulnerabilityScannerFunction-Fk7ek2H2Mdqn\",\"payload\":{\"repo_details\":{\"pull_request_id\":\"2625925773\",\"repository_full_name\":\"belumume/sentinel-testbed\",\"commit_sha\":\"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\",\"pr_number\":32}}}","inputDetails":{"truncated":false},"name":"RunScanner"},"timestamp":"2025-06-28T08:11:23.600Z","type":"TaskStateEntered","redriveId":0,"stepName":"RunScanner"},"10":{"id":10,"previousEventId":9,"taskScheduledEventDetails":{"parameters":{"FunctionName":"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-VulnerabilityScannerFunction-Fk7ek2H2Mdqn","Payload":{"repo_details":{"pull_request_id":"2625925773","repository_full_name":"belumume/sentinel-testbed","commit_sha":"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f","pr_number":32}}},"region":"us-east-1","resource":"invoke","resourceType":"lambda"},"timestamp":"2025-06-28T08:11:23.600Z","type":"TaskScheduled","redriveId":0,"stepName":"RunScanner"},"11":{"id":11,"previousEventId":6,"stateEnteredEventDetails":{"input":"{\"type\":\"ai_review\",\"function_name\":\"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-AIReviewerFunction-O4EWbVoTnbOd\",\"payload\":{\"repo_details\":{\"pull_request_id\":\"2625925773\",\"repository_full_name\":\"belumume/sentinel-testbed\",\"commit_sha\":\"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\",\"pr_number\":32}}}","inputDetails":{"truncated":false},"name":"RunScanner"},"timestamp":"2025-06-28T08:11:23.600Z","type":"TaskStateEntered","redriveId":0,"stepName":"RunScanner"},"12":{"id":12,"previousEventId":11,"taskScheduledEventDetails":{"parameters":{"FunctionName":"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-AIReviewerFunction-O4EWbVoTnbOd","Payload":{"repo_details":{"pull_request_id":"2625925773","repository_full_name":"belumume/sentinel-testbed","commit_sha":"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f","pr_number":32}}},"region":"us-east-1","resource":"invoke","resourceType":"lambda"},"timestamp":"2025-06-28T08:11:23.600Z","type":"TaskScheduled","redriveId":0,"stepName":"RunScanner"},"13":{"id":13,"previousEventId":12,"taskStartedEventDetails":{"resource":"invoke","resourceType":"lambda"},"timestamp":"2025-06-28T08:11:23.683Z","type":"TaskStarted","redriveId":0,"stepName":"RunScanner"},"14":{"id":14,"previousEventId":10,"taskStartedEventDetails":{"resource":"invoke","resourceType":"lambda"},"timestamp":"2025-06-28T08:11:23.686Z","type":"TaskStarted","redriveId":0,"stepName":"RunScanner"},"15":{"id":15,"previousEventId":8,"taskStartedEventDetails":{"resource":"invoke","resourceType":"lambda"},"timestamp":"2025-06-28T08:11:23.687Z","type":"TaskStarted","redriveId":0,"stepName":"RunScanner"},"16":{"id":16,"previousEventId":14,"taskSucceededEventDetails":{"output":"{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"scanner_type\":\"vulnerabilities\",\"findings\":[],\"summary\":{\"total_findings\":0,\"by_severity\":{},\"by_language\":{}}},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"0f8f7504-f819-429a-bce4-4c7615c218a3\"],\"Content-Length\":[\"142\"],\"Date\":[\"Sat, 28 Jun 2025 08:11:23 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=0fe9df82f88a24aa;Sampled=0;Lineage=2:9da352f3:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"142\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:11:23 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"0f8f7504-f819-429a-bce4-4c7615c218a3\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=0fe9df82f88a24aa;Sampled=0;Lineage=2:9da352f3:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"0f8f7504-f819-429a-bce4-4c7615c218a3\"},\"StatusCode\":200}","outputDetails":{"truncated":false},"resource":"invoke","resourceType":"lambda"},"timestamp":"2025-06-28T08:11:23.781Z","type":"TaskSucceeded","redriveId":0,"stepName":"RunScanner"},"17":{"id":17,"previousEventId":16,"stateExitedEventDetails":{"name":"RunScanner","output":"{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"scanner_type\":\"vulnerabilities\",\"findings\":[],\"summary\":{\"total_findings\":0,\"by_severity\":{},\"by_language\":{}}},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"0f8f7504-f819-429a-bce4-4c7615c218a3\"],\"Content-Length\":[\"142\"],\"Date\":[\"Sat, 28 Jun 2025 08:11:23 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=0fe9df82f88a24aa;Sampled=0;Lineage=2:9da352f3:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"142\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:11:23 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"0f8f7504-f819-429a-bce4-4c7615c218a3\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=0fe9df82f88a24aa;Sampled=0;Lineage=2:9da352f3:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"0f8f7504-f819-429a-bce4-4c7615c218a3\"},\"StatusCode\":200}","outputDetails":{"truncated":false}},"timestamp":"2025-06-28T08:11:23.800Z","type":"TaskStateExited","redriveId":0,"stepName":"RunScanner"},"18":{"id":18,"mapIterationSucceededEventDetails":{"index":1,"name":"ParallelScans"},"previousEventId":17,"timestamp":"2025-06-28T08:11:23.800Z","type":"MapIterationSucceeded","redriveId":0,"stepName":"ParallelScans"},"19":{"id":19,"previousEventId":15,"taskSucceededEventDetails":{"output":"{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"scanner_type\":\"secrets\",\"findings\":[{\"type\":\"API Key (Pattern Match)\",\"file\":\"test-production-v2.txt\",\"line\":3,\"raw\":\"sk-1234567890abcdef1234567890abcdef12345678\"},{\"type\":\"GitHub Token (Pattern Match)\",\"file\":\"test-production-v2.txt\",\"line\":4,\"raw\":\"ghp_1234567890abcdef1234567890abcdef1234\"},{\"type\":\"AWS Secret Key (Pattern Match)\",\"file\":\"test-production-v2.txt\",\"line\":5,\"raw\":\"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\"test-production.txt\",\"line\":3,\"raw\":\"sk-1234567890abcdef1234567890abcdef12345678\"},{\"type\":\"GitHub Token (Pattern Match)\",\"file\":\"test-production.txt\",\"line\":4,\"raw\":\"ghp_1234567890abcdef1234567890abcdef1234\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\"Dockerfile\",\"line\":15,\"raw\":\"sk_test_1234567890abcdef\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"Dockerfile\",\"line\":16,\"raw\":\"supersecret123\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"Dockerfile\",\"line\":16,\"raw\":\"supersecret123\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\".env.example\",\"line\":2,\"raw\":\"another_secret_password_123\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\".env.example\",\"line\":2,\"raw\":\"another_secret_password_123\"},{\"type\":\"Connection String (Pattern Match)\",\"file\":\".env.example\",\"line\":3,\"raw\":\"postgresql://user:secret123@localhost:5432/mydb\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\".env.example\",\"line\":6,\"raw\":\"sk-1234567890abcdefghijklmnopqrstuvwxyz1234567890a...\"},{\"type\":\"OpenAI API Key (Pattern Match)\",\"file\":\".env.example\",\"line\":6,\"raw\":\"sk-1234567890abcdefghijklmnopqrstuvwxyz1234567890a...\"},{\"type\":\"JWT Secret (Pattern Match)\",\"file\":\".env.example\",\"line\":10,\"raw\":\"my_super_secret_jwt_key_that_should_not_be_hardcod...\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\"README.md\",\"line\":6,\"raw\":\"sk_test_1234567890abcdef\"},{\"type\":\"AWS Access Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":15,\"raw\":\"AKIAIOSFODNN7EXAMPLE\"},{\"type\":\"AWS Secret Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":16,\"raw\":\"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"},{\"type\":\"Secret Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":19,\"raw\":\"sk_test_4eC39HqLyjWDarjtT1zdp7dc\"},{\"type\":\"Stripe Test Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":19,\"raw\":\"sk_test_4eC39HqLyjWDarjtT1zdp7dc\"},{\"type\":\"GitHub Token (Pattern Match)\",\"file\":\"config/database.py\",\"line\":20,\"raw\":\"ghp_1234567890abcdefghijklmnopqrstuvwxyz\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"config/database.py\",\"line\":29,\"raw\":\"DATABASE_CONFIG[\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"src/user_auth.py\",\"line\":15,\"raw\":\"{self.hash_password(password)}\"}],\"summary\":{\"total_findings\":22}},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"d13672c8-f96d-4a9c-a382-6944b79168ac\"],\"Content-Length\":[\"2886\"],\"Date\":[\"Sat, 28 Jun 2025 08:11:39 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=5e0356b90ed3a285;Sampled=0;Lineage=2:06d0fbab:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"2886\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:11:39 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"d13672c8-f96d-4a9c-a382-6944b79168ac\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=5e0356b90ed3a285;Sampled=0;Lineage=2:06d0fbab:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"d13672c8-f96d-4a9c-a382-6944b79168ac\"},\"StatusCode\":200}","outputDetails":{"truncated":false},"resource":"invoke","resourceType":"lambda"},"timestamp":"2025-06-28T08:11:39.785Z","type":"TaskSucceeded","redriveId":0,"stepName":"RunScanner"},"20":{"id":20,"previousEventId":19,"stateExitedEventDetails":{"name":"RunScanner","output":"{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"scanner_type\":\"secrets\",\"findings\":[{\"type\":\"API Key (Pattern Match)\",\"file\":\"test-production-v2.txt\",\"line\":3,\"raw\":\"sk-1234567890abcdef1234567890abcdef12345678\"},{\"type\":\"GitHub Token (Pattern Match)\",\"file\":\"test-production-v2.txt\",\"line\":4,\"raw\":\"ghp_1234567890abcdef1234567890abcdef1234\"},{\"type\":\"AWS Secret Key (Pattern Match)\",\"file\":\"test-production-v2.txt\",\"line\":5,\"raw\":\"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\"test-production.txt\",\"line\":3,\"raw\":\"sk-1234567890abcdef1234567890abcdef12345678\"},{\"type\":\"GitHub Token (Pattern Match)\",\"file\":\"test-production.txt\",\"line\":4,\"raw\":\"ghp_1234567890abcdef1234567890abcdef1234\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\"Dockerfile\",\"line\":15,\"raw\":\"sk_test_1234567890abcdef\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"Dockerfile\",\"line\":16,\"raw\":\"supersecret123\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"Dockerfile\",\"line\":16,\"raw\":\"supersecret123\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\".env.example\",\"line\":2,\"raw\":\"another_secret_password_123\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\".env.example\",\"line\":2,\"raw\":\"another_secret_password_123\"},{\"type\":\"Connection String (Pattern Match)\",\"file\":\".env.example\",\"line\":3,\"raw\":\"postgresql://user:secret123@localhost:5432/mydb\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\".env.example\",\"line\":6,\"raw\":\"sk-1234567890abcdefghijklmnopqrstuvwxyz1234567890a...\"},{\"type\":\"OpenAI API Key (Pattern Match)\",\"file\":\".env.example\",\"line\":6,\"raw\":\"sk-1234567890abcdefghijklmnopqrstuvwxyz1234567890a...\"},{\"type\":\"JWT Secret (Pattern Match)\",\"file\":\".env.example\",\"line\":10,\"raw\":\"my_super_secret_jwt_key_that_should_not_be_hardcod...\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\"README.md\",\"line\":6,\"raw\":\"sk_test_1234567890abcdef\"},{\"type\":\"AWS Access Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":15,\"raw\":\"AKIAIOSFODNN7EXAMPLE\"},{\"type\":\"AWS Secret Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":16,\"raw\":\"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"},{\"type\":\"Secret Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":19,\"raw\":\"sk_test_4eC39HqLyjWDarjtT1zdp7dc\"},{\"type\":\"Stripe Test Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":19,\"raw\":\"sk_test_4eC39HqLyjWDarjtT1zdp7dc\"},{\"type\":\"GitHub Token (Pattern Match)\",\"file\":\"config/database.py\",\"line\":20,\"raw\":\"ghp_1234567890abcdefghijklmnopqrstuvwxyz\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"config/database.py\",\"line\":29,\"raw\":\"DATABASE_CONFIG[\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"src/user_auth.py\",\"line\":15,\"raw\":\"{self.hash_password(password)}\"}],\"summary\":{\"total_findings\":22}},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"d13672c8-f96d-4a9c-a382-6944b79168ac\"],\"Content-Length\":[\"2886\"],\"Date\":[\"Sat, 28 Jun 2025 08:11:39 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=5e0356b90ed3a285;Sampled=0;Lineage=2:06d0fbab:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"2886\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:11:39 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"d13672c8-f96d-4a9c-a382-6944b79168ac\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=5e0356b90ed3a285;Sampled=0;Lineage=2:06d0fbab:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"d13672c8-f96d-4a9c-a382-6944b79168ac\"},\"StatusCode\":200}","outputDetails":{"truncated":false}},"timestamp":"2025-06-28T08:11:39.804Z","type":"TaskStateExited","redriveId":0,"stepName":"RunScanner"},"21":{"id":21,"mapIterationSucceededEventDetails":{"index":0,"name":"ParallelScans"},"previousEventId":20,"timestamp":"2025-06-28T08:11:39.804Z","type":"MapIterationSucceeded","redriveId":0,"stepName":"ParallelScans"},"22":{"id":22,"previousEventId":13,"taskSucceededEventDetails":{"output":"{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"scanner_type\":\"ai_review\",\"findings\":[{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\".env.example\",\"line\":1,\"description\":\"Sensitive information exposed in .env.example file\",\"recommendation\":\"Remove all real API keys, passwords, and secrets from .env.example. Use placeholder values instead.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"Dockerfile\",\"line\":15,\"description\":\"Sensitive environment variables hardcoded in Dockerfile\",\"recommendation\":\"Remove API_KEY and DB_PASSWORD from Dockerfile. Use environment variables or secrets management instead.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"README.md\",\"line\":6,\"description\":\"API key exposed in README file\",\"recommendation\":\"Remove the API_KEY from the README file. Never commit sensitive information to version control.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"config/database.py\",\"line\":9,\"description\":\"Hardcoded database credentials in source code\",\"recommendation\":\"Remove hardcoded credentials and use environment variables or a secure configuration management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"config/database.py\",\"line\":15,\"description\":\"AWS credentials exposed in source code\",\"recommendation\":\"Remove AWS credentials from source code. Use AWS IAM roles or environment variables instead.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"config/database.py\",\"line\":19,\"description\":\"Stripe and GitHub tokens exposed in source code\",\"recommendation\":\"Remove Stripe and GitHub tokens from source code. Use environment variables or a secure secret management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/file_upload.py\",\"line\":24,\"description\":\"Arbitrary code execution vulnerability in file upload\",\"recommendation\":\"Remove the os.system call. Never execute uploaded files directly. Implement proper file validation and sandboxing.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/file_upload.py\",\"line\":33,\"description\":\"Path traversal vulnerability in file download\",\"recommendation\":\"Validate and sanitize the filename to prevent path traversal attacks. Use os.path.basename() and restrict to a specific directory.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":15,\"description\":\"SQL injection vulnerability in authentication query\",\"recommendation\":\"Use parameterized queries instead of string formatting to prevent SQL injection attacks.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":32,\"description\":\"Weak password hashing algorithm (MD5)\",\"recommendation\":\"Replace MD5 with a strong, modern hashing algorithm like bcrypt, Argon2, or PBKDF2.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":40,\"description\":\"SQL injection vulnerability in password reset functionality\",\"recommendation\":\"Use parameterized queries instead of string formatting to prevent SQL injection attacks.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":48,\"description\":\"Insecure admin access check using request headers\",\"recommendation\":\"Remove the header-based admin override. Implement proper authentication and authorization checks.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"test-production-v2.txt\",\"line\":3,\"description\":\"Sensitive API keys and tokens exposed in plain text file\",\"recommendation\":\"Remove all API keys, tokens, and secrets from this file. Use environment variables or a secure secrets management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"test-production.txt\",\"line\":3,\"description\":\"Sensitive API keys and tokens exposed in plain text file\",\"recommendation\":\"Remove all API keys and tokens from this file. Use environment variables or a secure secrets management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Best Practices\",\"priority\":\"medium\",\"file\":\"Dockerfile\",\"line\":3,\"description\":\"Using outdated Ubuntu base image\",\"recommendation\":\"Update to a more recent Ubuntu LTS version or consider using a more lightweight base image like Alpine.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"medium\",\"file\":\"Dockerfile\",\"line\":6,\"description\":\"Running container as root user\",\"recommendation\":\"Create a non-root user and use the USER instruction to run the container with least privileges.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"medium\",\"file\":\"Dockerfile\",\"line\":26,\"description\":\"Unnecessary ports exposed in Dockerfile\",\"recommendation\":\"Only expose the ports that are actually needed for the application to function.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"package.json\",\"line\":1,\"description\":\"Multiple outdated dependencies with known vulnerabilities\",\"recommendation\":\"Update all dependencies to their latest secure versions, especially lodash, moment, express, mongoose, and others.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"requirements.txt\",\"line\":1,\"description\":\"Multiple outdated Python dependencies with known vulnerabilities\",\"recommendation\":\"Update all dependencies to their latest secure versions, especially Django, requests, PyYAML, urllib3, Flask, and others.\"},{\"type\":\"ai_suggestion\",\"category\":\"Maintainability\",\"priority\":\"medium\",\"file\":\"src/file_upload.py\",\"line\":1,\"description\":\"Lack of input validation and error handling in file operations\",\"recommendation\":\"Implement proper input validation, error handling, and logging for all file operations.\"},{\"type\":\"ai_suggestion\",\"category\":\"Maintainability\",\"priority\":\"medium\",\"file\":\"src/user_auth.py\",\"line\":1,\"description\":\"Lack of proper error handling and logging in authentication functions\",\"recommendation\":\"Implement proper error handling, logging, and security event auditing for all authentication-related functions.\"}],\"summary\":{\"total_findings\":21,\"high_priority\":16,\"medium_priority\":5,\"low_priority\":0}},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"305be4c6-9ff3-4077-93f5-a11917966695\"],\"Content-Length\":[\"6524\"],\"Date\":[\"Sat, 28 Jun 2025 08:11:58 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=6a7d674b55504166;Sampled=0;Lineage=2:c73855c7:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"6524\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:11:58 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"305be4c6-9ff3-4077-93f5-a11917966695\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=6a7d674b55504166;Sampled=0;Lineage=2:c73855c7:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"305be4c6-9ff3-4077-93f5-a11917966695\"},\"StatusCode\":200}","outputDetails":{"truncated":false},"resource":"invoke","resourceType":"lambda"},"timestamp":"2025-06-28T08:11:58.127Z","type":"TaskSucceeded","redriveId":0,"stepName":"RunScanner"},"23":{"id":23,"previousEventId":22,"stateExitedEventDetails":{"name":"RunScanner","output":"{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"scanner_type\":\"ai_review\",\"findings\":[{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\".env.example\",\"line\":1,\"description\":\"Sensitive information exposed in .env.example file\",\"recommendation\":\"Remove all real API keys, passwords, and secrets from .env.example. Use placeholder values instead.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"Dockerfile\",\"line\":15,\"description\":\"Sensitive environment variables hardcoded in Dockerfile\",\"recommendation\":\"Remove API_KEY and DB_PASSWORD from Dockerfile. Use environment variables or secrets management instead.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"README.md\",\"line\":6,\"description\":\"API key exposed in README file\",\"recommendation\":\"Remove the API_KEY from the README file. Never commit sensitive information to version control.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"config/database.py\",\"line\":9,\"description\":\"Hardcoded database credentials in source code\",\"recommendation\":\"Remove hardcoded credentials and use environment variables or a secure configuration management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"config/database.py\",\"line\":15,\"description\":\"AWS credentials exposed in source code\",\"recommendation\":\"Remove AWS credentials from source code. Use AWS IAM roles or environment variables instead.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"config/database.py\",\"line\":19,\"description\":\"Stripe and GitHub tokens exposed in source code\",\"recommendation\":\"Remove Stripe and GitHub tokens from source code. Use environment variables or a secure secret management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/file_upload.py\",\"line\":24,\"description\":\"Arbitrary code execution vulnerability in file upload\",\"recommendation\":\"Remove the os.system call. Never execute uploaded files directly. Implement proper file validation and sandboxing.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/file_upload.py\",\"line\":33,\"description\":\"Path traversal vulnerability in file download\",\"recommendation\":\"Validate and sanitize the filename to prevent path traversal attacks. Use os.path.basename() and restrict to a specific directory.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":15,\"description\":\"SQL injection vulnerability in authentication query\",\"recommendation\":\"Use parameterized queries instead of string formatting to prevent SQL injection attacks.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":32,\"description\":\"Weak password hashing algorithm (MD5)\",\"recommendation\":\"Replace MD5 with a strong, modern hashing algorithm like bcrypt, Argon2, or PBKDF2.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":40,\"description\":\"SQL injection vulnerability in password reset functionality\",\"recommendation\":\"Use parameterized queries instead of string formatting to prevent SQL injection attacks.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":48,\"description\":\"Insecure admin access check using request headers\",\"recommendation\":\"Remove the header-based admin override. Implement proper authentication and authorization checks.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"test-production-v2.txt\",\"line\":3,\"description\":\"Sensitive API keys and tokens exposed in plain text file\",\"recommendation\":\"Remove all API keys, tokens, and secrets from this file. Use environment variables or a secure secrets management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"test-production.txt\",\"line\":3,\"description\":\"Sensitive API keys and tokens exposed in plain text file\",\"recommendation\":\"Remove all API keys and tokens from this file. Use environment variables or a secure secrets management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Best Practices\",\"priority\":\"medium\",\"file\":\"Dockerfile\",\"line\":3,\"description\":\"Using outdated Ubuntu base image\",\"recommendation\":\"Update to a more recent Ubuntu LTS version or consider using a more lightweight base image like Alpine.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"medium\",\"file\":\"Dockerfile\",\"line\":6,\"description\":\"Running container as root user\",\"recommendation\":\"Create a non-root user and use the USER instruction to run the container with least privileges.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"medium\",\"file\":\"Dockerfile\",\"line\":26,\"description\":\"Unnecessary ports exposed in Dockerfile\",\"recommendation\":\"Only expose the ports that are actually needed for the application to function.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"package.json\",\"line\":1,\"description\":\"Multiple outdated dependencies with known vulnerabilities\",\"recommendation\":\"Update all dependencies to their latest secure versions, especially lodash, moment, express, mongoose, and others.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"requirements.txt\",\"line\":1,\"description\":\"Multiple outdated Python dependencies with known vulnerabilities\",\"recommendation\":\"Update all dependencies to their latest secure versions, especially Django, requests, PyYAML, urllib3, Flask, and others.\"},{\"type\":\"ai_suggestion\",\"category\":\"Maintainability\",\"priority\":\"medium\",\"file\":\"src/file_upload.py\",\"line\":1,\"description\":\"Lack of input validation and error handling in file operations\",\"recommendation\":\"Implement proper input validation, error handling, and logging for all file operations.\"},{\"type\":\"ai_suggestion\",\"category\":\"Maintainability\",\"priority\":\"medium\",\"file\":\"src/user_auth.py\",\"line\":1,\"description\":\"Lack of proper error handling and logging in authentication functions\",\"recommendation\":\"Implement proper error handling, logging, and security event auditing for all authentication-related functions.\"}],\"summary\":{\"total_findings\":21,\"high_priority\":16,\"medium_priority\":5,\"low_priority\":0}},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"305be4c6-9ff3-4077-93f5-a11917966695\"],\"Content-Length\":[\"6524\"],\"Date\":[\"Sat, 28 Jun 2025 08:11:58 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=6a7d674b55504166;Sampled=0;Lineage=2:c73855c7:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"6524\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:11:58 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"305be4c6-9ff3-4077-93f5-a11917966695\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=6a7d674b55504166;Sampled=0;Lineage=2:c73855c7:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"305be4c6-9ff3-4077-93f5-a11917966695\"},\"StatusCode\":200}","outputDetails":{"truncated":false}},"timestamp":"2025-06-28T08:11:58.147Z","type":"TaskStateExited","redriveId":0,"stepName":"RunScanner"},"24":{"id":24,"mapIterationSucceededEventDetails":{"index":2,"name":"ParallelScans"},"previousEventId":23,"timestamp":"2025-06-28T08:11:58.147Z","type":"MapIterationSucceeded","redriveId":0,"stepName":"ParallelScans"},"25":{"id":25,"previousEventId":24,"timestamp":"2025-06-28T08:11:58.147Z","type":"MapStateSucceeded","redriveId":0},"26":{"id":26,"previousEventId":24,"stateExitedEventDetails":{"name":"ParallelScans","output":"{\"repo_details\":{\"pull_request_id\":\"2625925773\",\"repository_full_name\":\"belumume/sentinel-testbed\",\"commit_sha\":\"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\",\"pr_number\":32},\"analysis_types\":[{\"type\":\"secrets\",\"function_name\":\"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-SecretScannerFunction-w0XQI2GV65HU\",\"payload\":{\"repo_details\":{\"pull_request_id\":\"2625925773\",\"repository_full_name\":\"belumume/sentinel-testbed\",\"commit_sha\":\"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\",\"pr_number\":32}}},{\"type\":\"vulnerabilities\",\"function_name\":\"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-VulnerabilityScannerFunction-Fk7ek2H2Mdqn\",\"payload\":{\"repo_details\":{\"pull_request_id\":\"2625925773\",\"repository_full_name\":\"belumume/sentinel-testbed\",\"commit_sha\":\"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\",\"pr_number\":32}}},{\"type\":\"ai_review\",\"function_name\":\"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-AIReviewerFunction-O4EWbVoTnbOd\",\"payload\":{\"repo_details\":{\"pull_request_id\":\"2625925773\",\"repository_full_name\":\"belumume/sentinel-testbed\",\"commit_sha\":\"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\",\"pr_number\":32}}}],\"scan_results\":[{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"scanner_type\":\"secrets\",\"findings\":[{\"type\":\"API Key (Pattern Match)\",\"file\":\"test-production-v2.txt\",\"line\":3,\"raw\":\"sk-1234567890abcdef1234567890abcdef12345678\"},{\"type\":\"GitHub Token (Pattern Match)\",\"file\":\"test-production-v2.txt\",\"line\":4,\"raw\":\"ghp_1234567890abcdef1234567890abcdef1234\"},{\"type\":\"AWS Secret Key (Pattern Match)\",\"file\":\"test-production-v2.txt\",\"line\":5,\"raw\":\"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\"test-production.txt\",\"line\":3,\"raw\":\"sk-1234567890abcdef1234567890abcdef12345678\"},{\"type\":\"GitHub Token (Pattern Match)\",\"file\":\"test-production.txt\",\"line\":4,\"raw\":\"ghp_1234567890abcdef1234567890abcdef1234\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\"Dockerfile\",\"line\":15,\"raw\":\"sk_test_1234567890abcdef\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"Dockerfile\",\"line\":16,\"raw\":\"supersecret123\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"Dockerfile\",\"line\":16,\"raw\":\"supersecret123\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\".env.example\",\"line\":2,\"raw\":\"another_secret_password_123\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\".env.example\",\"line\":2,\"raw\":\"another_secret_password_123\"},{\"type\":\"Connection String (Pattern Match)\",\"file\":\".env.example\",\"line\":3,\"raw\":\"postgresql://user:secret123@localhost:5432/mydb\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\".env.example\",\"line\":6,\"raw\":\"sk-1234567890abcdefghijklmnopqrstuvwxyz1234567890a...\"},{\"type\":\"OpenAI API Key (Pattern Match)\",\"file\":\".env.example\",\"line\":6,\"raw\":\"sk-1234567890abcdefghijklmnopqrstuvwxyz1234567890a...\"},{\"type\":\"JWT Secret (Pattern Match)\",\"file\":\".env.example\",\"line\":10,\"raw\":\"my_super_secret_jwt_key_that_should_not_be_hardcod...\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\"README.md\",\"line\":6,\"raw\":\"sk_test_1234567890abcdef\"},{\"type\":\"AWS Access Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":15,\"raw\":\"AKIAIOSFODNN7EXAMPLE\"},{\"type\":\"AWS Secret Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":16,\"raw\":\"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"},{\"type\":\"Secret Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":19,\"raw\":\"sk_test_4eC39HqLyjWDarjtT1zdp7dc\"},{\"type\":\"Stripe Test Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":19,\"raw\":\"sk_test_4eC39HqLyjWDarjtT1zdp7dc\"},{\"type\":\"GitHub Token (Pattern Match)\",\"file\":\"config/database.py\",\"line\":20,\"raw\":\"ghp_1234567890abcdefghijklmnopqrstuvwxyz\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"config/database.py\",\"line\":29,\"raw\":\"DATABASE_CONFIG[\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"src/user_auth.py\",\"line\":15,\"raw\":\"{self.hash_password(password)}\"}],\"summary\":{\"total_findings\":22}},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"d13672c8-f96d-4a9c-a382-6944b79168ac\"],\"Content-Length\":[\"2886\"],\"Date\":[\"Sat, 28 Jun 2025 08:11:39 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=5e0356b90ed3a285;Sampled=0;Lineage=2:06d0fbab:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"2886\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:11:39 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"d13672c8-f96d-4a9c-a382-6944b79168ac\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=5e0356b90ed3a285;Sampled=0;Lineage=2:06d0fbab:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"d13672c8-f96d-4a9c-a382-6944b79168ac\"},\"StatusCode\":200},{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"scanner_type\":\"vulnerabilities\",\"findings\":[],\"summary\":{\"total_findings\":0,\"by_severity\":{},\"by_language\":{}}},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"0f8f7504-f819-429a-bce4-4c7615c218a3\"],\"Content-Length\":[\"142\"],\"Date\":[\"Sat, 28 Jun 2025 08:11:23 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=0fe9df82f88a24aa;Sampled=0;Lineage=2:9da352f3:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"142\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:11:23 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"0f8f7504-f819-429a-bce4-4c7615c218a3\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=0fe9df82f88a24aa;Sampled=0;Lineage=2:9da352f3:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"0f8f7504-f819-429a-bce4-4c7615c218a3\"},\"StatusCode\":200},{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"scanner_type\":\"ai_review\",\"findings\":[{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\".env.example\",\"line\":1,\"description\":\"Sensitive information exposed in .env.example file\",\"recommendation\":\"Remove all real API keys, passwords, and secrets from .env.example. Use placeholder values instead.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"Dockerfile\",\"line\":15,\"description\":\"Sensitive environment variables hardcoded in Dockerfile\",\"recommendation\":\"Remove API_KEY and DB_PASSWORD from Dockerfile. Use environment variables or secrets management instead.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"README.md\",\"line\":6,\"description\":\"API key exposed in README file\",\"recommendation\":\"Remove the API_KEY from the README file. Never commit sensitive information to version control.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"config/database.py\",\"line\":9,\"description\":\"Hardcoded database credentials in source code\",\"recommendation\":\"Remove hardcoded credentials and use environment variables or a secure configuration management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"config/database.py\",\"line\":15,\"description\":\"AWS credentials exposed in source code\",\"recommendation\":\"Remove AWS credentials from source code. Use AWS IAM roles or environment variables instead.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"config/database.py\",\"line\":19,\"description\":\"Stripe and GitHub tokens exposed in source code\",\"recommendation\":\"Remove Stripe and GitHub tokens from source code. Use environment variables or a secure secret management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/file_upload.py\",\"line\":24,\"description\":\"Arbitrary code execution vulnerability in file upload\",\"recommendation\":\"Remove the os.system call. Never execute uploaded files directly. Implement proper file validation and sandboxing.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/file_upload.py\",\"line\":33,\"description\":\"Path traversal vulnerability in file download\",\"recommendation\":\"Validate and sanitize the filename to prevent path traversal attacks. Use os.path.basename() and restrict to a specific directory.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":15,\"description\":\"SQL injection vulnerability in authentication query\",\"recommendation\":\"Use parameterized queries instead of string formatting to prevent SQL injection attacks.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":32,\"description\":\"Weak password hashing algorithm (MD5)\",\"recommendation\":\"Replace MD5 with a strong, modern hashing algorithm like bcrypt, Argon2, or PBKDF2.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":40,\"description\":\"SQL injection vulnerability in password reset functionality\",\"recommendation\":\"Use parameterized queries instead of string formatting to prevent SQL injection attacks.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":48,\"description\":\"Insecure admin access check using request headers\",\"recommendation\":\"Remove the header-based admin override. Implement proper authentication and authorization checks.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"test-production-v2.txt\",\"line\":3,\"description\":\"Sensitive API keys and tokens exposed in plain text file\",\"recommendation\":\"Remove all API keys, tokens, and secrets from this file. Use environment variables or a secure secrets management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"test-production.txt\",\"line\":3,\"description\":\"Sensitive API keys and tokens exposed in plain text file\",\"recommendation\":\"Remove all API keys and tokens from this file. Use environment variables or a secure secrets management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Best Practices\",\"priority\":\"medium\",\"file\":\"Dockerfile\",\"line\":3,\"description\":\"Using outdated Ubuntu base image\",\"recommendation\":\"Update to a more recent Ubuntu LTS version or consider using a more lightweight base image like Alpine.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"medium\",\"file\":\"Dockerfile\",\"line\":6,\"description\":\"Running container as root user\",\"recommendation\":\"Create a non-root user and use the USER instruction to run the container with least privileges.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"medium\",\"file\":\"Dockerfile\",\"line\":26,\"description\":\"Unnecessary ports exposed in Dockerfile\",\"recommendation\":\"Only expose the ports that are actually needed for the application to function.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"package.json\",\"line\":1,\"description\":\"Multiple outdated dependencies with known vulnerabilities\",\"recommendation\":\"Update all dependencies to their latest secure versions, especially lodash, moment, express, mongoose, and others.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"requirements.txt\",\"line\":1,\"description\":\"Multiple outdated Python dependencies with known vulnerabilities\",\"recommendation\":\"Update all dependencies to their latest secure versions, especially Django, requests, PyYAML, urllib3, Flask, and others.\"},{\"type\":\"ai_suggestion\",\"category\":\"Maintainability\",\"priority\":\"medium\",\"file\":\"src/file_upload.py\",\"line\":1,\"description\":\"Lack of input validation and error handling in file operations\",\"recommendation\":\"Implement proper input validation, error handling, and logging for all file operations.\"},{\"type\":\"ai_suggestion\",\"category\":\"Maintainability\",\"priority\":\"medium\",\"file\":\"src/user_auth.py\",\"line\":1,\"description\":\"Lack of proper error handling and logging in authentication functions\",\"recommendation\":\"Implement proper error handling, logging, and security event auditing for all authentication-related functions.\"}],\"summary\":{\"total_findings\":21,\"high_priority\":16,\"medium_priority\":5,\"low_priority\":0}},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"305be4c6-9ff3-4077-93f5-a11917966695\"],\"Content-Length\":[\"6524\"],\"Date\":[\"Sat, 28 Jun 2025 08:11:58 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=6a7d674b55504166;Sampled=0;Lineage=2:c73855c7:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"6524\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:11:58 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"305be4c6-9ff3-4077-93f5-a11917966695\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=6a7d674b55504166;Sampled=0;Lineage=2:c73855c7:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"305be4c6-9ff3-4077-93f5-a11917966695\"},\"StatusCode\":200}]}","outputDetails":{"truncated":false}},"timestamp":"2025-06-28T08:11:58.147Z","type":"MapStateExited","redriveId":0,"stepName":"ParallelScans"},"27":{"id":27,"previousEventId":26,"stateEnteredEventDetails":{"input":"{\"repo_details\":{\"pull_request_id\":\"2625925773\",\"repository_full_name\":\"belumume/sentinel-testbed\",\"commit_sha\":\"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\",\"pr_number\":32},\"analysis_types\":[{\"type\":\"secrets\",\"function_name\":\"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-SecretScannerFunction-w0XQI2GV65HU\",\"payload\":{\"repo_details\":{\"pull_request_id\":\"2625925773\",\"repository_full_name\":\"belumume/sentinel-testbed\",\"commit_sha\":\"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\",\"pr_number\":32}}},{\"type\":\"vulnerabilities\",\"function_name\":\"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-VulnerabilityScannerFunction-Fk7ek2H2Mdqn\",\"payload\":{\"repo_details\":{\"pull_request_id\":\"2625925773\",\"repository_full_name\":\"belumume/sentinel-testbed\",\"commit_sha\":\"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\",\"pr_number\":32}}},{\"type\":\"ai_review\",\"function_name\":\"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-AIReviewerFunction-O4EWbVoTnbOd\",\"payload\":{\"repo_details\":{\"pull_request_id\":\"2625925773\",\"repository_full_name\":\"belumume/sentinel-testbed\",\"commit_sha\":\"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\",\"pr_number\":32}}}],\"scan_results\":[{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"scanner_type\":\"secrets\",\"findings\":[{\"type\":\"API Key (Pattern Match)\",\"file\":\"test-production-v2.txt\",\"line\":3,\"raw\":\"sk-1234567890abcdef1234567890abcdef12345678\"},{\"type\":\"GitHub Token (Pattern Match)\",\"file\":\"test-production-v2.txt\",\"line\":4,\"raw\":\"ghp_1234567890abcdef1234567890abcdef1234\"},{\"type\":\"AWS Secret Key (Pattern Match)\",\"file\":\"test-production-v2.txt\",\"line\":5,\"raw\":\"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\"test-production.txt\",\"line\":3,\"raw\":\"sk-1234567890abcdef1234567890abcdef12345678\"},{\"type\":\"GitHub Token (Pattern Match)\",\"file\":\"test-production.txt\",\"line\":4,\"raw\":\"ghp_1234567890abcdef1234567890abcdef1234\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\"Dockerfile\",\"line\":15,\"raw\":\"sk_test_1234567890abcdef\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"Dockerfile\",\"line\":16,\"raw\":\"supersecret123\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"Dockerfile\",\"line\":16,\"raw\":\"supersecret123\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\".env.example\",\"line\":2,\"raw\":\"another_secret_password_123\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\".env.example\",\"line\":2,\"raw\":\"another_secret_password_123\"},{\"type\":\"Connection String (Pattern Match)\",\"file\":\".env.example\",\"line\":3,\"raw\":\"postgresql://user:secret123@localhost:5432/mydb\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\".env.example\",\"line\":6,\"raw\":\"sk-1234567890abcdefghijklmnopqrstuvwxyz1234567890a...\"},{\"type\":\"OpenAI API Key (Pattern Match)\",\"file\":\".env.example\",\"line\":6,\"raw\":\"sk-1234567890abcdefghijklmnopqrstuvwxyz1234567890a...\"},{\"type\":\"JWT Secret (Pattern Match)\",\"file\":\".env.example\",\"line\":10,\"raw\":\"my_super_secret_jwt_key_that_should_not_be_hardcod...\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\"README.md\",\"line\":6,\"raw\":\"sk_test_1234567890abcdef\"},{\"type\":\"AWS Access Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":15,\"raw\":\"AKIAIOSFODNN7EXAMPLE\"},{\"type\":\"AWS Secret Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":16,\"raw\":\"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"},{\"type\":\"Secret Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":19,\"raw\":\"sk_test_4eC39HqLyjWDarjtT1zdp7dc\"},{\"type\":\"Stripe Test Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":19,\"raw\":\"sk_test_4eC39HqLyjWDarjtT1zdp7dc\"},{\"type\":\"GitHub Token (Pattern Match)\",\"file\":\"config/database.py\",\"line\":20,\"raw\":\"ghp_1234567890abcdefghijklmnopqrstuvwxyz\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"config/database.py\",\"line\":29,\"raw\":\"DATABASE_CONFIG[\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"src/user_auth.py\",\"line\":15,\"raw\":\"{self.hash_password(password)}\"}],\"summary\":{\"total_findings\":22}},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"d13672c8-f96d-4a9c-a382-6944b79168ac\"],\"Content-Length\":[\"2886\"],\"Date\":[\"Sat, 28 Jun 2025 08:11:39 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=5e0356b90ed3a285;Sampled=0;Lineage=2:06d0fbab:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"2886\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:11:39 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"d13672c8-f96d-4a9c-a382-6944b79168ac\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=5e0356b90ed3a285;Sampled=0;Lineage=2:06d0fbab:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"d13672c8-f96d-4a9c-a382-6944b79168ac\"},\"StatusCode\":200},{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"scanner_type\":\"vulnerabilities\",\"findings\":[],\"summary\":{\"total_findings\":0,\"by_severity\":{},\"by_language\":{}}},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"0f8f7504-f819-429a-bce4-4c7615c218a3\"],\"Content-Length\":[\"142\"],\"Date\":[\"Sat, 28 Jun 2025 08:11:23 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=0fe9df82f88a24aa;Sampled=0;Lineage=2:9da352f3:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"142\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:11:23 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"0f8f7504-f819-429a-bce4-4c7615c218a3\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=0fe9df82f88a24aa;Sampled=0;Lineage=2:9da352f3:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"0f8f7504-f819-429a-bce4-4c7615c218a3\"},\"StatusCode\":200},{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"scanner_type\":\"ai_review\",\"findings\":[{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\".env.example\",\"line\":1,\"description\":\"Sensitive information exposed in .env.example file\",\"recommendation\":\"Remove all real API keys, passwords, and secrets from .env.example. Use placeholder values instead.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"Dockerfile\",\"line\":15,\"description\":\"Sensitive environment variables hardcoded in Dockerfile\",\"recommendation\":\"Remove API_KEY and DB_PASSWORD from Dockerfile. Use environment variables or secrets management instead.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"README.md\",\"line\":6,\"description\":\"API key exposed in README file\",\"recommendation\":\"Remove the API_KEY from the README file. Never commit sensitive information to version control.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"config/database.py\",\"line\":9,\"description\":\"Hardcoded database credentials in source code\",\"recommendation\":\"Remove hardcoded credentials and use environment variables or a secure configuration management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"config/database.py\",\"line\":15,\"description\":\"AWS credentials exposed in source code\",\"recommendation\":\"Remove AWS credentials from source code. Use AWS IAM roles or environment variables instead.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"config/database.py\",\"line\":19,\"description\":\"Stripe and GitHub tokens exposed in source code\",\"recommendation\":\"Remove Stripe and GitHub tokens from source code. Use environment variables or a secure secret management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/file_upload.py\",\"line\":24,\"description\":\"Arbitrary code execution vulnerability in file upload\",\"recommendation\":\"Remove the os.system call. Never execute uploaded files directly. Implement proper file validation and sandboxing.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/file_upload.py\",\"line\":33,\"description\":\"Path traversal vulnerability in file download\",\"recommendation\":\"Validate and sanitize the filename to prevent path traversal attacks. Use os.path.basename() and restrict to a specific directory.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":15,\"description\":\"SQL injection vulnerability in authentication query\",\"recommendation\":\"Use parameterized queries instead of string formatting to prevent SQL injection attacks.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":32,\"description\":\"Weak password hashing algorithm (MD5)\",\"recommendation\":\"Replace MD5 with a strong, modern hashing algorithm like bcrypt, Argon2, or PBKDF2.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":40,\"description\":\"SQL injection vulnerability in password reset functionality\",\"recommendation\":\"Use parameterized queries instead of string formatting to prevent SQL injection attacks.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":48,\"description\":\"Insecure admin access check using request headers\",\"recommendation\":\"Remove the header-based admin override. Implement proper authentication and authorization checks.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"test-production-v2.txt\",\"line\":3,\"description\":\"Sensitive API keys and tokens exposed in plain text file\",\"recommendation\":\"Remove all API keys, tokens, and secrets from this file. Use environment variables or a secure secrets management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"test-production.txt\",\"line\":3,\"description\":\"Sensitive API keys and tokens exposed in plain text file\",\"recommendation\":\"Remove all API keys and tokens from this file. Use environment variables or a secure secrets management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Best Practices\",\"priority\":\"medium\",\"file\":\"Dockerfile\",\"line\":3,\"description\":\"Using outdated Ubuntu base image\",\"recommendation\":\"Update to a more recent Ubuntu LTS version or consider using a more lightweight base image like Alpine.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"medium\",\"file\":\"Dockerfile\",\"line\":6,\"description\":\"Running container as root user\",\"recommendation\":\"Create a non-root user and use the USER instruction to run the container with least privileges.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"medium\",\"file\":\"Dockerfile\",\"line\":26,\"description\":\"Unnecessary ports exposed in Dockerfile\",\"recommendation\":\"Only expose the ports that are actually needed for the application to function.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"package.json\",\"line\":1,\"description\":\"Multiple outdated dependencies with known vulnerabilities\",\"recommendation\":\"Update all dependencies to their latest secure versions, especially lodash, moment, express, mongoose, and others.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"requirements.txt\",\"line\":1,\"description\":\"Multiple outdated Python dependencies with known vulnerabilities\",\"recommendation\":\"Update all dependencies to their latest secure versions, especially Django, requests, PyYAML, urllib3, Flask, and others.\"},{\"type\":\"ai_suggestion\",\"category\":\"Maintainability\",\"priority\":\"medium\",\"file\":\"src/file_upload.py\",\"line\":1,\"description\":\"Lack of input validation and error handling in file operations\",\"recommendation\":\"Implement proper input validation, error handling, and logging for all file operations.\"},{\"type\":\"ai_suggestion\",\"category\":\"Maintainability\",\"priority\":\"medium\",\"file\":\"src/user_auth.py\",\"line\":1,\"description\":\"Lack of proper error handling and logging in authentication functions\",\"recommendation\":\"Implement proper error handling, logging, and security event auditing for all authentication-related functions.\"}],\"summary\":{\"total_findings\":21,\"high_priority\":16,\"medium_priority\":5,\"low_priority\":0}},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"305be4c6-9ff3-4077-93f5-a11917966695\"],\"Content-Length\":[\"6524\"],\"Date\":[\"Sat, 28 Jun 2025 08:11:58 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=6a7d674b55504166;Sampled=0;Lineage=2:c73855c7:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"6524\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:11:58 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"305be4c6-9ff3-4077-93f5-a11917966695\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=6a7d674b55504166;Sampled=0;Lineage=2:c73855c7:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"305be4c6-9ff3-4077-93f5-a11917966695\"},\"StatusCode\":200}]}","inputDetails":{"truncated":false},"name":"AggregateResults"},"timestamp":"2025-06-28T08:11:58.147Z","type":"TaskStateEntered","redriveId":0,"stepName":"AggregateResults"},"28":{"id":28,"previousEventId":27,"taskScheduledEventDetails":{"parameters":{"FunctionName":"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-AggregatorFunction-Y2rymTfjXt28","Payload":{"repo_details":{"pull_request_id":"2625925773","repository_full_name":"belumume/sentinel-testbed","commit_sha":"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f","pr_number":32},"analysis_types":[{"type":"secrets","function_name":"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-SecretScannerFunction-w0XQI2GV65HU","payload":{"repo_details":{"pull_request_id":"2625925773","repository_full_name":"belumume/sentinel-testbed","commit_sha":"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f","pr_number":32}}},{"type":"vulnerabilities","function_name":"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-VulnerabilityScannerFunction-Fk7ek2H2Mdqn","payload":{"repo_details":{"pull_request_id":"2625925773","repository_full_name":"belumume/sentinel-testbed","commit_sha":"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f","pr_number":32}}},{"type":"ai_review","function_name":"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-AIReviewerFunction-O4EWbVoTnbOd","payload":{"repo_details":{"pull_request_id":"2625925773","repository_full_name":"belumume/sentinel-testbed","commit_sha":"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f","pr_number":32}}}],"scan_results":[{"ExecutedVersion":"$LATEST","Payload":{"statusCode":200,"scanner_type":"secrets","findings":[{"type":"API Key (Pattern Match)","file":"test-production-v2.txt","line":3,"raw":"sk-1234567890abcdef1234567890abcdef12345678"},{"type":"GitHub Token (Pattern Match)","file":"test-production-v2.txt","line":4,"raw":"ghp_1234567890abcdef1234567890abcdef1234"},{"type":"AWS Secret Key (Pattern Match)","file":"test-production-v2.txt","line":5,"raw":"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY"},{"type":"API Key (Pattern Match)","file":"test-production.txt","line":3,"raw":"sk-1234567890abcdef1234567890abcdef12345678"},{"type":"GitHub Token (Pattern Match)","file":"test-production.txt","line":4,"raw":"ghp_1234567890abcdef1234567890abcdef1234"},{"type":"API Key (Pattern Match)","file":"Dockerfile","line":15,"raw":"sk_test_1234567890abcdef"},{"type":"Database Password (Pattern Match)","file":"Dockerfile","line":16,"raw":"supersecret123"},{"type":"Database Password (Pattern Match)","file":"Dockerfile","line":16,"raw":"supersecret123"},{"type":"Database Password (Pattern Match)","file":".env.example","line":2,"raw":"another_secret_password_123"},{"type":"Database Password (Pattern Match)","file":".env.example","line":2,"raw":"another_secret_password_123"},{"type":"Connection String (Pattern Match)","file":".env.example","line":3,"raw":"postgresql://user:secret123@localhost:5432/mydb"},{"type":"API Key (Pattern Match)","file":".env.example","line":6,"raw":"sk-1234567890abcdefghijklmnopqrstuvwxyz1234567890a..."},{"type":"OpenAI API Key (Pattern Match)","file":".env.example","line":6,"raw":"sk-1234567890abcdefghijklmnopqrstuvwxyz1234567890a..."},{"type":"JWT Secret (Pattern Match)","file":".env.example","line":10,"raw":"my_super_secret_jwt_key_that_should_not_be_hardcod..."},{"type":"API Key (Pattern Match)","file":"README.md","line":6,"raw":"sk_test_1234567890abcdef"},{"type":"AWS Access Key (Pattern Match)","file":"config/database.py","line":15,"raw":"AKIAIOSFODNN7EXAMPLE"},{"type":"AWS Secret Key (Pattern Match)","file":"config/database.py","line":16,"raw":"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY"},{"type":"Secret Key (Pattern Match)","file":"config/database.py","line":19,"raw":"sk_test_4eC39HqLyjWDarjtT1zdp7dc"},{"type":"Stripe Test Key (Pattern Match)","file":"config/database.py","line":19,"raw":"sk_test_4eC39HqLyjWDarjtT1zdp7dc"},{"type":"GitHub Token (Pattern Match)","file":"config/database.py","line":20,"raw":"ghp_1234567890abcdefghijklmnopqrstuvwxyz"},{"type":"Database Password (Pattern Match)","file":"config/database.py","line":29,"raw":"DATABASE_CONFIG["},{"type":"Database Password (Pattern Match)","file":"src/user_auth.py","line":15,"raw":"{self.hash_password(password)}"}],"summary":{"total_findings":22}},"SdkHttpMetadata":{"AllHttpHeaders":{"X-Amz-Executed-Version":["$LATEST"],"x-amzn-Remapped-Content-Length":["0"],"Connection":["keep-alive"],"x-amzn-RequestId":["d13672c8-f96d-4a9c-a382-6944b79168ac"],"Content-Length":["2886"],"Date":["Sat, 28 Jun 2025 08:11:39 GMT"],"X-Amzn-Trace-Id":["Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=5e0356b90ed3a285;Sampled=0;Lineage=2:06d0fbab:0"],"Content-Type":["application/json"]},"HttpHeaders":{"Connection":"keep-alive","Content-Length":"2886","Content-Type":"application/json","Date":"Sat, 28 Jun 2025 08:11:39 GMT","X-Amz-Executed-Version":"$LATEST","x-amzn-Remapped-Content-Length":"0","x-amzn-RequestId":"d13672c8-f96d-4a9c-a382-6944b79168ac","X-Amzn-Trace-Id":"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=5e0356b90ed3a285;Sampled=0;Lineage=2:06d0fbab:0"},"HttpStatusCode":200},"SdkResponseMetadata":{"RequestId":"d13672c8-f96d-4a9c-a382-6944b79168ac"},"StatusCode":200},{"ExecutedVersion":"$LATEST","Payload":{"statusCode":200,"scanner_type":"vulnerabilities","findings":[],"summary":{"total_findings":0,"by_severity":{},"by_language":{}}},"SdkHttpMetadata":{"AllHttpHeaders":{"X-Amz-Executed-Version":["$LATEST"],"x-amzn-Remapped-Content-Length":["0"],"Connection":["keep-alive"],"x-amzn-RequestId":["0f8f7504-f819-429a-bce4-4c7615c218a3"],"Content-Length":["142"],"Date":["Sat, 28 Jun 2025 08:11:23 GMT"],"X-Amzn-Trace-Id":["Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=0fe9df82f88a24aa;Sampled=0;Lineage=2:9da352f3:0"],"Content-Type":["application/json"]},"HttpHeaders":{"Connection":"keep-alive","Content-Length":"142","Content-Type":"application/json","Date":"Sat, 28 Jun 2025 08:11:23 GMT","X-Amz-Executed-Version":"$LATEST","x-amzn-Remapped-Content-Length":"0","x-amzn-RequestId":"0f8f7504-f819-429a-bce4-4c7615c218a3","X-Amzn-Trace-Id":"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=0fe9df82f88a24aa;Sampled=0;Lineage=2:9da352f3:0"},"HttpStatusCode":200},"SdkResponseMetadata":{"RequestId":"0f8f7504-f819-429a-bce4-4c7615c218a3"},"StatusCode":200},{"ExecutedVersion":"$LATEST","Payload":{"statusCode":200,"scanner_type":"ai_review","findings":[{"type":"ai_suggestion","category":"Security","priority":"high","file":".env.example","line":1,"description":"Sensitive information exposed in .env.example file","recommendation":"Remove all real API keys, passwords, and secrets from .env.example. Use placeholder values instead."},{"type":"ai_suggestion","category":"Security","priority":"high","file":"Dockerfile","line":15,"description":"Sensitive environment variables hardcoded in Dockerfile","recommendation":"Remove API_KEY and DB_PASSWORD from Dockerfile. Use environment variables or secrets management instead."},{"type":"ai_suggestion","category":"Security","priority":"high","file":"README.md","line":6,"description":"API key exposed in README file","recommendation":"Remove the API_KEY from the README file. Never commit sensitive information to version control."},{"type":"ai_suggestion","category":"Security","priority":"high","file":"config/database.py","line":9,"description":"Hardcoded database credentials in source code","recommendation":"Remove hardcoded credentials and use environment variables or a secure configuration management system."},{"type":"ai_suggestion","category":"Security","priority":"high","file":"config/database.py","line":15,"description":"AWS credentials exposed in source code","recommendation":"Remove AWS credentials from source code. Use AWS IAM roles or environment variables instead."},{"type":"ai_suggestion","category":"Security","priority":"high","file":"config/database.py","line":19,"description":"Stripe and GitHub tokens exposed in source code","recommendation":"Remove Stripe and GitHub tokens from source code. Use environment variables or a secure secret management system."},{"type":"ai_suggestion","category":"Security","priority":"high","file":"src/file_upload.py","line":24,"description":"Arbitrary code execution vulnerability in file upload","recommendation":"Remove the os.system call. Never execute uploaded files directly. Implement proper file validation and sandboxing."},{"type":"ai_suggestion","category":"Security","priority":"high","file":"src/file_upload.py","line":33,"description":"Path traversal vulnerability in file download","recommendation":"Validate and sanitize the filename to prevent path traversal attacks. Use os.path.basename() and restrict to a specific directory."},{"type":"ai_suggestion","category":"Security","priority":"high","file":"src/user_auth.py","line":15,"description":"SQL injection vulnerability in authentication query","recommendation":"Use parameterized queries instead of string formatting to prevent SQL injection attacks."},{"type":"ai_suggestion","category":"Security","priority":"high","file":"src/user_auth.py","line":32,"description":"Weak password hashing algorithm (MD5)","recommendation":"Replace MD5 with a strong, modern hashing algorithm like bcrypt, Argon2, or PBKDF2."},{"type":"ai_suggestion","category":"Security","priority":"high","file":"src/user_auth.py","line":40,"description":"SQL injection vulnerability in password reset functionality","recommendation":"Use parameterized queries instead of string formatting to prevent SQL injection attacks."},{"type":"ai_suggestion","category":"Security","priority":"high","file":"src/user_auth.py","line":48,"description":"Insecure admin access check using request headers","recommendation":"Remove the header-based admin override. Implement proper authentication and authorization checks."},{"type":"ai_suggestion","category":"Security","priority":"high","file":"test-production-v2.txt","line":3,"description":"Sensitive API keys and tokens exposed in plain text file","recommendation":"Remove all API keys, tokens, and secrets from this file. Use environment variables or a secure secrets management system."},{"type":"ai_suggestion","category":"Security","priority":"high","file":"test-production.txt","line":3,"description":"Sensitive API keys and tokens exposed in plain text file","recommendation":"Remove all API keys and tokens from this file. Use environment variables or a secure secrets management system."},{"type":"ai_suggestion","category":"Best Practices","priority":"medium","file":"Dockerfile","line":3,"description":"Using outdated Ubuntu base image","recommendation":"Update to a more recent Ubuntu LTS version or consider using a more lightweight base image like Alpine."},{"type":"ai_suggestion","category":"Security","priority":"medium","file":"Dockerfile","line":6,"description":"Running container as root user","recommendation":"Create a non-root user and use the USER instruction to run the container with least privileges."},{"type":"ai_suggestion","category":"Security","priority":"medium","file":"Dockerfile","line":26,"description":"Unnecessary ports exposed in Dockerfile","recommendation":"Only expose the ports that are actually needed for the application to function."},{"type":"ai_suggestion","category":"Security","priority":"high","file":"package.json","line":1,"description":"Multiple outdated dependencies with known vulnerabilities","recommendation":"Update all dependencies to their latest secure versions, especially lodash, moment, express, mongoose, and others."},{"type":"ai_suggestion","category":"Security","priority":"high","file":"requirements.txt","line":1,"description":"Multiple outdated Python dependencies with known vulnerabilities","recommendation":"Update all dependencies to their latest secure versions, especially Django, requests, PyYAML, urllib3, Flask, and others."},{"type":"ai_suggestion","category":"Maintainability","priority":"medium","file":"src/file_upload.py","line":1,"description":"Lack of input validation and error handling in file operations","recommendation":"Implement proper input validation, error handling, and logging for all file operations."},{"type":"ai_suggestion","category":"Maintainability","priority":"medium","file":"src/user_auth.py","line":1,"description":"Lack of proper error handling and logging in authentication functions","recommendation":"Implement proper error handling, logging, and security event auditing for all authentication-related functions."}],"summary":{"total_findings":21,"high_priority":16,"medium_priority":5,"low_priority":0}},"SdkHttpMetadata":{"AllHttpHeaders":{"X-Amz-Executed-Version":["$LATEST"],"x-amzn-Remapped-Content-Length":["0"],"Connection":["keep-alive"],"x-amzn-RequestId":["305be4c6-9ff3-4077-93f5-a11917966695"],"Content-Length":["6524"],"Date":["Sat, 28 Jun 2025 08:11:58 GMT"],"X-Amzn-Trace-Id":["Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=6a7d674b55504166;Sampled=0;Lineage=2:c73855c7:0"],"Content-Type":["application/json"]},"HttpHeaders":{"Connection":"keep-alive","Content-Length":"6524","Content-Type":"application/json","Date":"Sat, 28 Jun 2025 08:11:58 GMT","X-Amz-Executed-Version":"$LATEST","x-amzn-Remapped-Content-Length":"0","x-amzn-RequestId":"305be4c6-9ff3-4077-93f5-a11917966695","X-Amzn-Trace-Id":"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=6a7d674b55504166;Sampled=0;Lineage=2:c73855c7:0"},"HttpStatusCode":200},"SdkResponseMetadata":{"RequestId":"305be4c6-9ff3-4077-93f5-a11917966695"},"StatusCode":200}]}},"region":"us-east-1","resource":"invoke","resourceType":"lambda"},"timestamp":"2025-06-28T08:11:58.147Z","type":"TaskScheduled","redriveId":0,"stepName":"AggregateResults"},"29":{"id":29,"previousEventId":28,"taskStartedEventDetails":{"resource":"invoke","resourceType":"lambda"},"timestamp":"2025-06-28T08:11:58.236Z","type":"TaskStarted","redriveId":0,"stepName":"AggregateResults"},"30":{"id":30,"previousEventId":29,"taskSucceededEventDetails":{"output":"{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"aggregation_complete\":true,\"findings_summary\":{\"secrets_found\":22,\"vulnerabilities_found\":0,\"ai_suggestions\":21},\"github_comment_posted\":true},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"4a4c99d8-b8ff-4451-84ec-783a29b803f5\"],\"Content-Length\":[\"173\"],\"Date\":[\"Sat, 28 Jun 2025 08:12:00 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=2ef7bb7fce192f6a;Sampled=0;Lineage=2:d0648a6a:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"173\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:12:00 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"4a4c99d8-b8ff-4451-84ec-783a29b803f5\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=2ef7bb7fce192f6a;Sampled=0;Lineage=2:d0648a6a:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"4a4c99d8-b8ff-4451-84ec-783a29b803f5\"},\"StatusCode\":200}","outputDetails":{"truncated":false},"resource":"invoke","resourceType":"lambda"},"timestamp":"2025-06-28T08:12:00.311Z","type":"TaskSucceeded","redriveId":0,"stepName":"AggregateResults"},"31":{"id":31,"previousEventId":30,"stateExitedEventDetails":{"name":"AggregateResults","output":"{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"aggregation_complete\":true,\"findings_summary\":{\"secrets_found\":22,\"vulnerabilities_found\":0,\"ai_suggestions\":21},\"github_comment_posted\":true},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"4a4c99d8-b8ff-4451-84ec-783a29b803f5\"],\"Content-Length\":[\"173\"],\"Date\":[\"Sat, 28 Jun 2025 08:12:00 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=2ef7bb7fce192f6a;Sampled=0;Lineage=2:d0648a6a:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"173\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:12:00 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"4a4c99d8-b8ff-4451-84ec-783a29b803f5\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=2ef7bb7fce192f6a;Sampled=0;Lineage=2:d0648a6a:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"4a4c99d8-b8ff-4451-84ec-783a29b803f5\"},\"StatusCode\":200}","outputDetails":{"truncated":false}},"timestamp":"2025-06-28T08:12:00.342Z","type":"TaskStateExited","redriveId":0,"stepName":"AggregateResults"},"32":{"executionSucceededEventDetails":{"output":"{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"aggregation_complete\":true,\"findings_summary\":{\"secrets_found\":22,\"vulnerabilities_found\":0,\"ai_suggestions\":21},\"github_comment_posted\":true},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"4a4c99d8-b8ff-4451-84ec-783a29b803f5\"],\"Content-Length\":[\"173\"],\"Date\":[\"Sat, 28 Jun 2025 08:12:00 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=2ef7bb7fce192f6a;Sampled=0;Lineage=2:d0648a6a:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"173\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:12:00 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"4a4c99d8-b8ff-4451-84ec-783a29b803f5\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=2ef7bb7fce192f6a;Sampled=0;Lineage=2:d0648a6a:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"4a4c99d8-b8ff-4451-84ec-783a29b803f5\"},\"StatusCode\":200}","outputDetails":{"truncated":false}},"id":32,"previousEventId":31,"timestamp":"2025-06-28T08:12:00.389Z","type":"ExecutionSucceeded","redriveId":0}},"stateTransition":{"iteration":0,"transition":{"stepType":"Execution","stepName":"Execution","status":3,"firstId":1,"lastId":32,"firstTimestamp":1751098283568,"lastTimestamp":1751098320389,"dataFlow":{"failDetails":{},"input":"{\"repo_details\": {\"pull_request_id\": \"2625925773\", \"repository_full_name\": \"belumume/sentinel-testbed\", \"commit_sha\": \"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\", \"pr_number\": 32}, \"analysis_types\": [{\"type\": \"secrets\", \"function_name\": \"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-SecretScannerFunction-w0XQI2GV65HU\", \"payload\": {\"repo_details\": {\"pull_request_id\": \"2625925773\", \"repository_full_name\": \"belumume/sentinel-testbed\", \"commit_sha\": \"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\", \"pr_number\": 32}}}, {\"type\": \"vulnerabilities\", \"function_name\": \"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-VulnerabilityScannerFunction-Fk7ek2H2Mdqn\", \"payload\": {\"repo_details\": {\"pull_request_id\": \"2625925773\", \"repository_full_name\": \"belumume/sentinel-testbed\", \"commit_sha\": \"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\", \"pr_number\": 32}}}, {\"type\": \"ai_review\", \"function_name\": \"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-AIReviewerFunction-O4EWbVoTnbOd\", \"payload\": {\"repo_details\": {\"pull_request_id\": \"2625925773\", \"repository_full_name\": \"belumume/sentinel-testbed\", \"commit_sha\": \"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\", \"pr_number\": 32}}}]}","output":"{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"aggregation_complete\":true,\"findings_summary\":{\"secrets_found\":22,\"vulnerabilities_found\":0,\"ai_suggestions\":21},\"github_comment_posted\":true},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"4a4c99d8-b8ff-4451-84ec-783a29b803f5\"],\"Content-Length\":[\"173\"],\"Date\":[\"Sat, 28 Jun 2025 08:12:00 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=2ef7bb7fce192f6a;Sampled=0;Lineage=2:d0648a6a:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"173\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:12:00 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"4a4c99d8-b8ff-4451-84ec-783a29b803f5\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=2ef7bb7fce192f6a;Sampled=0;Lineage=2:d0648a6a:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"4a4c99d8-b8ff-4451-84ec-783a29b803f5\"},\"StatusCode\":200}"},"availableVariables":{},"loading":false,"loaded":false,"failed":0,"events":[],"tries":[],"redriveCount":0,"lastProcessedStep":"[\"AggregateResults\"]"},"children":{"ParallelScans":{"path":"[\"ParallelScans\"]","iteration":0,"transition":{"stepType":"Map","stepName":"ParallelScans","status":3,"firstId":2,"lastId":26,"firstTimestamp":1751098283600,"lastTimestamp":1751098318147,"tries":[{"status":3,"startTimestamp":1751098283600,"dataFlow":{"output":"{\"repo_details\":{\"pull_request_id\":\"2625925773\",\"repository_full_name\":\"belumume/sentinel-testbed\",\"commit_sha\":\"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\",\"pr_number\":32},\"analysis_types\":[{\"type\":\"secrets\",\"function_name\":\"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-SecretScannerFunction-w0XQI2GV65HU\",\"payload\":{\"repo_details\":{\"pull_request_id\":\"2625925773\",\"repository_full_name\":\"belumume/sentinel-testbed\",\"commit_sha\":\"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\",\"pr_number\":32}}},{\"type\":\"vulnerabilities\",\"function_name\":\"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-VulnerabilityScannerFunction-Fk7ek2H2Mdqn\",\"payload\":{\"repo_details\":{\"pull_request_id\":\"2625925773\",\"repository_full_name\":\"belumume/sentinel-testbed\",\"commit_sha\":\"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\",\"pr_number\":32}}},{\"type\":\"ai_review\",\"function_name\":\"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-AIReviewerFunction-O4EWbVoTnbOd\",\"payload\":{\"repo_details\":{\"pull_request_id\":\"2625925773\",\"repository_full_name\":\"belumume/sentinel-testbed\",\"commit_sha\":\"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\",\"pr_number\":32}}}],\"scan_results\":[{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"scanner_type\":\"secrets\",\"findings\":[{\"type\":\"API Key (Pattern Match)\",\"file\":\"test-production-v2.txt\",\"line\":3,\"raw\":\"sk-1234567890abcdef1234567890abcdef12345678\"},{\"type\":\"GitHub Token (Pattern Match)\",\"file\":\"test-production-v2.txt\",\"line\":4,\"raw\":\"ghp_1234567890abcdef1234567890abcdef1234\"},{\"type\":\"AWS Secret Key (Pattern Match)\",\"file\":\"test-production-v2.txt\",\"line\":5,\"raw\":\"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\"test-production.txt\",\"line\":3,\"raw\":\"sk-1234567890abcdef1234567890abcdef12345678\"},{\"type\":\"GitHub Token (Pattern Match)\",\"file\":\"test-production.txt\",\"line\":4,\"raw\":\"ghp_1234567890abcdef1234567890abcdef1234\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\"Dockerfile\",\"line\":15,\"raw\":\"sk_test_1234567890abcdef\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"Dockerfile\",\"line\":16,\"raw\":\"supersecret123\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"Dockerfile\",\"line\":16,\"raw\":\"supersecret123\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\".env.example\",\"line\":2,\"raw\":\"another_secret_password_123\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\".env.example\",\"line\":2,\"raw\":\"another_secret_password_123\"},{\"type\":\"Connection String (Pattern Match)\",\"file\":\".env.example\",\"line\":3,\"raw\":\"postgresql://user:secret123@localhost:5432/mydb\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\".env.example\",\"line\":6,\"raw\":\"sk-1234567890abcdefghijklmnopqrstuvwxyz1234567890a...\"},{\"type\":\"OpenAI API Key (Pattern Match)\",\"file\":\".env.example\",\"line\":6,\"raw\":\"sk-1234567890abcdefghijklmnopqrstuvwxyz1234567890a...\"},{\"type\":\"JWT Secret (Pattern Match)\",\"file\":\".env.example\",\"line\":10,\"raw\":\"my_super_secret_jwt_key_that_should_not_be_hardcod...\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\"README.md\",\"line\":6,\"raw\":\"sk_test_1234567890abcdef\"},{\"type\":\"AWS Access Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":15,\"raw\":\"AKIAIOSFODNN7EXAMPLE\"},{\"type\":\"AWS Secret Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":16,\"raw\":\"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"},{\"type\":\"Secret Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":19,\"raw\":\"sk_test_4eC39HqLyjWDarjtT1zdp7dc\"},{\"type\":\"Stripe Test Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":19,\"raw\":\"sk_test_4eC39HqLyjWDarjtT1zdp7dc\"},{\"type\":\"GitHub Token (Pattern Match)\",\"file\":\"config/database.py\",\"line\":20,\"raw\":\"ghp_1234567890abcdefghijklmnopqrstuvwxyz\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"config/database.py\",\"line\":29,\"raw\":\"DATABASE_CONFIG[\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"src/user_auth.py\",\"line\":15,\"raw\":\"{self.hash_password(password)}\"}],\"summary\":{\"total_findings\":22}},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"d13672c8-f96d-4a9c-a382-6944b79168ac\"],\"Content-Length\":[\"2886\"],\"Date\":[\"Sat, 28 Jun 2025 08:11:39 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=5e0356b90ed3a285;Sampled=0;Lineage=2:06d0fbab:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"2886\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:11:39 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"d13672c8-f96d-4a9c-a382-6944b79168ac\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=5e0356b90ed3a285;Sampled=0;Lineage=2:06d0fbab:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"d13672c8-f96d-4a9c-a382-6944b79168ac\"},\"StatusCode\":200},{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"scanner_type\":\"vulnerabilities\",\"findings\":[],\"summary\":{\"total_findings\":0,\"by_severity\":{},\"by_language\":{}}},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"0f8f7504-f819-429a-bce4-4c7615c218a3\"],\"Content-Length\":[\"142\"],\"Date\":[\"Sat, 28 Jun 2025 08:11:23 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=0fe9df82f88a24aa;Sampled=0;Lineage=2:9da352f3:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"142\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:11:23 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"0f8f7504-f819-429a-bce4-4c7615c218a3\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=0fe9df82f88a24aa;Sampled=0;Lineage=2:9da352f3:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"0f8f7504-f819-429a-bce4-4c7615c218a3\"},\"StatusCode\":200},{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"scanner_type\":\"ai_review\",\"findings\":[{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\".env.example\",\"line\":1,\"description\":\"Sensitive information exposed in .env.example file\",\"recommendation\":\"Remove all real API keys, passwords, and secrets from .env.example. Use placeholder values instead.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"Dockerfile\",\"line\":15,\"description\":\"Sensitive environment variables hardcoded in Dockerfile\",\"recommendation\":\"Remove API_KEY and DB_PASSWORD from Dockerfile. Use environment variables or secrets management instead.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"README.md\",\"line\":6,\"description\":\"API key exposed in README file\",\"recommendation\":\"Remove the API_KEY from the README file. Never commit sensitive information to version control.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"config/database.py\",\"line\":9,\"description\":\"Hardcoded database credentials in source code\",\"recommendation\":\"Remove hardcoded credentials and use environment variables or a secure configuration management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"config/database.py\",\"line\":15,\"description\":\"AWS credentials exposed in source code\",\"recommendation\":\"Remove AWS credentials from source code. Use AWS IAM roles or environment variables instead.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"config/database.py\",\"line\":19,\"description\":\"Stripe and GitHub tokens exposed in source code\",\"recommendation\":\"Remove Stripe and GitHub tokens from source code. Use environment variables or a secure secret management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/file_upload.py\",\"line\":24,\"description\":\"Arbitrary code execution vulnerability in file upload\",\"recommendation\":\"Remove the os.system call. Never execute uploaded files directly. Implement proper file validation and sandboxing.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/file_upload.py\",\"line\":33,\"description\":\"Path traversal vulnerability in file download\",\"recommendation\":\"Validate and sanitize the filename to prevent path traversal attacks. Use os.path.basename() and restrict to a specific directory.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":15,\"description\":\"SQL injection vulnerability in authentication query\",\"recommendation\":\"Use parameterized queries instead of string formatting to prevent SQL injection attacks.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":32,\"description\":\"Weak password hashing algorithm (MD5)\",\"recommendation\":\"Replace MD5 with a strong, modern hashing algorithm like bcrypt, Argon2, or PBKDF2.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":40,\"description\":\"SQL injection vulnerability in password reset functionality\",\"recommendation\":\"Use parameterized queries instead of string formatting to prevent SQL injection attacks.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":48,\"description\":\"Insecure admin access check using request headers\",\"recommendation\":\"Remove the header-based admin override. Implement proper authentication and authorization checks.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"test-production-v2.txt\",\"line\":3,\"description\":\"Sensitive API keys and tokens exposed in plain text file\",\"recommendation\":\"Remove all API keys, tokens, and secrets from this file. Use environment variables or a secure secrets management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"test-production.txt\",\"line\":3,\"description\":\"Sensitive API keys and tokens exposed in plain text file\",\"recommendation\":\"Remove all API keys and tokens from this file. Use environment variables or a secure secrets management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Best Practices\",\"priority\":\"medium\",\"file\":\"Dockerfile\",\"line\":3,\"description\":\"Using outdated Ubuntu base image\",\"recommendation\":\"Update to a more recent Ubuntu LTS version or consider using a more lightweight base image like Alpine.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"medium\",\"file\":\"Dockerfile\",\"line\":6,\"description\":\"Running container as root user\",\"recommendation\":\"Create a non-root user and use the USER instruction to run the container with least privileges.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"medium\",\"file\":\"Dockerfile\",\"line\":26,\"description\":\"Unnecessary ports exposed in Dockerfile\",\"recommendation\":\"Only expose the ports that are actually needed for the application to function.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"package.json\",\"line\":1,\"description\":\"Multiple outdated dependencies with known vulnerabilities\",\"recommendation\":\"Update all dependencies to their latest secure versions, especially lodash, moment, express, mongoose, and others.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"requirements.txt\",\"line\":1,\"description\":\"Multiple outdated Python dependencies with known vulnerabilities\",\"recommendation\":\"Update all dependencies to their latest secure versions, especially Django, requests, PyYAML, urllib3, Flask, and others.\"},{\"type\":\"ai_suggestion\",\"category\":\"Maintainability\",\"priority\":\"medium\",\"file\":\"src/file_upload.py\",\"line\":1,\"description\":\"Lack of input validation and error handling in file operations\",\"recommendation\":\"Implement proper input validation, error handling, and logging for all file operations.\"},{\"type\":\"ai_suggestion\",\"category\":\"Maintainability\",\"priority\":\"medium\",\"file\":\"src/user_auth.py\",\"line\":1,\"description\":\"Lack of proper error handling and logging in authentication functions\",\"recommendation\":\"Implement proper error handling, logging, and security event auditing for all authentication-related functions.\"}],\"summary\":{\"total_findings\":21,\"high_priority\":16,\"medium_priority\":5,\"low_priority\":0}},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"305be4c6-9ff3-4077-93f5-a11917966695\"],\"Content-Length\":[\"6524\"],\"Date\":[\"Sat, 28 Jun 2025 08:11:58 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=6a7d674b55504166;Sampled=0;Lineage=2:c73855c7:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"6524\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:11:58 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"305be4c6-9ff3-4077-93f5-a11917966695\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=6a7d674b55504166;Sampled=0;Lineage=2:c73855c7:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"305be4c6-9ff3-4077-93f5-a11917966695\"},\"StatusCode\":200}]}","failDetails":{}},"isRedriveEvent":false,"endTimestamp":1751098318147}],"dataFlow":{"input":"{\"repo_details\": {\"pull_request_id\": \"2625925773\", \"repository_full_name\": \"belumume/sentinel-testbed\", \"commit_sha\": \"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\", \"pr_number\": 32}, \"analysis_types\": [{\"type\": \"secrets\", \"function_name\": \"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-SecretScannerFunction-w0XQI2GV65HU\", \"payload\": {\"repo_details\": {\"pull_request_id\": \"2625925773\", \"repository_full_name\": \"belumume/sentinel-testbed\", \"commit_sha\": \"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\", \"pr_number\": 32}}}, {\"type\": \"vulnerabilities\", \"function_name\": \"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-VulnerabilityScannerFunction-Fk7ek2H2Mdqn\", \"payload\": {\"repo_details\": {\"pull_request_id\": \"2625925773\", \"repository_full_name\": \"belumume/sentinel-testbed\", \"commit_sha\": \"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\", \"pr_number\": 32}}}, {\"type\": \"ai_review\", \"function_name\": \"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-AIReviewerFunction-O4EWbVoTnbOd\", \"payload\": {\"repo_details\": {\"pull_request_id\": \"2625925773\", \"repository_full_name\": \"belumume/sentinel-testbed\", \"commit_sha\": \"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\", \"pr_number\": 32}}}]}","output":"{\"repo_details\":{\"pull_request_id\":\"2625925773\",\"repository_full_name\":\"belumume/sentinel-testbed\",\"commit_sha\":\"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\",\"pr_number\":32},\"analysis_types\":[{\"type\":\"secrets\",\"function_name\":\"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-SecretScannerFunction-w0XQI2GV65HU\",\"payload\":{\"repo_details\":{\"pull_request_id\":\"2625925773\",\"repository_full_name\":\"belumume/sentinel-testbed\",\"commit_sha\":\"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\",\"pr_number\":32}}},{\"type\":\"vulnerabilities\",\"function_name\":\"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-VulnerabilityScannerFunction-Fk7ek2H2Mdqn\",\"payload\":{\"repo_details\":{\"pull_request_id\":\"2625925773\",\"repository_full_name\":\"belumume/sentinel-testbed\",\"commit_sha\":\"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\",\"pr_number\":32}}},{\"type\":\"ai_review\",\"function_name\":\"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-AIReviewerFunction-O4EWbVoTnbOd\",\"payload\":{\"repo_details\":{\"pull_request_id\":\"2625925773\",\"repository_full_name\":\"belumume/sentinel-testbed\",\"commit_sha\":\"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\",\"pr_number\":32}}}],\"scan_results\":[{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"scanner_type\":\"secrets\",\"findings\":[{\"type\":\"API Key (Pattern Match)\",\"file\":\"test-production-v2.txt\",\"line\":3,\"raw\":\"sk-1234567890abcdef1234567890abcdef12345678\"},{\"type\":\"GitHub Token (Pattern Match)\",\"file\":\"test-production-v2.txt\",\"line\":4,\"raw\":\"ghp_1234567890abcdef1234567890abcdef1234\"},{\"type\":\"AWS Secret Key (Pattern Match)\",\"file\":\"test-production-v2.txt\",\"line\":5,\"raw\":\"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\"test-production.txt\",\"line\":3,\"raw\":\"sk-1234567890abcdef1234567890abcdef12345678\"},{\"type\":\"GitHub Token (Pattern Match)\",\"file\":\"test-production.txt\",\"line\":4,\"raw\":\"ghp_1234567890abcdef1234567890abcdef1234\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\"Dockerfile\",\"line\":15,\"raw\":\"sk_test_1234567890abcdef\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"Dockerfile\",\"line\":16,\"raw\":\"supersecret123\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"Dockerfile\",\"line\":16,\"raw\":\"supersecret123\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\".env.example\",\"line\":2,\"raw\":\"another_secret_password_123\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\".env.example\",\"line\":2,\"raw\":\"another_secret_password_123\"},{\"type\":\"Connection String (Pattern Match)\",\"file\":\".env.example\",\"line\":3,\"raw\":\"postgresql://user:secret123@localhost:5432/mydb\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\".env.example\",\"line\":6,\"raw\":\"sk-1234567890abcdefghijklmnopqrstuvwxyz1234567890a...\"},{\"type\":\"OpenAI API Key (Pattern Match)\",\"file\":\".env.example\",\"line\":6,\"raw\":\"sk-1234567890abcdefghijklmnopqrstuvwxyz1234567890a...\"},{\"type\":\"JWT Secret (Pattern Match)\",\"file\":\".env.example\",\"line\":10,\"raw\":\"my_super_secret_jwt_key_that_should_not_be_hardcod...\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\"README.md\",\"line\":6,\"raw\":\"sk_test_1234567890abcdef\"},{\"type\":\"AWS Access Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":15,\"raw\":\"AKIAIOSFODNN7EXAMPLE\"},{\"type\":\"AWS Secret Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":16,\"raw\":\"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"},{\"type\":\"Secret Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":19,\"raw\":\"sk_test_4eC39HqLyjWDarjtT1zdp7dc\"},{\"type\":\"Stripe Test Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":19,\"raw\":\"sk_test_4eC39HqLyjWDarjtT1zdp7dc\"},{\"type\":\"GitHub Token (Pattern Match)\",\"file\":\"config/database.py\",\"line\":20,\"raw\":\"ghp_1234567890abcdefghijklmnopqrstuvwxyz\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"config/database.py\",\"line\":29,\"raw\":\"DATABASE_CONFIG[\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"src/user_auth.py\",\"line\":15,\"raw\":\"{self.hash_password(password)}\"}],\"summary\":{\"total_findings\":22}},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"d13672c8-f96d-4a9c-a382-6944b79168ac\"],\"Content-Length\":[\"2886\"],\"Date\":[\"Sat, 28 Jun 2025 08:11:39 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=5e0356b90ed3a285;Sampled=0;Lineage=2:06d0fbab:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"2886\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:11:39 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"d13672c8-f96d-4a9c-a382-6944b79168ac\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=5e0356b90ed3a285;Sampled=0;Lineage=2:06d0fbab:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"d13672c8-f96d-4a9c-a382-6944b79168ac\"},\"StatusCode\":200},{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"scanner_type\":\"vulnerabilities\",\"findings\":[],\"summary\":{\"total_findings\":0,\"by_severity\":{},\"by_language\":{}}},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"0f8f7504-f819-429a-bce4-4c7615c218a3\"],\"Content-Length\":[\"142\"],\"Date\":[\"Sat, 28 Jun 2025 08:11:23 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=0fe9df82f88a24aa;Sampled=0;Lineage=2:9da352f3:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"142\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:11:23 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"0f8f7504-f819-429a-bce4-4c7615c218a3\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=0fe9df82f88a24aa;Sampled=0;Lineage=2:9da352f3:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"0f8f7504-f819-429a-bce4-4c7615c218a3\"},\"StatusCode\":200},{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"scanner_type\":\"ai_review\",\"findings\":[{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\".env.example\",\"line\":1,\"description\":\"Sensitive information exposed in .env.example file\",\"recommendation\":\"Remove all real API keys, passwords, and secrets from .env.example. Use placeholder values instead.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"Dockerfile\",\"line\":15,\"description\":\"Sensitive environment variables hardcoded in Dockerfile\",\"recommendation\":\"Remove API_KEY and DB_PASSWORD from Dockerfile. Use environment variables or secrets management instead.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"README.md\",\"line\":6,\"description\":\"API key exposed in README file\",\"recommendation\":\"Remove the API_KEY from the README file. Never commit sensitive information to version control.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"config/database.py\",\"line\":9,\"description\":\"Hardcoded database credentials in source code\",\"recommendation\":\"Remove hardcoded credentials and use environment variables or a secure configuration management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"config/database.py\",\"line\":15,\"description\":\"AWS credentials exposed in source code\",\"recommendation\":\"Remove AWS credentials from source code. Use AWS IAM roles or environment variables instead.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"config/database.py\",\"line\":19,\"description\":\"Stripe and GitHub tokens exposed in source code\",\"recommendation\":\"Remove Stripe and GitHub tokens from source code. Use environment variables or a secure secret management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/file_upload.py\",\"line\":24,\"description\":\"Arbitrary code execution vulnerability in file upload\",\"recommendation\":\"Remove the os.system call. Never execute uploaded files directly. Implement proper file validation and sandboxing.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/file_upload.py\",\"line\":33,\"description\":\"Path traversal vulnerability in file download\",\"recommendation\":\"Validate and sanitize the filename to prevent path traversal attacks. Use os.path.basename() and restrict to a specific directory.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":15,\"description\":\"SQL injection vulnerability in authentication query\",\"recommendation\":\"Use parameterized queries instead of string formatting to prevent SQL injection attacks.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":32,\"description\":\"Weak password hashing algorithm (MD5)\",\"recommendation\":\"Replace MD5 with a strong, modern hashing algorithm like bcrypt, Argon2, or PBKDF2.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":40,\"description\":\"SQL injection vulnerability in password reset functionality\",\"recommendation\":\"Use parameterized queries instead of string formatting to prevent SQL injection attacks.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":48,\"description\":\"Insecure admin access check using request headers\",\"recommendation\":\"Remove the header-based admin override. Implement proper authentication and authorization checks.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"test-production-v2.txt\",\"line\":3,\"description\":\"Sensitive API keys and tokens exposed in plain text file\",\"recommendation\":\"Remove all API keys, tokens, and secrets from this file. Use environment variables or a secure secrets management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"test-production.txt\",\"line\":3,\"description\":\"Sensitive API keys and tokens exposed in plain text file\",\"recommendation\":\"Remove all API keys and tokens from this file. Use environment variables or a secure secrets management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Best Practices\",\"priority\":\"medium\",\"file\":\"Dockerfile\",\"line\":3,\"description\":\"Using outdated Ubuntu base image\",\"recommendation\":\"Update to a more recent Ubuntu LTS version or consider using a more lightweight base image like Alpine.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"medium\",\"file\":\"Dockerfile\",\"line\":6,\"description\":\"Running container as root user\",\"recommendation\":\"Create a non-root user and use the USER instruction to run the container with least privileges.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"medium\",\"file\":\"Dockerfile\",\"line\":26,\"description\":\"Unnecessary ports exposed in Dockerfile\",\"recommendation\":\"Only expose the ports that are actually needed for the application to function.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"package.json\",\"line\":1,\"description\":\"Multiple outdated dependencies with known vulnerabilities\",\"recommendation\":\"Update all dependencies to their latest secure versions, especially lodash, moment, express, mongoose, and others.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"requirements.txt\",\"line\":1,\"description\":\"Multiple outdated Python dependencies with known vulnerabilities\",\"recommendation\":\"Update all dependencies to their latest secure versions, especially Django, requests, PyYAML, urllib3, Flask, and others.\"},{\"type\":\"ai_suggestion\",\"category\":\"Maintainability\",\"priority\":\"medium\",\"file\":\"src/file_upload.py\",\"line\":1,\"description\":\"Lack of input validation and error handling in file operations\",\"recommendation\":\"Implement proper input validation, error handling, and logging for all file operations.\"},{\"type\":\"ai_suggestion\",\"category\":\"Maintainability\",\"priority\":\"medium\",\"file\":\"src/user_auth.py\",\"line\":1,\"description\":\"Lack of proper error handling and logging in authentication functions\",\"recommendation\":\"Implement proper error handling, logging, and security event auditing for all authentication-related functions.\"}],\"summary\":{\"total_findings\":21,\"high_priority\":16,\"medium_priority\":5,\"low_priority\":0}},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"305be4c6-9ff3-4077-93f5-a11917966695\"],\"Content-Length\":[\"6524\"],\"Date\":[\"Sat, 28 Jun 2025 08:11:58 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=6a7d674b55504166;Sampled=0;Lineage=2:c73855c7:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"6524\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:11:58 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"305be4c6-9ff3-4077-93f5-a11917966695\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=6a7d674b55504166;Sampled=0;Lineage=2:c73855c7:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"305be4c6-9ff3-4077-93f5-a11917966695\"},\"StatusCode\":200}]}","failDetails":{}},"events":[{"id":2,"previousEventId":0,"stateEnteredEventDetails":{"input":"{\"repo_details\": {\"pull_request_id\": \"2625925773\", \"repository_full_name\": \"belumume/sentinel-testbed\", \"commit_sha\": \"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\", \"pr_number\": 32}, \"analysis_types\": [{\"type\": \"secrets\", \"function_name\": \"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-SecretScannerFunction-w0XQI2GV65HU\", \"payload\": {\"repo_details\": {\"pull_request_id\": \"2625925773\", \"repository_full_name\": \"belumume/sentinel-testbed\", \"commit_sha\": \"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\", \"pr_number\": 32}}}, {\"type\": \"vulnerabilities\", \"function_name\": \"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-VulnerabilityScannerFunction-Fk7ek2H2Mdqn\", \"payload\": {\"repo_details\": {\"pull_request_id\": \"2625925773\", \"repository_full_name\": \"belumume/sentinel-testbed\", \"commit_sha\": \"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\", \"pr_number\": 32}}}, {\"type\": \"ai_review\", \"function_name\": \"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-AIReviewerFunction-O4EWbVoTnbOd\", \"payload\": {\"repo_details\": {\"pull_request_id\": \"2625925773\", \"repository_full_name\": \"belumume/sentinel-testbed\", \"commit_sha\": \"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\", \"pr_number\": 32}}}]}","inputDetails":{"truncated":false},"name":"ParallelScans"},"timestamp":"2025-06-28T08:11:23.600Z","type":"MapStateEntered","redriveId":0,"stepName":"ParallelScans"},{"id":3,"mapStateStartedEventDetails":{"length":3},"previousEventId":2,"timestamp":"2025-06-28T08:11:23.600Z","type":"MapStateStarted","redriveId":0,"stepName":"ParallelScans"},{"id":26,"previousEventId":24,"stateExitedEventDetails":{"name":"ParallelScans","output":"{\"repo_details\":{\"pull_request_id\":\"2625925773\",\"repository_full_name\":\"belumume/sentinel-testbed\",\"commit_sha\":\"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\",\"pr_number\":32},\"analysis_types\":[{\"type\":\"secrets\",\"function_name\":\"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-SecretScannerFunction-w0XQI2GV65HU\",\"payload\":{\"repo_details\":{\"pull_request_id\":\"2625925773\",\"repository_full_name\":\"belumume/sentinel-testbed\",\"commit_sha\":\"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\",\"pr_number\":32}}},{\"type\":\"vulnerabilities\",\"function_name\":\"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-VulnerabilityScannerFunction-Fk7ek2H2Mdqn\",\"payload\":{\"repo_details\":{\"pull_request_id\":\"2625925773\",\"repository_full_name\":\"belumume/sentinel-testbed\",\"commit_sha\":\"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\",\"pr_number\":32}}},{\"type\":\"ai_review\",\"function_name\":\"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-AIReviewerFunction-O4EWbVoTnbOd\",\"payload\":{\"repo_details\":{\"pull_request_id\":\"2625925773\",\"repository_full_name\":\"belumume/sentinel-testbed\",\"commit_sha\":\"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\",\"pr_number\":32}}}],\"scan_results\":[{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"scanner_type\":\"secrets\",\"findings\":[{\"type\":\"API Key (Pattern Match)\",\"file\":\"test-production-v2.txt\",\"line\":3,\"raw\":\"sk-1234567890abcdef1234567890abcdef12345678\"},{\"type\":\"GitHub Token (Pattern Match)\",\"file\":\"test-production-v2.txt\",\"line\":4,\"raw\":\"ghp_1234567890abcdef1234567890abcdef1234\"},{\"type\":\"AWS Secret Key (Pattern Match)\",\"file\":\"test-production-v2.txt\",\"line\":5,\"raw\":\"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\"test-production.txt\",\"line\":3,\"raw\":\"sk-1234567890abcdef1234567890abcdef12345678\"},{\"type\":\"GitHub Token (Pattern Match)\",\"file\":\"test-production.txt\",\"line\":4,\"raw\":\"ghp_1234567890abcdef1234567890abcdef1234\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\"Dockerfile\",\"line\":15,\"raw\":\"sk_test_1234567890abcdef\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"Dockerfile\",\"line\":16,\"raw\":\"supersecret123\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"Dockerfile\",\"line\":16,\"raw\":\"supersecret123\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\".env.example\",\"line\":2,\"raw\":\"another_secret_password_123\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\".env.example\",\"line\":2,\"raw\":\"another_secret_password_123\"},{\"type\":\"Connection String (Pattern Match)\",\"file\":\".env.example\",\"line\":3,\"raw\":\"postgresql://user:secret123@localhost:5432/mydb\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\".env.example\",\"line\":6,\"raw\":\"sk-1234567890abcdefghijklmnopqrstuvwxyz1234567890a...\"},{\"type\":\"OpenAI API Key (Pattern Match)\",\"file\":\".env.example\",\"line\":6,\"raw\":\"sk-1234567890abcdefghijklmnopqrstuvwxyz1234567890a...\"},{\"type\":\"JWT Secret (Pattern Match)\",\"file\":\".env.example\",\"line\":10,\"raw\":\"my_super_secret_jwt_key_that_should_not_be_hardcod...\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\"README.md\",\"line\":6,\"raw\":\"sk_test_1234567890abcdef\"},{\"type\":\"AWS Access Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":15,\"raw\":\"AKIAIOSFODNN7EXAMPLE\"},{\"type\":\"AWS Secret Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":16,\"raw\":\"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"},{\"type\":\"Secret Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":19,\"raw\":\"sk_test_4eC39HqLyjWDarjtT1zdp7dc\"},{\"type\":\"Stripe Test Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":19,\"raw\":\"sk_test_4eC39HqLyjWDarjtT1zdp7dc\"},{\"type\":\"GitHub Token (Pattern Match)\",\"file\":\"config/database.py\",\"line\":20,\"raw\":\"ghp_1234567890abcdefghijklmnopqrstuvwxyz\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"config/database.py\",\"line\":29,\"raw\":\"DATABASE_CONFIG[\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"src/user_auth.py\",\"line\":15,\"raw\":\"{self.hash_password(password)}\"}],\"summary\":{\"total_findings\":22}},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"d13672c8-f96d-4a9c-a382-6944b79168ac\"],\"Content-Length\":[\"2886\"],\"Date\":[\"Sat, 28 Jun 2025 08:11:39 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=5e0356b90ed3a285;Sampled=0;Lineage=2:06d0fbab:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"2886\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:11:39 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"d13672c8-f96d-4a9c-a382-6944b79168ac\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=5e0356b90ed3a285;Sampled=0;Lineage=2:06d0fbab:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"d13672c8-f96d-4a9c-a382-6944b79168ac\"},\"StatusCode\":200},{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"scanner_type\":\"vulnerabilities\",\"findings\":[],\"summary\":{\"total_findings\":0,\"by_severity\":{},\"by_language\":{}}},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"0f8f7504-f819-429a-bce4-4c7615c218a3\"],\"Content-Length\":[\"142\"],\"Date\":[\"Sat, 28 Jun 2025 08:11:23 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=0fe9df82f88a24aa;Sampled=0;Lineage=2:9da352f3:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"142\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:11:23 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"0f8f7504-f819-429a-bce4-4c7615c218a3\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=0fe9df82f88a24aa;Sampled=0;Lineage=2:9da352f3:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"0f8f7504-f819-429a-bce4-4c7615c218a3\"},\"StatusCode\":200},{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"scanner_type\":\"ai_review\",\"findings\":[{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\".env.example\",\"line\":1,\"description\":\"Sensitive information exposed in .env.example file\",\"recommendation\":\"Remove all real API keys, passwords, and secrets from .env.example. Use placeholder values instead.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"Dockerfile\",\"line\":15,\"description\":\"Sensitive environment variables hardcoded in Dockerfile\",\"recommendation\":\"Remove API_KEY and DB_PASSWORD from Dockerfile. Use environment variables or secrets management instead.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"README.md\",\"line\":6,\"description\":\"API key exposed in README file\",\"recommendation\":\"Remove the API_KEY from the README file. Never commit sensitive information to version control.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"config/database.py\",\"line\":9,\"description\":\"Hardcoded database credentials in source code\",\"recommendation\":\"Remove hardcoded credentials and use environment variables or a secure configuration management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"config/database.py\",\"line\":15,\"description\":\"AWS credentials exposed in source code\",\"recommendation\":\"Remove AWS credentials from source code. Use AWS IAM roles or environment variables instead.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"config/database.py\",\"line\":19,\"description\":\"Stripe and GitHub tokens exposed in source code\",\"recommendation\":\"Remove Stripe and GitHub tokens from source code. Use environment variables or a secure secret management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/file_upload.py\",\"line\":24,\"description\":\"Arbitrary code execution vulnerability in file upload\",\"recommendation\":\"Remove the os.system call. Never execute uploaded files directly. Implement proper file validation and sandboxing.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/file_upload.py\",\"line\":33,\"description\":\"Path traversal vulnerability in file download\",\"recommendation\":\"Validate and sanitize the filename to prevent path traversal attacks. Use os.path.basename() and restrict to a specific directory.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":15,\"description\":\"SQL injection vulnerability in authentication query\",\"recommendation\":\"Use parameterized queries instead of string formatting to prevent SQL injection attacks.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":32,\"description\":\"Weak password hashing algorithm (MD5)\",\"recommendation\":\"Replace MD5 with a strong, modern hashing algorithm like bcrypt, Argon2, or PBKDF2.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":40,\"description\":\"SQL injection vulnerability in password reset functionality\",\"recommendation\":\"Use parameterized queries instead of string formatting to prevent SQL injection attacks.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":48,\"description\":\"Insecure admin access check using request headers\",\"recommendation\":\"Remove the header-based admin override. Implement proper authentication and authorization checks.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"test-production-v2.txt\",\"line\":3,\"description\":\"Sensitive API keys and tokens exposed in plain text file\",\"recommendation\":\"Remove all API keys, tokens, and secrets from this file. Use environment variables or a secure secrets management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"test-production.txt\",\"line\":3,\"description\":\"Sensitive API keys and tokens exposed in plain text file\",\"recommendation\":\"Remove all API keys and tokens from this file. Use environment variables or a secure secrets management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Best Practices\",\"priority\":\"medium\",\"file\":\"Dockerfile\",\"line\":3,\"description\":\"Using outdated Ubuntu base image\",\"recommendation\":\"Update to a more recent Ubuntu LTS version or consider using a more lightweight base image like Alpine.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"medium\",\"file\":\"Dockerfile\",\"line\":6,\"description\":\"Running container as root user\",\"recommendation\":\"Create a non-root user and use the USER instruction to run the container with least privileges.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"medium\",\"file\":\"Dockerfile\",\"line\":26,\"description\":\"Unnecessary ports exposed in Dockerfile\",\"recommendation\":\"Only expose the ports that are actually needed for the application to function.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"package.json\",\"line\":1,\"description\":\"Multiple outdated dependencies with known vulnerabilities\",\"recommendation\":\"Update all dependencies to their latest secure versions, especially lodash, moment, express, mongoose, and others.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"requirements.txt\",\"line\":1,\"description\":\"Multiple outdated Python dependencies with known vulnerabilities\",\"recommendation\":\"Update all dependencies to their latest secure versions, especially Django, requests, PyYAML, urllib3, Flask, and others.\"},{\"type\":\"ai_suggestion\",\"category\":\"Maintainability\",\"priority\":\"medium\",\"file\":\"src/file_upload.py\",\"line\":1,\"description\":\"Lack of input validation and error handling in file operations\",\"recommendation\":\"Implement proper input validation, error handling, and logging for all file operations.\"},{\"type\":\"ai_suggestion\",\"category\":\"Maintainability\",\"priority\":\"medium\",\"file\":\"src/user_auth.py\",\"line\":1,\"description\":\"Lack of proper error handling and logging in authentication functions\",\"recommendation\":\"Implement proper error handling, logging, and security event auditing for all authentication-related functions.\"}],\"summary\":{\"total_findings\":21,\"high_priority\":16,\"medium_priority\":5,\"low_priority\":0}},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"305be4c6-9ff3-4077-93f5-a11917966695\"],\"Content-Length\":[\"6524\"],\"Date\":[\"Sat, 28 Jun 2025 08:11:58 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=6a7d674b55504166;Sampled=0;Lineage=2:c73855c7:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"6524\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:11:58 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"305be4c6-9ff3-4077-93f5-a11917966695\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=6a7d674b55504166;Sampled=0;Lineage=2:c73855c7:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"305be4c6-9ff3-4077-93f5-a11917966695\"},\"StatusCode\":200}]}","outputDetails":{"truncated":false}},"timestamp":"2025-06-28T08:11:58.147Z","type":"MapStateExited","redriveId":0,"stepName":"ParallelScans"}],"redriveCount":0,"availableVariables":{},"mapSize":3,"meta":{"id":0,"expandable":true,"expanded":true,"matched":true,"lastChild":false,"hasDisplayedChildren":true,"path":"[\"ParallelScans\"]"}},"children":{"0":{"path":"[\"ParallelScans\",\"0\"]","iteration":0,"transition":{"status":3,"firstId":4,"lastId":21,"stepType":"MapIteration","stepName":"0","firstTimestamp":1751098283600,"lastTimestamp":1751098299804,"tries":[{"status":3,"startTimestamp":1751098283600,"dataFlow":{"output":"{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"scanner_type\":\"secrets\",\"findings\":[{\"type\":\"API Key (Pattern Match)\",\"file\":\"test-production-v2.txt\",\"line\":3,\"raw\":\"sk-1234567890abcdef1234567890abcdef12345678\"},{\"type\":\"GitHub Token (Pattern Match)\",\"file\":\"test-production-v2.txt\",\"line\":4,\"raw\":\"ghp_1234567890abcdef1234567890abcdef1234\"},{\"type\":\"AWS Secret Key (Pattern Match)\",\"file\":\"test-production-v2.txt\",\"line\":5,\"raw\":\"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\"test-production.txt\",\"line\":3,\"raw\":\"sk-1234567890abcdef1234567890abcdef12345678\"},{\"type\":\"GitHub Token (Pattern Match)\",\"file\":\"test-production.txt\",\"line\":4,\"raw\":\"ghp_1234567890abcdef1234567890abcdef1234\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\"Dockerfile\",\"line\":15,\"raw\":\"sk_test_1234567890abcdef\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"Dockerfile\",\"line\":16,\"raw\":\"supersecret123\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"Dockerfile\",\"line\":16,\"raw\":\"supersecret123\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\".env.example\",\"line\":2,\"raw\":\"another_secret_password_123\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\".env.example\",\"line\":2,\"raw\":\"another_secret_password_123\"},{\"type\":\"Connection String (Pattern Match)\",\"file\":\".env.example\",\"line\":3,\"raw\":\"postgresql://user:secret123@localhost:5432/mydb\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\".env.example\",\"line\":6,\"raw\":\"sk-1234567890abcdefghijklmnopqrstuvwxyz1234567890a...\"},{\"type\":\"OpenAI API Key (Pattern Match)\",\"file\":\".env.example\",\"line\":6,\"raw\":\"sk-1234567890abcdefghijklmnopqrstuvwxyz1234567890a...\"},{\"type\":\"JWT Secret (Pattern Match)\",\"file\":\".env.example\",\"line\":10,\"raw\":\"my_super_secret_jwt_key_that_should_not_be_hardcod...\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\"README.md\",\"line\":6,\"raw\":\"sk_test_1234567890abcdef\"},{\"type\":\"AWS Access Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":15,\"raw\":\"AKIAIOSFODNN7EXAMPLE\"},{\"type\":\"AWS Secret Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":16,\"raw\":\"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"},{\"type\":\"Secret Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":19,\"raw\":\"sk_test_4eC39HqLyjWDarjtT1zdp7dc\"},{\"type\":\"Stripe Test Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":19,\"raw\":\"sk_test_4eC39HqLyjWDarjtT1zdp7dc\"},{\"type\":\"GitHub Token (Pattern Match)\",\"file\":\"config/database.py\",\"line\":20,\"raw\":\"ghp_1234567890abcdefghijklmnopqrstuvwxyz\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"config/database.py\",\"line\":29,\"raw\":\"DATABASE_CONFIG[\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"src/user_auth.py\",\"line\":15,\"raw\":\"{self.hash_password(password)}\"}],\"summary\":{\"total_findings\":22}},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"d13672c8-f96d-4a9c-a382-6944b79168ac\"],\"Content-Length\":[\"2886\"],\"Date\":[\"Sat, 28 Jun 2025 08:11:39 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=5e0356b90ed3a285;Sampled=0;Lineage=2:06d0fbab:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"2886\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:11:39 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"d13672c8-f96d-4a9c-a382-6944b79168ac\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=5e0356b90ed3a285;Sampled=0;Lineage=2:06d0fbab:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"d13672c8-f96d-4a9c-a382-6944b79168ac\"},\"StatusCode\":200}","failDetails":{}},"isRedriveEvent":false,"endTimestamp":1751098299804}],"dataFlow":{"input":"{\"type\":\"secrets\",\"function_name\":\"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-SecretScannerFunction-w0XQI2GV65HU\",\"payload\":{\"repo_details\":{\"pull_request_id\":\"2625925773\",\"repository_full_name\":\"belumume/sentinel-testbed\",\"commit_sha\":\"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\",\"pr_number\":32}}}","output":"{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"scanner_type\":\"secrets\",\"findings\":[{\"type\":\"API Key (Pattern Match)\",\"file\":\"test-production-v2.txt\",\"line\":3,\"raw\":\"sk-1234567890abcdef1234567890abcdef12345678\"},{\"type\":\"GitHub Token (Pattern Match)\",\"file\":\"test-production-v2.txt\",\"line\":4,\"raw\":\"ghp_1234567890abcdef1234567890abcdef1234\"},{\"type\":\"AWS Secret Key (Pattern Match)\",\"file\":\"test-production-v2.txt\",\"line\":5,\"raw\":\"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\"test-production.txt\",\"line\":3,\"raw\":\"sk-1234567890abcdef1234567890abcdef12345678\"},{\"type\":\"GitHub Token (Pattern Match)\",\"file\":\"test-production.txt\",\"line\":4,\"raw\":\"ghp_1234567890abcdef1234567890abcdef1234\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\"Dockerfile\",\"line\":15,\"raw\":\"sk_test_1234567890abcdef\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"Dockerfile\",\"line\":16,\"raw\":\"supersecret123\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"Dockerfile\",\"line\":16,\"raw\":\"supersecret123\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\".env.example\",\"line\":2,\"raw\":\"another_secret_password_123\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\".env.example\",\"line\":2,\"raw\":\"another_secret_password_123\"},{\"type\":\"Connection String (Pattern Match)\",\"file\":\".env.example\",\"line\":3,\"raw\":\"postgresql://user:secret123@localhost:5432/mydb\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\".env.example\",\"line\":6,\"raw\":\"sk-1234567890abcdefghijklmnopqrstuvwxyz1234567890a...\"},{\"type\":\"OpenAI API Key (Pattern Match)\",\"file\":\".env.example\",\"line\":6,\"raw\":\"sk-1234567890abcdefghijklmnopqrstuvwxyz1234567890a...\"},{\"type\":\"JWT Secret (Pattern Match)\",\"file\":\".env.example\",\"line\":10,\"raw\":\"my_super_secret_jwt_key_that_should_not_be_hardcod...\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\"README.md\",\"line\":6,\"raw\":\"sk_test_1234567890abcdef\"},{\"type\":\"AWS Access Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":15,\"raw\":\"AKIAIOSFODNN7EXAMPLE\"},{\"type\":\"AWS Secret Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":16,\"raw\":\"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"},{\"type\":\"Secret Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":19,\"raw\":\"sk_test_4eC39HqLyjWDarjtT1zdp7dc\"},{\"type\":\"Stripe Test Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":19,\"raw\":\"sk_test_4eC39HqLyjWDarjtT1zdp7dc\"},{\"type\":\"GitHub Token (Pattern Match)\",\"file\":\"config/database.py\",\"line\":20,\"raw\":\"ghp_1234567890abcdefghijklmnopqrstuvwxyz\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"config/database.py\",\"line\":29,\"raw\":\"DATABASE_CONFIG[\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"src/user_auth.py\",\"line\":15,\"raw\":\"{self.hash_password(password)}\"}],\"summary\":{\"total_findings\":22}},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"d13672c8-f96d-4a9c-a382-6944b79168ac\"],\"Content-Length\":[\"2886\"],\"Date\":[\"Sat, 28 Jun 2025 08:11:39 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=5e0356b90ed3a285;Sampled=0;Lineage=2:06d0fbab:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"2886\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:11:39 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"d13672c8-f96d-4a9c-a382-6944b79168ac\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=5e0356b90ed3a285;Sampled=0;Lineage=2:06d0fbab:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"d13672c8-f96d-4a9c-a382-6944b79168ac\"},\"StatusCode\":200}","failDetails":{}},"events":[{"id":4,"mapIterationStartedEventDetails":{"index":0,"name":"ParallelScans"},"previousEventId":3,"timestamp":"2025-06-28T08:11:23.600Z","type":"MapIterationStarted","redriveId":0,"stepName":"ParallelScans"},{"id":21,"mapIterationSucceededEventDetails":{"index":0,"name":"ParallelScans"},"previousEventId":20,"timestamp":"2025-06-28T08:11:39.804Z","type":"MapIterationSucceeded","redriveId":0,"stepName":"ParallelScans"}],"redriveCount":0,"availableVariables":{},"meta":{"id":1,"expandable":true,"expanded":false,"matched":true,"lastChild":false,"hasDisplayedChildren":true,"path":"[\"ParallelScans\",\"0\"]"}},"children":{"RunScanner":{"path":"[\"ParallelScans\",\"0\",\"RunScanner\"]","iteration":0,"transition":{"stepType":"Task","stepName":"RunScanner","status":3,"firstId":7,"lastId":20,"firstTimestamp":1751098283600,"lastTimestamp":1751098299804,"tries":[{"status":3,"startTimestamp":1751098283600,"dataFlow":{"output":"{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"scanner_type\":\"secrets\",\"findings\":[{\"type\":\"API Key (Pattern Match)\",\"file\":\"test-production-v2.txt\",\"line\":3,\"raw\":\"sk-1234567890abcdef1234567890abcdef12345678\"},{\"type\":\"GitHub Token (Pattern Match)\",\"file\":\"test-production-v2.txt\",\"line\":4,\"raw\":\"ghp_1234567890abcdef1234567890abcdef1234\"},{\"type\":\"AWS Secret Key (Pattern Match)\",\"file\":\"test-production-v2.txt\",\"line\":5,\"raw\":\"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\"test-production.txt\",\"line\":3,\"raw\":\"sk-1234567890abcdef1234567890abcdef12345678\"},{\"type\":\"GitHub Token (Pattern Match)\",\"file\":\"test-production.txt\",\"line\":4,\"raw\":\"ghp_1234567890abcdef1234567890abcdef1234\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\"Dockerfile\",\"line\":15,\"raw\":\"sk_test_1234567890abcdef\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"Dockerfile\",\"line\":16,\"raw\":\"supersecret123\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"Dockerfile\",\"line\":16,\"raw\":\"supersecret123\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\".env.example\",\"line\":2,\"raw\":\"another_secret_password_123\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\".env.example\",\"line\":2,\"raw\":\"another_secret_password_123\"},{\"type\":\"Connection String (Pattern Match)\",\"file\":\".env.example\",\"line\":3,\"raw\":\"postgresql://user:secret123@localhost:5432/mydb\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\".env.example\",\"line\":6,\"raw\":\"sk-1234567890abcdefghijklmnopqrstuvwxyz1234567890a...\"},{\"type\":\"OpenAI API Key (Pattern Match)\",\"file\":\".env.example\",\"line\":6,\"raw\":\"sk-1234567890abcdefghijklmnopqrstuvwxyz1234567890a...\"},{\"type\":\"JWT Secret (Pattern Match)\",\"file\":\".env.example\",\"line\":10,\"raw\":\"my_super_secret_jwt_key_that_should_not_be_hardcod...\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\"README.md\",\"line\":6,\"raw\":\"sk_test_1234567890abcdef\"},{\"type\":\"AWS Access Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":15,\"raw\":\"AKIAIOSFODNN7EXAMPLE\"},{\"type\":\"AWS Secret Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":16,\"raw\":\"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"},{\"type\":\"Secret Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":19,\"raw\":\"sk_test_4eC39HqLyjWDarjtT1zdp7dc\"},{\"type\":\"Stripe Test Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":19,\"raw\":\"sk_test_4eC39HqLyjWDarjtT1zdp7dc\"},{\"type\":\"GitHub Token (Pattern Match)\",\"file\":\"config/database.py\",\"line\":20,\"raw\":\"ghp_1234567890abcdefghijklmnopqrstuvwxyz\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"config/database.py\",\"line\":29,\"raw\":\"DATABASE_CONFIG[\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"src/user_auth.py\",\"line\":15,\"raw\":\"{self.hash_password(password)}\"}],\"summary\":{\"total_findings\":22}},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"d13672c8-f96d-4a9c-a382-6944b79168ac\"],\"Content-Length\":[\"2886\"],\"Date\":[\"Sat, 28 Jun 2025 08:11:39 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=5e0356b90ed3a285;Sampled=0;Lineage=2:06d0fbab:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"2886\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:11:39 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"d13672c8-f96d-4a9c-a382-6944b79168ac\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=5e0356b90ed3a285;Sampled=0;Lineage=2:06d0fbab:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"d13672c8-f96d-4a9c-a382-6944b79168ac\"},\"StatusCode\":200}","failDetails":{}},"isRedriveEvent":false,"endTimestamp":1751098299804}],"dataFlow":{"input":"{\"type\":\"secrets\",\"function_name\":\"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-SecretScannerFunction-w0XQI2GV65HU\",\"payload\":{\"repo_details\":{\"pull_request_id\":\"2625925773\",\"repository_full_name\":\"belumume/sentinel-testbed\",\"commit_sha\":\"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\",\"pr_number\":32}}}","output":"{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"scanner_type\":\"secrets\",\"findings\":[{\"type\":\"API Key (Pattern Match)\",\"file\":\"test-production-v2.txt\",\"line\":3,\"raw\":\"sk-1234567890abcdef1234567890abcdef12345678\"},{\"type\":\"GitHub Token (Pattern Match)\",\"file\":\"test-production-v2.txt\",\"line\":4,\"raw\":\"ghp_1234567890abcdef1234567890abcdef1234\"},{\"type\":\"AWS Secret Key (Pattern Match)\",\"file\":\"test-production-v2.txt\",\"line\":5,\"raw\":\"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\"test-production.txt\",\"line\":3,\"raw\":\"sk-1234567890abcdef1234567890abcdef12345678\"},{\"type\":\"GitHub Token (Pattern Match)\",\"file\":\"test-production.txt\",\"line\":4,\"raw\":\"ghp_1234567890abcdef1234567890abcdef1234\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\"Dockerfile\",\"line\":15,\"raw\":\"sk_test_1234567890abcdef\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"Dockerfile\",\"line\":16,\"raw\":\"supersecret123\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"Dockerfile\",\"line\":16,\"raw\":\"supersecret123\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\".env.example\",\"line\":2,\"raw\":\"another_secret_password_123\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\".env.example\",\"line\":2,\"raw\":\"another_secret_password_123\"},{\"type\":\"Connection String (Pattern Match)\",\"file\":\".env.example\",\"line\":3,\"raw\":\"postgresql://user:secret123@localhost:5432/mydb\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\".env.example\",\"line\":6,\"raw\":\"sk-1234567890abcdefghijklmnopqrstuvwxyz1234567890a...\"},{\"type\":\"OpenAI API Key (Pattern Match)\",\"file\":\".env.example\",\"line\":6,\"raw\":\"sk-1234567890abcdefghijklmnopqrstuvwxyz1234567890a...\"},{\"type\":\"JWT Secret (Pattern Match)\",\"file\":\".env.example\",\"line\":10,\"raw\":\"my_super_secret_jwt_key_that_should_not_be_hardcod...\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\"README.md\",\"line\":6,\"raw\":\"sk_test_1234567890abcdef\"},{\"type\":\"AWS Access Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":15,\"raw\":\"AKIAIOSFODNN7EXAMPLE\"},{\"type\":\"AWS Secret Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":16,\"raw\":\"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"},{\"type\":\"Secret Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":19,\"raw\":\"sk_test_4eC39HqLyjWDarjtT1zdp7dc\"},{\"type\":\"Stripe Test Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":19,\"raw\":\"sk_test_4eC39HqLyjWDarjtT1zdp7dc\"},{\"type\":\"GitHub Token (Pattern Match)\",\"file\":\"config/database.py\",\"line\":20,\"raw\":\"ghp_1234567890abcdefghijklmnopqrstuvwxyz\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"config/database.py\",\"line\":29,\"raw\":\"DATABASE_CONFIG[\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"src/user_auth.py\",\"line\":15,\"raw\":\"{self.hash_password(password)}\"}],\"summary\":{\"total_findings\":22}},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"d13672c8-f96d-4a9c-a382-6944b79168ac\"],\"Content-Length\":[\"2886\"],\"Date\":[\"Sat, 28 Jun 2025 08:11:39 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=5e0356b90ed3a285;Sampled=0;Lineage=2:06d0fbab:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"2886\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:11:39 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"d13672c8-f96d-4a9c-a382-6944b79168ac\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=5e0356b90ed3a285;Sampled=0;Lineage=2:06d0fbab:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"d13672c8-f96d-4a9c-a382-6944b79168ac\"},\"StatusCode\":200}","taskResult":"{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"scanner_type\":\"secrets\",\"findings\":[{\"type\":\"API Key (Pattern Match)\",\"file\":\"test-production-v2.txt\",\"line\":3,\"raw\":\"sk-1234567890abcdef1234567890abcdef12345678\"},{\"type\":\"GitHub Token (Pattern Match)\",\"file\":\"test-production-v2.txt\",\"line\":4,\"raw\":\"ghp_1234567890abcdef1234567890abcdef1234\"},{\"type\":\"AWS Secret Key (Pattern Match)\",\"file\":\"test-production-v2.txt\",\"line\":5,\"raw\":\"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\"test-production.txt\",\"line\":3,\"raw\":\"sk-1234567890abcdef1234567890abcdef12345678\"},{\"type\":\"GitHub Token (Pattern Match)\",\"file\":\"test-production.txt\",\"line\":4,\"raw\":\"ghp_1234567890abcdef1234567890abcdef1234\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\"Dockerfile\",\"line\":15,\"raw\":\"sk_test_1234567890abcdef\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"Dockerfile\",\"line\":16,\"raw\":\"supersecret123\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"Dockerfile\",\"line\":16,\"raw\":\"supersecret123\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\".env.example\",\"line\":2,\"raw\":\"another_secret_password_123\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\".env.example\",\"line\":2,\"raw\":\"another_secret_password_123\"},{\"type\":\"Connection String (Pattern Match)\",\"file\":\".env.example\",\"line\":3,\"raw\":\"postgresql://user:secret123@localhost:5432/mydb\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\".env.example\",\"line\":6,\"raw\":\"sk-1234567890abcdefghijklmnopqrstuvwxyz1234567890a...\"},{\"type\":\"OpenAI API Key (Pattern Match)\",\"file\":\".env.example\",\"line\":6,\"raw\":\"sk-1234567890abcdefghijklmnopqrstuvwxyz1234567890a...\"},{\"type\":\"JWT Secret (Pattern Match)\",\"file\":\".env.example\",\"line\":10,\"raw\":\"my_super_secret_jwt_key_that_should_not_be_hardcod...\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\"README.md\",\"line\":6,\"raw\":\"sk_test_1234567890abcdef\"},{\"type\":\"AWS Access Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":15,\"raw\":\"AKIAIOSFODNN7EXAMPLE\"},{\"type\":\"AWS Secret Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":16,\"raw\":\"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"},{\"type\":\"Secret Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":19,\"raw\":\"sk_test_4eC39HqLyjWDarjtT1zdp7dc\"},{\"type\":\"Stripe Test Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":19,\"raw\":\"sk_test_4eC39HqLyjWDarjtT1zdp7dc\"},{\"type\":\"GitHub Token (Pattern Match)\",\"file\":\"config/database.py\",\"line\":20,\"raw\":\"ghp_1234567890abcdefghijklmnopqrstuvwxyz\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"config/database.py\",\"line\":29,\"raw\":\"DATABASE_CONFIG[\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"src/user_auth.py\",\"line\":15,\"raw\":\"{self.hash_password(password)}\"}],\"summary\":{\"total_findings\":22}},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"d13672c8-f96d-4a9c-a382-6944b79168ac\"],\"Content-Length\":[\"2886\"],\"Date\":[\"Sat, 28 Jun 2025 08:11:39 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=5e0356b90ed3a285;Sampled=0;Lineage=2:06d0fbab:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"2886\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:11:39 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"d13672c8-f96d-4a9c-a382-6944b79168ac\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=5e0356b90ed3a285;Sampled=0;Lineage=2:06d0fbab:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"d13672c8-f96d-4a9c-a382-6944b79168ac\"},\"StatusCode\":200}","taskResultTruncated":false,"failDetails":{}},"events":[{"id":7,"previousEventId":4,"stateEnteredEventDetails":{"input":"{\"type\":\"secrets\",\"function_name\":\"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-SecretScannerFunction-w0XQI2GV65HU\",\"payload\":{\"repo_details\":{\"pull_request_id\":\"2625925773\",\"repository_full_name\":\"belumume/sentinel-testbed\",\"commit_sha\":\"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\",\"pr_number\":32}}}","inputDetails":{"truncated":false},"name":"RunScanner"},"timestamp":"2025-06-28T08:11:23.600Z","type":"TaskStateEntered","redriveId":0,"stepName":"RunScanner"},{"id":8,"previousEventId":7,"taskScheduledEventDetails":{"parameters":{"FunctionName":"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-SecretScannerFunction-w0XQI2GV65HU","Payload":{"repo_details":{"pull_request_id":"2625925773","repository_full_name":"belumume/sentinel-testbed","commit_sha":"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f","pr_number":32}}},"region":"us-east-1","resource":"invoke","resourceType":"lambda"},"timestamp":"2025-06-28T08:11:23.600Z","type":"TaskScheduled","redriveId":0,"stepName":"RunScanner"},{"id":15,"previousEventId":8,"taskStartedEventDetails":{"resource":"invoke","resourceType":"lambda"},"timestamp":"2025-06-28T08:11:23.687Z","type":"TaskStarted","redriveId":0,"stepName":"RunScanner"},{"id":19,"previousEventId":15,"taskSucceededEventDetails":{"output":"{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"scanner_type\":\"secrets\",\"findings\":[{\"type\":\"API Key (Pattern Match)\",\"file\":\"test-production-v2.txt\",\"line\":3,\"raw\":\"sk-1234567890abcdef1234567890abcdef12345678\"},{\"type\":\"GitHub Token (Pattern Match)\",\"file\":\"test-production-v2.txt\",\"line\":4,\"raw\":\"ghp_1234567890abcdef1234567890abcdef1234\"},{\"type\":\"AWS Secret Key (Pattern Match)\",\"file\":\"test-production-v2.txt\",\"line\":5,\"raw\":\"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\"test-production.txt\",\"line\":3,\"raw\":\"sk-1234567890abcdef1234567890abcdef12345678\"},{\"type\":\"GitHub Token (Pattern Match)\",\"file\":\"test-production.txt\",\"line\":4,\"raw\":\"ghp_1234567890abcdef1234567890abcdef1234\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\"Dockerfile\",\"line\":15,\"raw\":\"sk_test_1234567890abcdef\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"Dockerfile\",\"line\":16,\"raw\":\"supersecret123\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"Dockerfile\",\"line\":16,\"raw\":\"supersecret123\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\".env.example\",\"line\":2,\"raw\":\"another_secret_password_123\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\".env.example\",\"line\":2,\"raw\":\"another_secret_password_123\"},{\"type\":\"Connection String (Pattern Match)\",\"file\":\".env.example\",\"line\":3,\"raw\":\"postgresql://user:secret123@localhost:5432/mydb\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\".env.example\",\"line\":6,\"raw\":\"sk-1234567890abcdefghijklmnopqrstuvwxyz1234567890a...\"},{\"type\":\"OpenAI API Key (Pattern Match)\",\"file\":\".env.example\",\"line\":6,\"raw\":\"sk-1234567890abcdefghijklmnopqrstuvwxyz1234567890a...\"},{\"type\":\"JWT Secret (Pattern Match)\",\"file\":\".env.example\",\"line\":10,\"raw\":\"my_super_secret_jwt_key_that_should_not_be_hardcod...\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\"README.md\",\"line\":6,\"raw\":\"sk_test_1234567890abcdef\"},{\"type\":\"AWS Access Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":15,\"raw\":\"AKIAIOSFODNN7EXAMPLE\"},{\"type\":\"AWS Secret Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":16,\"raw\":\"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"},{\"type\":\"Secret Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":19,\"raw\":\"sk_test_4eC39HqLyjWDarjtT1zdp7dc\"},{\"type\":\"Stripe Test Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":19,\"raw\":\"sk_test_4eC39HqLyjWDarjtT1zdp7dc\"},{\"type\":\"GitHub Token (Pattern Match)\",\"file\":\"config/database.py\",\"line\":20,\"raw\":\"ghp_1234567890abcdefghijklmnopqrstuvwxyz\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"config/database.py\",\"line\":29,\"raw\":\"DATABASE_CONFIG[\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"src/user_auth.py\",\"line\":15,\"raw\":\"{self.hash_password(password)}\"}],\"summary\":{\"total_findings\":22}},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"d13672c8-f96d-4a9c-a382-6944b79168ac\"],\"Content-Length\":[\"2886\"],\"Date\":[\"Sat, 28 Jun 2025 08:11:39 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=5e0356b90ed3a285;Sampled=0;Lineage=2:06d0fbab:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"2886\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:11:39 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"d13672c8-f96d-4a9c-a382-6944b79168ac\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=5e0356b90ed3a285;Sampled=0;Lineage=2:06d0fbab:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"d13672c8-f96d-4a9c-a382-6944b79168ac\"},\"StatusCode\":200}","outputDetails":{"truncated":false},"resource":"invoke","resourceType":"lambda"},"timestamp":"2025-06-28T08:11:39.785Z","type":"TaskSucceeded","redriveId":0,"stepName":"RunScanner"},{"id":20,"previousEventId":19,"stateExitedEventDetails":{"name":"RunScanner","output":"{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"scanner_type\":\"secrets\",\"findings\":[{\"type\":\"API Key (Pattern Match)\",\"file\":\"test-production-v2.txt\",\"line\":3,\"raw\":\"sk-1234567890abcdef1234567890abcdef12345678\"},{\"type\":\"GitHub Token (Pattern Match)\",\"file\":\"test-production-v2.txt\",\"line\":4,\"raw\":\"ghp_1234567890abcdef1234567890abcdef1234\"},{\"type\":\"AWS Secret Key (Pattern Match)\",\"file\":\"test-production-v2.txt\",\"line\":5,\"raw\":\"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\"test-production.txt\",\"line\":3,\"raw\":\"sk-1234567890abcdef1234567890abcdef12345678\"},{\"type\":\"GitHub Token (Pattern Match)\",\"file\":\"test-production.txt\",\"line\":4,\"raw\":\"ghp_1234567890abcdef1234567890abcdef1234\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\"Dockerfile\",\"line\":15,\"raw\":\"sk_test_1234567890abcdef\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"Dockerfile\",\"line\":16,\"raw\":\"supersecret123\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"Dockerfile\",\"line\":16,\"raw\":\"supersecret123\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\".env.example\",\"line\":2,\"raw\":\"another_secret_password_123\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\".env.example\",\"line\":2,\"raw\":\"another_secret_password_123\"},{\"type\":\"Connection String (Pattern Match)\",\"file\":\".env.example\",\"line\":3,\"raw\":\"postgresql://user:secret123@localhost:5432/mydb\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\".env.example\",\"line\":6,\"raw\":\"sk-1234567890abcdefghijklmnopqrstuvwxyz1234567890a...\"},{\"type\":\"OpenAI API Key (Pattern Match)\",\"file\":\".env.example\",\"line\":6,\"raw\":\"sk-1234567890abcdefghijklmnopqrstuvwxyz1234567890a...\"},{\"type\":\"JWT Secret (Pattern Match)\",\"file\":\".env.example\",\"line\":10,\"raw\":\"my_super_secret_jwt_key_that_should_not_be_hardcod...\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\"README.md\",\"line\":6,\"raw\":\"sk_test_1234567890abcdef\"},{\"type\":\"AWS Access Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":15,\"raw\":\"AKIAIOSFODNN7EXAMPLE\"},{\"type\":\"AWS Secret Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":16,\"raw\":\"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"},{\"type\":\"Secret Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":19,\"raw\":\"sk_test_4eC39HqLyjWDarjtT1zdp7dc\"},{\"type\":\"Stripe Test Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":19,\"raw\":\"sk_test_4eC39HqLyjWDarjtT1zdp7dc\"},{\"type\":\"GitHub Token (Pattern Match)\",\"file\":\"config/database.py\",\"line\":20,\"raw\":\"ghp_1234567890abcdefghijklmnopqrstuvwxyz\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"config/database.py\",\"line\":29,\"raw\":\"DATABASE_CONFIG[\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"src/user_auth.py\",\"line\":15,\"raw\":\"{self.hash_password(password)}\"}],\"summary\":{\"total_findings\":22}},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"d13672c8-f96d-4a9c-a382-6944b79168ac\"],\"Content-Length\":[\"2886\"],\"Date\":[\"Sat, 28 Jun 2025 08:11:39 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=5e0356b90ed3a285;Sampled=0;Lineage=2:06d0fbab:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"2886\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:11:39 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"d13672c8-f96d-4a9c-a382-6944b79168ac\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=5e0356b90ed3a285;Sampled=0;Lineage=2:06d0fbab:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"d13672c8-f96d-4a9c-a382-6944b79168ac\"},\"StatusCode\":200}","outputDetails":{"truncated":false}},"timestamp":"2025-06-28T08:11:39.804Z","type":"TaskStateExited","redriveId":0,"stepName":"RunScanner"}],"redriveCount":0,"availableVariables":{},"resource":{"parameters":{"FunctionName":"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-SecretScannerFunction-w0XQI2GV65HU","Payload":{"repo_details":{"pull_request_id":"2625925773","repository_full_name":"belumume/sentinel-testbed","commit_sha":"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f","pr_number":32}}},"region":"us-east-1","resource":"invoke","resourceType":"lambda"},"meta":{"id":2,"expandable":false,"expanded":false,"matched":true,"lastChild":true,"hasDisplayedChildren":false,"path":"[\"ParallelScans\",\"0\",\"RunScanner\"]"}}}}},"1":{"path":"[\"ParallelScans\",\"1\"]","iteration":0,"transition":{"status":3,"firstId":5,"lastId":18,"stepType":"MapIteration","stepName":"1","firstTimestamp":1751098283600,"lastTimestamp":1751098283800,"tries":[{"status":3,"startTimestamp":1751098283600,"dataFlow":{"output":"{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"scanner_type\":\"vulnerabilities\",\"findings\":[],\"summary\":{\"total_findings\":0,\"by_severity\":{},\"by_language\":{}}},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"0f8f7504-f819-429a-bce4-4c7615c218a3\"],\"Content-Length\":[\"142\"],\"Date\":[\"Sat, 28 Jun 2025 08:11:23 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=0fe9df82f88a24aa;Sampled=0;Lineage=2:9da352f3:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"142\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:11:23 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"0f8f7504-f819-429a-bce4-4c7615c218a3\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=0fe9df82f88a24aa;Sampled=0;Lineage=2:9da352f3:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"0f8f7504-f819-429a-bce4-4c7615c218a3\"},\"StatusCode\":200}","failDetails":{}},"isRedriveEvent":false,"endTimestamp":1751098283800}],"dataFlow":{"input":"{\"type\":\"vulnerabilities\",\"function_name\":\"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-VulnerabilityScannerFunction-Fk7ek2H2Mdqn\",\"payload\":{\"repo_details\":{\"pull_request_id\":\"2625925773\",\"repository_full_name\":\"belumume/sentinel-testbed\",\"commit_sha\":\"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\",\"pr_number\":32}}}","output":"{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"scanner_type\":\"vulnerabilities\",\"findings\":[],\"summary\":{\"total_findings\":0,\"by_severity\":{},\"by_language\":{}}},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"0f8f7504-f819-429a-bce4-4c7615c218a3\"],\"Content-Length\":[\"142\"],\"Date\":[\"Sat, 28 Jun 2025 08:11:23 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=0fe9df82f88a24aa;Sampled=0;Lineage=2:9da352f3:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"142\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:11:23 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"0f8f7504-f819-429a-bce4-4c7615c218a3\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=0fe9df82f88a24aa;Sampled=0;Lineage=2:9da352f3:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"0f8f7504-f819-429a-bce4-4c7615c218a3\"},\"StatusCode\":200}","failDetails":{}},"events":[{"id":5,"mapIterationStartedEventDetails":{"index":1,"name":"ParallelScans"},"previousEventId":3,"timestamp":"2025-06-28T08:11:23.600Z","type":"MapIterationStarted","redriveId":0,"stepName":"ParallelScans"},{"id":18,"mapIterationSucceededEventDetails":{"index":1,"name":"ParallelScans"},"previousEventId":17,"timestamp":"2025-06-28T08:11:23.800Z","type":"MapIterationSucceeded","redriveId":0,"stepName":"ParallelScans"}],"redriveCount":0,"availableVariables":{},"meta":{"id":3,"expandable":true,"expanded":false,"matched":true,"lastChild":false,"hasDisplayedChildren":true,"path":"[\"ParallelScans\",\"1\"]"}},"children":{"RunScanner":{"path":"[\"ParallelScans\",\"1\",\"RunScanner\"]","iteration":0,"transition":{"stepType":"Task","stepName":"RunScanner","status":3,"firstId":9,"lastId":17,"firstTimestamp":1751098283600,"lastTimestamp":1751098283800,"tries":[{"status":3,"startTimestamp":1751098283600,"dataFlow":{"output":"{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"scanner_type\":\"vulnerabilities\",\"findings\":[],\"summary\":{\"total_findings\":0,\"by_severity\":{},\"by_language\":{}}},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"0f8f7504-f819-429a-bce4-4c7615c218a3\"],\"Content-Length\":[\"142\"],\"Date\":[\"Sat, 28 Jun 2025 08:11:23 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=0fe9df82f88a24aa;Sampled=0;Lineage=2:9da352f3:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"142\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:11:23 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"0f8f7504-f819-429a-bce4-4c7615c218a3\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=0fe9df82f88a24aa;Sampled=0;Lineage=2:9da352f3:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"0f8f7504-f819-429a-bce4-4c7615c218a3\"},\"StatusCode\":200}","failDetails":{}},"isRedriveEvent":false,"endTimestamp":1751098283800}],"dataFlow":{"input":"{\"type\":\"vulnerabilities\",\"function_name\":\"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-VulnerabilityScannerFunction-Fk7ek2H2Mdqn\",\"payload\":{\"repo_details\":{\"pull_request_id\":\"2625925773\",\"repository_full_name\":\"belumume/sentinel-testbed\",\"commit_sha\":\"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\",\"pr_number\":32}}}","output":"{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"scanner_type\":\"vulnerabilities\",\"findings\":[],\"summary\":{\"total_findings\":0,\"by_severity\":{},\"by_language\":{}}},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"0f8f7504-f819-429a-bce4-4c7615c218a3\"],\"Content-Length\":[\"142\"],\"Date\":[\"Sat, 28 Jun 2025 08:11:23 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=0fe9df82f88a24aa;Sampled=0;Lineage=2:9da352f3:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"142\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:11:23 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"0f8f7504-f819-429a-bce4-4c7615c218a3\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=0fe9df82f88a24aa;Sampled=0;Lineage=2:9da352f3:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"0f8f7504-f819-429a-bce4-4c7615c218a3\"},\"StatusCode\":200}","taskResult":"{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"scanner_type\":\"vulnerabilities\",\"findings\":[],\"summary\":{\"total_findings\":0,\"by_severity\":{},\"by_language\":{}}},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"0f8f7504-f819-429a-bce4-4c7615c218a3\"],\"Content-Length\":[\"142\"],\"Date\":[\"Sat, 28 Jun 2025 08:11:23 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=0fe9df82f88a24aa;Sampled=0;Lineage=2:9da352f3:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"142\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:11:23 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"0f8f7504-f819-429a-bce4-4c7615c218a3\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=0fe9df82f88a24aa;Sampled=0;Lineage=2:9da352f3:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"0f8f7504-f819-429a-bce4-4c7615c218a3\"},\"StatusCode\":200}","taskResultTruncated":false,"failDetails":{}},"events":[{"id":9,"previousEventId":5,"stateEnteredEventDetails":{"input":"{\"type\":\"vulnerabilities\",\"function_name\":\"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-VulnerabilityScannerFunction-Fk7ek2H2Mdqn\",\"payload\":{\"repo_details\":{\"pull_request_id\":\"2625925773\",\"repository_full_name\":\"belumume/sentinel-testbed\",\"commit_sha\":\"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\",\"pr_number\":32}}}","inputDetails":{"truncated":false},"name":"RunScanner"},"timestamp":"2025-06-28T08:11:23.600Z","type":"TaskStateEntered","redriveId":0,"stepName":"RunScanner"},{"id":10,"previousEventId":9,"taskScheduledEventDetails":{"parameters":{"FunctionName":"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-VulnerabilityScannerFunction-Fk7ek2H2Mdqn","Payload":{"repo_details":{"pull_request_id":"2625925773","repository_full_name":"belumume/sentinel-testbed","commit_sha":"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f","pr_number":32}}},"region":"us-east-1","resource":"invoke","resourceType":"lambda"},"timestamp":"2025-06-28T08:11:23.600Z","type":"TaskScheduled","redriveId":0,"stepName":"RunScanner"},{"id":14,"previousEventId":10,"taskStartedEventDetails":{"resource":"invoke","resourceType":"lambda"},"timestamp":"2025-06-28T08:11:23.686Z","type":"TaskStarted","redriveId":0,"stepName":"RunScanner"},{"id":16,"previousEventId":14,"taskSucceededEventDetails":{"output":"{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"scanner_type\":\"vulnerabilities\",\"findings\":[],\"summary\":{\"total_findings\":0,\"by_severity\":{},\"by_language\":{}}},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"0f8f7504-f819-429a-bce4-4c7615c218a3\"],\"Content-Length\":[\"142\"],\"Date\":[\"Sat, 28 Jun 2025 08:11:23 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=0fe9df82f88a24aa;Sampled=0;Lineage=2:9da352f3:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"142\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:11:23 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"0f8f7504-f819-429a-bce4-4c7615c218a3\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=0fe9df82f88a24aa;Sampled=0;Lineage=2:9da352f3:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"0f8f7504-f819-429a-bce4-4c7615c218a3\"},\"StatusCode\":200}","outputDetails":{"truncated":false},"resource":"invoke","resourceType":"lambda"},"timestamp":"2025-06-28T08:11:23.781Z","type":"TaskSucceeded","redriveId":0,"stepName":"RunScanner"},{"id":17,"previousEventId":16,"stateExitedEventDetails":{"name":"RunScanner","output":"{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"scanner_type\":\"vulnerabilities\",\"findings\":[],\"summary\":{\"total_findings\":0,\"by_severity\":{},\"by_language\":{}}},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"0f8f7504-f819-429a-bce4-4c7615c218a3\"],\"Content-Length\":[\"142\"],\"Date\":[\"Sat, 28 Jun 2025 08:11:23 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=0fe9df82f88a24aa;Sampled=0;Lineage=2:9da352f3:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"142\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:11:23 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"0f8f7504-f819-429a-bce4-4c7615c218a3\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=0fe9df82f88a24aa;Sampled=0;Lineage=2:9da352f3:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"0f8f7504-f819-429a-bce4-4c7615c218a3\"},\"StatusCode\":200}","outputDetails":{"truncated":false}},"timestamp":"2025-06-28T08:11:23.800Z","type":"TaskStateExited","redriveId":0,"stepName":"RunScanner"}],"redriveCount":0,"availableVariables":{},"resource":{"parameters":{"FunctionName":"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-VulnerabilityScannerFunction-Fk7ek2H2Mdqn","Payload":{"repo_details":{"pull_request_id":"2625925773","repository_full_name":"belumume/sentinel-testbed","commit_sha":"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f","pr_number":32}}},"region":"us-east-1","resource":"invoke","resourceType":"lambda"},"meta":{"id":4,"expandable":false,"expanded":false,"matched":true,"lastChild":true,"hasDisplayedChildren":false,"path":"[\"ParallelScans\",\"1\",\"RunScanner\"]"}}}}},"2":{"path":"[\"ParallelScans\",\"2\"]","iteration":0,"transition":{"status":3,"firstId":6,"lastId":24,"stepType":"MapIteration","stepName":"2","firstTimestamp":1751098283600,"lastTimestamp":1751098318147,"tries":[{"status":3,"startTimestamp":1751098283600,"dataFlow":{"output":"{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"scanner_type\":\"ai_review\",\"findings\":[{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\".env.example\",\"line\":1,\"description\":\"Sensitive information exposed in .env.example file\",\"recommendation\":\"Remove all real API keys, passwords, and secrets from .env.example. Use placeholder values instead.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"Dockerfile\",\"line\":15,\"description\":\"Sensitive environment variables hardcoded in Dockerfile\",\"recommendation\":\"Remove API_KEY and DB_PASSWORD from Dockerfile. Use environment variables or secrets management instead.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"README.md\",\"line\":6,\"description\":\"API key exposed in README file\",\"recommendation\":\"Remove the API_KEY from the README file. Never commit sensitive information to version control.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"config/database.py\",\"line\":9,\"description\":\"Hardcoded database credentials in source code\",\"recommendation\":\"Remove hardcoded credentials and use environment variables or a secure configuration management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"config/database.py\",\"line\":15,\"description\":\"AWS credentials exposed in source code\",\"recommendation\":\"Remove AWS credentials from source code. Use AWS IAM roles or environment variables instead.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"config/database.py\",\"line\":19,\"description\":\"Stripe and GitHub tokens exposed in source code\",\"recommendation\":\"Remove Stripe and GitHub tokens from source code. Use environment variables or a secure secret management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/file_upload.py\",\"line\":24,\"description\":\"Arbitrary code execution vulnerability in file upload\",\"recommendation\":\"Remove the os.system call. Never execute uploaded files directly. Implement proper file validation and sandboxing.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/file_upload.py\",\"line\":33,\"description\":\"Path traversal vulnerability in file download\",\"recommendation\":\"Validate and sanitize the filename to prevent path traversal attacks. Use os.path.basename() and restrict to a specific directory.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":15,\"description\":\"SQL injection vulnerability in authentication query\",\"recommendation\":\"Use parameterized queries instead of string formatting to prevent SQL injection attacks.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":32,\"description\":\"Weak password hashing algorithm (MD5)\",\"recommendation\":\"Replace MD5 with a strong, modern hashing algorithm like bcrypt, Argon2, or PBKDF2.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":40,\"description\":\"SQL injection vulnerability in password reset functionality\",\"recommendation\":\"Use parameterized queries instead of string formatting to prevent SQL injection attacks.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":48,\"description\":\"Insecure admin access check using request headers\",\"recommendation\":\"Remove the header-based admin override. Implement proper authentication and authorization checks.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"test-production-v2.txt\",\"line\":3,\"description\":\"Sensitive API keys and tokens exposed in plain text file\",\"recommendation\":\"Remove all API keys, tokens, and secrets from this file. Use environment variables or a secure secrets management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"test-production.txt\",\"line\":3,\"description\":\"Sensitive API keys and tokens exposed in plain text file\",\"recommendation\":\"Remove all API keys and tokens from this file. Use environment variables or a secure secrets management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Best Practices\",\"priority\":\"medium\",\"file\":\"Dockerfile\",\"line\":3,\"description\":\"Using outdated Ubuntu base image\",\"recommendation\":\"Update to a more recent Ubuntu LTS version or consider using a more lightweight base image like Alpine.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"medium\",\"file\":\"Dockerfile\",\"line\":6,\"description\":\"Running container as root user\",\"recommendation\":\"Create a non-root user and use the USER instruction to run the container with least privileges.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"medium\",\"file\":\"Dockerfile\",\"line\":26,\"description\":\"Unnecessary ports exposed in Dockerfile\",\"recommendation\":\"Only expose the ports that are actually needed for the application to function.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"package.json\",\"line\":1,\"description\":\"Multiple outdated dependencies with known vulnerabilities\",\"recommendation\":\"Update all dependencies to their latest secure versions, especially lodash, moment, express, mongoose, and others.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"requirements.txt\",\"line\":1,\"description\":\"Multiple outdated Python dependencies with known vulnerabilities\",\"recommendation\":\"Update all dependencies to their latest secure versions, especially Django, requests, PyYAML, urllib3, Flask, and others.\"},{\"type\":\"ai_suggestion\",\"category\":\"Maintainability\",\"priority\":\"medium\",\"file\":\"src/file_upload.py\",\"line\":1,\"description\":\"Lack of input validation and error handling in file operations\",\"recommendation\":\"Implement proper input validation, error handling, and logging for all file operations.\"},{\"type\":\"ai_suggestion\",\"category\":\"Maintainability\",\"priority\":\"medium\",\"file\":\"src/user_auth.py\",\"line\":1,\"description\":\"Lack of proper error handling and logging in authentication functions\",\"recommendation\":\"Implement proper error handling, logging, and security event auditing for all authentication-related functions.\"}],\"summary\":{\"total_findings\":21,\"high_priority\":16,\"medium_priority\":5,\"low_priority\":0}},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"305be4c6-9ff3-4077-93f5-a11917966695\"],\"Content-Length\":[\"6524\"],\"Date\":[\"Sat, 28 Jun 2025 08:11:58 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=6a7d674b55504166;Sampled=0;Lineage=2:c73855c7:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"6524\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:11:58 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"305be4c6-9ff3-4077-93f5-a11917966695\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=6a7d674b55504166;Sampled=0;Lineage=2:c73855c7:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"305be4c6-9ff3-4077-93f5-a11917966695\"},\"StatusCode\":200}","failDetails":{}},"isRedriveEvent":false,"endTimestamp":1751098318147}],"dataFlow":{"input":"{\"type\":\"ai_review\",\"function_name\":\"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-AIReviewerFunction-O4EWbVoTnbOd\",\"payload\":{\"repo_details\":{\"pull_request_id\":\"2625925773\",\"repository_full_name\":\"belumume/sentinel-testbed\",\"commit_sha\":\"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\",\"pr_number\":32}}}","output":"{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"scanner_type\":\"ai_review\",\"findings\":[{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\".env.example\",\"line\":1,\"description\":\"Sensitive information exposed in .env.example file\",\"recommendation\":\"Remove all real API keys, passwords, and secrets from .env.example. Use placeholder values instead.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"Dockerfile\",\"line\":15,\"description\":\"Sensitive environment variables hardcoded in Dockerfile\",\"recommendation\":\"Remove API_KEY and DB_PASSWORD from Dockerfile. Use environment variables or secrets management instead.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"README.md\",\"line\":6,\"description\":\"API key exposed in README file\",\"recommendation\":\"Remove the API_KEY from the README file. Never commit sensitive information to version control.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"config/database.py\",\"line\":9,\"description\":\"Hardcoded database credentials in source code\",\"recommendation\":\"Remove hardcoded credentials and use environment variables or a secure configuration management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"config/database.py\",\"line\":15,\"description\":\"AWS credentials exposed in source code\",\"recommendation\":\"Remove AWS credentials from source code. Use AWS IAM roles or environment variables instead.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"config/database.py\",\"line\":19,\"description\":\"Stripe and GitHub tokens exposed in source code\",\"recommendation\":\"Remove Stripe and GitHub tokens from source code. Use environment variables or a secure secret management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/file_upload.py\",\"line\":24,\"description\":\"Arbitrary code execution vulnerability in file upload\",\"recommendation\":\"Remove the os.system call. Never execute uploaded files directly. Implement proper file validation and sandboxing.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/file_upload.py\",\"line\":33,\"description\":\"Path traversal vulnerability in file download\",\"recommendation\":\"Validate and sanitize the filename to prevent path traversal attacks. Use os.path.basename() and restrict to a specific directory.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":15,\"description\":\"SQL injection vulnerability in authentication query\",\"recommendation\":\"Use parameterized queries instead of string formatting to prevent SQL injection attacks.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":32,\"description\":\"Weak password hashing algorithm (MD5)\",\"recommendation\":\"Replace MD5 with a strong, modern hashing algorithm like bcrypt, Argon2, or PBKDF2.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":40,\"description\":\"SQL injection vulnerability in password reset functionality\",\"recommendation\":\"Use parameterized queries instead of string formatting to prevent SQL injection attacks.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":48,\"description\":\"Insecure admin access check using request headers\",\"recommendation\":\"Remove the header-based admin override. Implement proper authentication and authorization checks.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"test-production-v2.txt\",\"line\":3,\"description\":\"Sensitive API keys and tokens exposed in plain text file\",\"recommendation\":\"Remove all API keys, tokens, and secrets from this file. Use environment variables or a secure secrets management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"test-production.txt\",\"line\":3,\"description\":\"Sensitive API keys and tokens exposed in plain text file\",\"recommendation\":\"Remove all API keys and tokens from this file. Use environment variables or a secure secrets management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Best Practices\",\"priority\":\"medium\",\"file\":\"Dockerfile\",\"line\":3,\"description\":\"Using outdated Ubuntu base image\",\"recommendation\":\"Update to a more recent Ubuntu LTS version or consider using a more lightweight base image like Alpine.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"medium\",\"file\":\"Dockerfile\",\"line\":6,\"description\":\"Running container as root user\",\"recommendation\":\"Create a non-root user and use the USER instruction to run the container with least privileges.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"medium\",\"file\":\"Dockerfile\",\"line\":26,\"description\":\"Unnecessary ports exposed in Dockerfile\",\"recommendation\":\"Only expose the ports that are actually needed for the application to function.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"package.json\",\"line\":1,\"description\":\"Multiple outdated dependencies with known vulnerabilities\",\"recommendation\":\"Update all dependencies to their latest secure versions, especially lodash, moment, express, mongoose, and others.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"requirements.txt\",\"line\":1,\"description\":\"Multiple outdated Python dependencies with known vulnerabilities\",\"recommendation\":\"Update all dependencies to their latest secure versions, especially Django, requests, PyYAML, urllib3, Flask, and others.\"},{\"type\":\"ai_suggestion\",\"category\":\"Maintainability\",\"priority\":\"medium\",\"file\":\"src/file_upload.py\",\"line\":1,\"description\":\"Lack of input validation and error handling in file operations\",\"recommendation\":\"Implement proper input validation, error handling, and logging for all file operations.\"},{\"type\":\"ai_suggestion\",\"category\":\"Maintainability\",\"priority\":\"medium\",\"file\":\"src/user_auth.py\",\"line\":1,\"description\":\"Lack of proper error handling and logging in authentication functions\",\"recommendation\":\"Implement proper error handling, logging, and security event auditing for all authentication-related functions.\"}],\"summary\":{\"total_findings\":21,\"high_priority\":16,\"medium_priority\":5,\"low_priority\":0}},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"305be4c6-9ff3-4077-93f5-a11917966695\"],\"Content-Length\":[\"6524\"],\"Date\":[\"Sat, 28 Jun 2025 08:11:58 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=6a7d674b55504166;Sampled=0;Lineage=2:c73855c7:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"6524\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:11:58 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"305be4c6-9ff3-4077-93f5-a11917966695\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=6a7d674b55504166;Sampled=0;Lineage=2:c73855c7:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"305be4c6-9ff3-4077-93f5-a11917966695\"},\"StatusCode\":200}","failDetails":{}},"events":[{"id":6,"mapIterationStartedEventDetails":{"index":2,"name":"ParallelScans"},"previousEventId":3,"timestamp":"2025-06-28T08:11:23.600Z","type":"MapIterationStarted","redriveId":0,"stepName":"ParallelScans"},{"id":24,"mapIterationSucceededEventDetails":{"index":2,"name":"ParallelScans"},"previousEventId":23,"timestamp":"2025-06-28T08:11:58.147Z","type":"MapIterationSucceeded","redriveId":0,"stepName":"ParallelScans"}],"redriveCount":0,"availableVariables":{},"meta":{"id":5,"expandable":true,"expanded":false,"matched":true,"lastChild":true,"hasDisplayedChildren":true,"path":"[\"ParallelScans\",\"2\"]"}},"children":{"RunScanner":{"path":"[\"ParallelScans\",\"2\",\"RunScanner\"]","iteration":0,"transition":{"stepType":"Task","stepName":"RunScanner","status":3,"firstId":11,"lastId":23,"firstTimestamp":1751098283600,"lastTimestamp":1751098318147,"tries":[{"status":3,"startTimestamp":1751098283600,"dataFlow":{"output":"{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"scanner_type\":\"ai_review\",\"findings\":[{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\".env.example\",\"line\":1,\"description\":\"Sensitive information exposed in .env.example file\",\"recommendation\":\"Remove all real API keys, passwords, and secrets from .env.example. Use placeholder values instead.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"Dockerfile\",\"line\":15,\"description\":\"Sensitive environment variables hardcoded in Dockerfile\",\"recommendation\":\"Remove API_KEY and DB_PASSWORD from Dockerfile. Use environment variables or secrets management instead.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"README.md\",\"line\":6,\"description\":\"API key exposed in README file\",\"recommendation\":\"Remove the API_KEY from the README file. Never commit sensitive information to version control.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"config/database.py\",\"line\":9,\"description\":\"Hardcoded database credentials in source code\",\"recommendation\":\"Remove hardcoded credentials and use environment variables or a secure configuration management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"config/database.py\",\"line\":15,\"description\":\"AWS credentials exposed in source code\",\"recommendation\":\"Remove AWS credentials from source code. Use AWS IAM roles or environment variables instead.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"config/database.py\",\"line\":19,\"description\":\"Stripe and GitHub tokens exposed in source code\",\"recommendation\":\"Remove Stripe and GitHub tokens from source code. Use environment variables or a secure secret management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/file_upload.py\",\"line\":24,\"description\":\"Arbitrary code execution vulnerability in file upload\",\"recommendation\":\"Remove the os.system call. Never execute uploaded files directly. Implement proper file validation and sandboxing.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/file_upload.py\",\"line\":33,\"description\":\"Path traversal vulnerability in file download\",\"recommendation\":\"Validate and sanitize the filename to prevent path traversal attacks. Use os.path.basename() and restrict to a specific directory.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":15,\"description\":\"SQL injection vulnerability in authentication query\",\"recommendation\":\"Use parameterized queries instead of string formatting to prevent SQL injection attacks.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":32,\"description\":\"Weak password hashing algorithm (MD5)\",\"recommendation\":\"Replace MD5 with a strong, modern hashing algorithm like bcrypt, Argon2, or PBKDF2.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":40,\"description\":\"SQL injection vulnerability in password reset functionality\",\"recommendation\":\"Use parameterized queries instead of string formatting to prevent SQL injection attacks.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":48,\"description\":\"Insecure admin access check using request headers\",\"recommendation\":\"Remove the header-based admin override. Implement proper authentication and authorization checks.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"test-production-v2.txt\",\"line\":3,\"description\":\"Sensitive API keys and tokens exposed in plain text file\",\"recommendation\":\"Remove all API keys, tokens, and secrets from this file. Use environment variables or a secure secrets management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"test-production.txt\",\"line\":3,\"description\":\"Sensitive API keys and tokens exposed in plain text file\",\"recommendation\":\"Remove all API keys and tokens from this file. Use environment variables or a secure secrets management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Best Practices\",\"priority\":\"medium\",\"file\":\"Dockerfile\",\"line\":3,\"description\":\"Using outdated Ubuntu base image\",\"recommendation\":\"Update to a more recent Ubuntu LTS version or consider using a more lightweight base image like Alpine.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"medium\",\"file\":\"Dockerfile\",\"line\":6,\"description\":\"Running container as root user\",\"recommendation\":\"Create a non-root user and use the USER instruction to run the container with least privileges.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"medium\",\"file\":\"Dockerfile\",\"line\":26,\"description\":\"Unnecessary ports exposed in Dockerfile\",\"recommendation\":\"Only expose the ports that are actually needed for the application to function.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"package.json\",\"line\":1,\"description\":\"Multiple outdated dependencies with known vulnerabilities\",\"recommendation\":\"Update all dependencies to their latest secure versions, especially lodash, moment, express, mongoose, and others.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"requirements.txt\",\"line\":1,\"description\":\"Multiple outdated Python dependencies with known vulnerabilities\",\"recommendation\":\"Update all dependencies to their latest secure versions, especially Django, requests, PyYAML, urllib3, Flask, and others.\"},{\"type\":\"ai_suggestion\",\"category\":\"Maintainability\",\"priority\":\"medium\",\"file\":\"src/file_upload.py\",\"line\":1,\"description\":\"Lack of input validation and error handling in file operations\",\"recommendation\":\"Implement proper input validation, error handling, and logging for all file operations.\"},{\"type\":\"ai_suggestion\",\"category\":\"Maintainability\",\"priority\":\"medium\",\"file\":\"src/user_auth.py\",\"line\":1,\"description\":\"Lack of proper error handling and logging in authentication functions\",\"recommendation\":\"Implement proper error handling, logging, and security event auditing for all authentication-related functions.\"}],\"summary\":{\"total_findings\":21,\"high_priority\":16,\"medium_priority\":5,\"low_priority\":0}},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"305be4c6-9ff3-4077-93f5-a11917966695\"],\"Content-Length\":[\"6524\"],\"Date\":[\"Sat, 28 Jun 2025 08:11:58 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=6a7d674b55504166;Sampled=0;Lineage=2:c73855c7:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"6524\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:11:58 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"305be4c6-9ff3-4077-93f5-a11917966695\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=6a7d674b55504166;Sampled=0;Lineage=2:c73855c7:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"305be4c6-9ff3-4077-93f5-a11917966695\"},\"StatusCode\":200}","failDetails":{}},"isRedriveEvent":false,"endTimestamp":1751098318147}],"dataFlow":{"input":"{\"type\":\"ai_review\",\"function_name\":\"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-AIReviewerFunction-O4EWbVoTnbOd\",\"payload\":{\"repo_details\":{\"pull_request_id\":\"2625925773\",\"repository_full_name\":\"belumume/sentinel-testbed\",\"commit_sha\":\"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\",\"pr_number\":32}}}","output":"{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"scanner_type\":\"ai_review\",\"findings\":[{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\".env.example\",\"line\":1,\"description\":\"Sensitive information exposed in .env.example file\",\"recommendation\":\"Remove all real API keys, passwords, and secrets from .env.example. Use placeholder values instead.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"Dockerfile\",\"line\":15,\"description\":\"Sensitive environment variables hardcoded in Dockerfile\",\"recommendation\":\"Remove API_KEY and DB_PASSWORD from Dockerfile. Use environment variables or secrets management instead.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"README.md\",\"line\":6,\"description\":\"API key exposed in README file\",\"recommendation\":\"Remove the API_KEY from the README file. Never commit sensitive information to version control.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"config/database.py\",\"line\":9,\"description\":\"Hardcoded database credentials in source code\",\"recommendation\":\"Remove hardcoded credentials and use environment variables or a secure configuration management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"config/database.py\",\"line\":15,\"description\":\"AWS credentials exposed in source code\",\"recommendation\":\"Remove AWS credentials from source code. Use AWS IAM roles or environment variables instead.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"config/database.py\",\"line\":19,\"description\":\"Stripe and GitHub tokens exposed in source code\",\"recommendation\":\"Remove Stripe and GitHub tokens from source code. Use environment variables or a secure secret management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/file_upload.py\",\"line\":24,\"description\":\"Arbitrary code execution vulnerability in file upload\",\"recommendation\":\"Remove the os.system call. Never execute uploaded files directly. Implement proper file validation and sandboxing.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/file_upload.py\",\"line\":33,\"description\":\"Path traversal vulnerability in file download\",\"recommendation\":\"Validate and sanitize the filename to prevent path traversal attacks. Use os.path.basename() and restrict to a specific directory.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":15,\"description\":\"SQL injection vulnerability in authentication query\",\"recommendation\":\"Use parameterized queries instead of string formatting to prevent SQL injection attacks.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":32,\"description\":\"Weak password hashing algorithm (MD5)\",\"recommendation\":\"Replace MD5 with a strong, modern hashing algorithm like bcrypt, Argon2, or PBKDF2.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":40,\"description\":\"SQL injection vulnerability in password reset functionality\",\"recommendation\":\"Use parameterized queries instead of string formatting to prevent SQL injection attacks.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":48,\"description\":\"Insecure admin access check using request headers\",\"recommendation\":\"Remove the header-based admin override. Implement proper authentication and authorization checks.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"test-production-v2.txt\",\"line\":3,\"description\":\"Sensitive API keys and tokens exposed in plain text file\",\"recommendation\":\"Remove all API keys, tokens, and secrets from this file. Use environment variables or a secure secrets management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"test-production.txt\",\"line\":3,\"description\":\"Sensitive API keys and tokens exposed in plain text file\",\"recommendation\":\"Remove all API keys and tokens from this file. Use environment variables or a secure secrets management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Best Practices\",\"priority\":\"medium\",\"file\":\"Dockerfile\",\"line\":3,\"description\":\"Using outdated Ubuntu base image\",\"recommendation\":\"Update to a more recent Ubuntu LTS version or consider using a more lightweight base image like Alpine.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"medium\",\"file\":\"Dockerfile\",\"line\":6,\"description\":\"Running container as root user\",\"recommendation\":\"Create a non-root user and use the USER instruction to run the container with least privileges.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"medium\",\"file\":\"Dockerfile\",\"line\":26,\"description\":\"Unnecessary ports exposed in Dockerfile\",\"recommendation\":\"Only expose the ports that are actually needed for the application to function.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"package.json\",\"line\":1,\"description\":\"Multiple outdated dependencies with known vulnerabilities\",\"recommendation\":\"Update all dependencies to their latest secure versions, especially lodash, moment, express, mongoose, and others.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"requirements.txt\",\"line\":1,\"description\":\"Multiple outdated Python dependencies with known vulnerabilities\",\"recommendation\":\"Update all dependencies to their latest secure versions, especially Django, requests, PyYAML, urllib3, Flask, and others.\"},{\"type\":\"ai_suggestion\",\"category\":\"Maintainability\",\"priority\":\"medium\",\"file\":\"src/file_upload.py\",\"line\":1,\"description\":\"Lack of input validation and error handling in file operations\",\"recommendation\":\"Implement proper input validation, error handling, and logging for all file operations.\"},{\"type\":\"ai_suggestion\",\"category\":\"Maintainability\",\"priority\":\"medium\",\"file\":\"src/user_auth.py\",\"line\":1,\"description\":\"Lack of proper error handling and logging in authentication functions\",\"recommendation\":\"Implement proper error handling, logging, and security event auditing for all authentication-related functions.\"}],\"summary\":{\"total_findings\":21,\"high_priority\":16,\"medium_priority\":5,\"low_priority\":0}},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"305be4c6-9ff3-4077-93f5-a11917966695\"],\"Content-Length\":[\"6524\"],\"Date\":[\"Sat, 28 Jun 2025 08:11:58 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=6a7d674b55504166;Sampled=0;Lineage=2:c73855c7:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"6524\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:11:58 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"305be4c6-9ff3-4077-93f5-a11917966695\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=6a7d674b55504166;Sampled=0;Lineage=2:c73855c7:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"305be4c6-9ff3-4077-93f5-a11917966695\"},\"StatusCode\":200}","taskResult":"{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"scanner_type\":\"ai_review\",\"findings\":[{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\".env.example\",\"line\":1,\"description\":\"Sensitive information exposed in .env.example file\",\"recommendation\":\"Remove all real API keys, passwords, and secrets from .env.example. Use placeholder values instead.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"Dockerfile\",\"line\":15,\"description\":\"Sensitive environment variables hardcoded in Dockerfile\",\"recommendation\":\"Remove API_KEY and DB_PASSWORD from Dockerfile. Use environment variables or secrets management instead.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"README.md\",\"line\":6,\"description\":\"API key exposed in README file\",\"recommendation\":\"Remove the API_KEY from the README file. Never commit sensitive information to version control.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"config/database.py\",\"line\":9,\"description\":\"Hardcoded database credentials in source code\",\"recommendation\":\"Remove hardcoded credentials and use environment variables or a secure configuration management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"config/database.py\",\"line\":15,\"description\":\"AWS credentials exposed in source code\",\"recommendation\":\"Remove AWS credentials from source code. Use AWS IAM roles or environment variables instead.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"config/database.py\",\"line\":19,\"description\":\"Stripe and GitHub tokens exposed in source code\",\"recommendation\":\"Remove Stripe and GitHub tokens from source code. Use environment variables or a secure secret management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/file_upload.py\",\"line\":24,\"description\":\"Arbitrary code execution vulnerability in file upload\",\"recommendation\":\"Remove the os.system call. Never execute uploaded files directly. Implement proper file validation and sandboxing.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/file_upload.py\",\"line\":33,\"description\":\"Path traversal vulnerability in file download\",\"recommendation\":\"Validate and sanitize the filename to prevent path traversal attacks. Use os.path.basename() and restrict to a specific directory.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":15,\"description\":\"SQL injection vulnerability in authentication query\",\"recommendation\":\"Use parameterized queries instead of string formatting to prevent SQL injection attacks.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":32,\"description\":\"Weak password hashing algorithm (MD5)\",\"recommendation\":\"Replace MD5 with a strong, modern hashing algorithm like bcrypt, Argon2, or PBKDF2.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":40,\"description\":\"SQL injection vulnerability in password reset functionality\",\"recommendation\":\"Use parameterized queries instead of string formatting to prevent SQL injection attacks.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":48,\"description\":\"Insecure admin access check using request headers\",\"recommendation\":\"Remove the header-based admin override. Implement proper authentication and authorization checks.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"test-production-v2.txt\",\"line\":3,\"description\":\"Sensitive API keys and tokens exposed in plain text file\",\"recommendation\":\"Remove all API keys, tokens, and secrets from this file. Use environment variables or a secure secrets management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"test-production.txt\",\"line\":3,\"description\":\"Sensitive API keys and tokens exposed in plain text file\",\"recommendation\":\"Remove all API keys and tokens from this file. Use environment variables or a secure secrets management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Best Practices\",\"priority\":\"medium\",\"file\":\"Dockerfile\",\"line\":3,\"description\":\"Using outdated Ubuntu base image\",\"recommendation\":\"Update to a more recent Ubuntu LTS version or consider using a more lightweight base image like Alpine.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"medium\",\"file\":\"Dockerfile\",\"line\":6,\"description\":\"Running container as root user\",\"recommendation\":\"Create a non-root user and use the USER instruction to run the container with least privileges.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"medium\",\"file\":\"Dockerfile\",\"line\":26,\"description\":\"Unnecessary ports exposed in Dockerfile\",\"recommendation\":\"Only expose the ports that are actually needed for the application to function.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"package.json\",\"line\":1,\"description\":\"Multiple outdated dependencies with known vulnerabilities\",\"recommendation\":\"Update all dependencies to their latest secure versions, especially lodash, moment, express, mongoose, and others.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"requirements.txt\",\"line\":1,\"description\":\"Multiple outdated Python dependencies with known vulnerabilities\",\"recommendation\":\"Update all dependencies to their latest secure versions, especially Django, requests, PyYAML, urllib3, Flask, and others.\"},{\"type\":\"ai_suggestion\",\"category\":\"Maintainability\",\"priority\":\"medium\",\"file\":\"src/file_upload.py\",\"line\":1,\"description\":\"Lack of input validation and error handling in file operations\",\"recommendation\":\"Implement proper input validation, error handling, and logging for all file operations.\"},{\"type\":\"ai_suggestion\",\"category\":\"Maintainability\",\"priority\":\"medium\",\"file\":\"src/user_auth.py\",\"line\":1,\"description\":\"Lack of proper error handling and logging in authentication functions\",\"recommendation\":\"Implement proper error handling, logging, and security event auditing for all authentication-related functions.\"}],\"summary\":{\"total_findings\":21,\"high_priority\":16,\"medium_priority\":5,\"low_priority\":0}},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"305be4c6-9ff3-4077-93f5-a11917966695\"],\"Content-Length\":[\"6524\"],\"Date\":[\"Sat, 28 Jun 2025 08:11:58 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=6a7d674b55504166;Sampled=0;Lineage=2:c73855c7:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"6524\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:11:58 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"305be4c6-9ff3-4077-93f5-a11917966695\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=6a7d674b55504166;Sampled=0;Lineage=2:c73855c7:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"305be4c6-9ff3-4077-93f5-a11917966695\"},\"StatusCode\":200}","taskResultTruncated":false,"failDetails":{}},"events":[{"id":11,"previousEventId":6,"stateEnteredEventDetails":{"input":"{\"type\":\"ai_review\",\"function_name\":\"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-AIReviewerFunction-O4EWbVoTnbOd\",\"payload\":{\"repo_details\":{\"pull_request_id\":\"2625925773\",\"repository_full_name\":\"belumume/sentinel-testbed\",\"commit_sha\":\"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\",\"pr_number\":32}}}","inputDetails":{"truncated":false},"name":"RunScanner"},"timestamp":"2025-06-28T08:11:23.600Z","type":"TaskStateEntered","redriveId":0,"stepName":"RunScanner"},{"id":12,"previousEventId":11,"taskScheduledEventDetails":{"parameters":{"FunctionName":"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-AIReviewerFunction-O4EWbVoTnbOd","Payload":{"repo_details":{"pull_request_id":"2625925773","repository_full_name":"belumume/sentinel-testbed","commit_sha":"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f","pr_number":32}}},"region":"us-east-1","resource":"invoke","resourceType":"lambda"},"timestamp":"2025-06-28T08:11:23.600Z","type":"TaskScheduled","redriveId":0,"stepName":"RunScanner"},{"id":13,"previousEventId":12,"taskStartedEventDetails":{"resource":"invoke","resourceType":"lambda"},"timestamp":"2025-06-28T08:11:23.683Z","type":"TaskStarted","redriveId":0,"stepName":"RunScanner"},{"id":22,"previousEventId":13,"taskSucceededEventDetails":{"output":"{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"scanner_type\":\"ai_review\",\"findings\":[{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\".env.example\",\"line\":1,\"description\":\"Sensitive information exposed in .env.example file\",\"recommendation\":\"Remove all real API keys, passwords, and secrets from .env.example. Use placeholder values instead.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"Dockerfile\",\"line\":15,\"description\":\"Sensitive environment variables hardcoded in Dockerfile\",\"recommendation\":\"Remove API_KEY and DB_PASSWORD from Dockerfile. Use environment variables or secrets management instead.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"README.md\",\"line\":6,\"description\":\"API key exposed in README file\",\"recommendation\":\"Remove the API_KEY from the README file. Never commit sensitive information to version control.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"config/database.py\",\"line\":9,\"description\":\"Hardcoded database credentials in source code\",\"recommendation\":\"Remove hardcoded credentials and use environment variables or a secure configuration management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"config/database.py\",\"line\":15,\"description\":\"AWS credentials exposed in source code\",\"recommendation\":\"Remove AWS credentials from source code. Use AWS IAM roles or environment variables instead.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"config/database.py\",\"line\":19,\"description\":\"Stripe and GitHub tokens exposed in source code\",\"recommendation\":\"Remove Stripe and GitHub tokens from source code. Use environment variables or a secure secret management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/file_upload.py\",\"line\":24,\"description\":\"Arbitrary code execution vulnerability in file upload\",\"recommendation\":\"Remove the os.system call. Never execute uploaded files directly. Implement proper file validation and sandboxing.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/file_upload.py\",\"line\":33,\"description\":\"Path traversal vulnerability in file download\",\"recommendation\":\"Validate and sanitize the filename to prevent path traversal attacks. Use os.path.basename() and restrict to a specific directory.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":15,\"description\":\"SQL injection vulnerability in authentication query\",\"recommendation\":\"Use parameterized queries instead of string formatting to prevent SQL injection attacks.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":32,\"description\":\"Weak password hashing algorithm (MD5)\",\"recommendation\":\"Replace MD5 with a strong, modern hashing algorithm like bcrypt, Argon2, or PBKDF2.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":40,\"description\":\"SQL injection vulnerability in password reset functionality\",\"recommendation\":\"Use parameterized queries instead of string formatting to prevent SQL injection attacks.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":48,\"description\":\"Insecure admin access check using request headers\",\"recommendation\":\"Remove the header-based admin override. Implement proper authentication and authorization checks.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"test-production-v2.txt\",\"line\":3,\"description\":\"Sensitive API keys and tokens exposed in plain text file\",\"recommendation\":\"Remove all API keys, tokens, and secrets from this file. Use environment variables or a secure secrets management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"test-production.txt\",\"line\":3,\"description\":\"Sensitive API keys and tokens exposed in plain text file\",\"recommendation\":\"Remove all API keys and tokens from this file. Use environment variables or a secure secrets management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Best Practices\",\"priority\":\"medium\",\"file\":\"Dockerfile\",\"line\":3,\"description\":\"Using outdated Ubuntu base image\",\"recommendation\":\"Update to a more recent Ubuntu LTS version or consider using a more lightweight base image like Alpine.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"medium\",\"file\":\"Dockerfile\",\"line\":6,\"description\":\"Running container as root user\",\"recommendation\":\"Create a non-root user and use the USER instruction to run the container with least privileges.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"medium\",\"file\":\"Dockerfile\",\"line\":26,\"description\":\"Unnecessary ports exposed in Dockerfile\",\"recommendation\":\"Only expose the ports that are actually needed for the application to function.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"package.json\",\"line\":1,\"description\":\"Multiple outdated dependencies with known vulnerabilities\",\"recommendation\":\"Update all dependencies to their latest secure versions, especially lodash, moment, express, mongoose, and others.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"requirements.txt\",\"line\":1,\"description\":\"Multiple outdated Python dependencies with known vulnerabilities\",\"recommendation\":\"Update all dependencies to their latest secure versions, especially Django, requests, PyYAML, urllib3, Flask, and others.\"},{\"type\":\"ai_suggestion\",\"category\":\"Maintainability\",\"priority\":\"medium\",\"file\":\"src/file_upload.py\",\"line\":1,\"description\":\"Lack of input validation and error handling in file operations\",\"recommendation\":\"Implement proper input validation, error handling, and logging for all file operations.\"},{\"type\":\"ai_suggestion\",\"category\":\"Maintainability\",\"priority\":\"medium\",\"file\":\"src/user_auth.py\",\"line\":1,\"description\":\"Lack of proper error handling and logging in authentication functions\",\"recommendation\":\"Implement proper error handling, logging, and security event auditing for all authentication-related functions.\"}],\"summary\":{\"total_findings\":21,\"high_priority\":16,\"medium_priority\":5,\"low_priority\":0}},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"305be4c6-9ff3-4077-93f5-a11917966695\"],\"Content-Length\":[\"6524\"],\"Date\":[\"Sat, 28 Jun 2025 08:11:58 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=6a7d674b55504166;Sampled=0;Lineage=2:c73855c7:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"6524\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:11:58 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"305be4c6-9ff3-4077-93f5-a11917966695\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=6a7d674b55504166;Sampled=0;Lineage=2:c73855c7:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"305be4c6-9ff3-4077-93f5-a11917966695\"},\"StatusCode\":200}","outputDetails":{"truncated":false},"resource":"invoke","resourceType":"lambda"},"timestamp":"2025-06-28T08:11:58.127Z","type":"TaskSucceeded","redriveId":0,"stepName":"RunScanner"},{"id":23,"previousEventId":22,"stateExitedEventDetails":{"name":"RunScanner","output":"{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"scanner_type\":\"ai_review\",\"findings\":[{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\".env.example\",\"line\":1,\"description\":\"Sensitive information exposed in .env.example file\",\"recommendation\":\"Remove all real API keys, passwords, and secrets from .env.example. Use placeholder values instead.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"Dockerfile\",\"line\":15,\"description\":\"Sensitive environment variables hardcoded in Dockerfile\",\"recommendation\":\"Remove API_KEY and DB_PASSWORD from Dockerfile. Use environment variables or secrets management instead.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"README.md\",\"line\":6,\"description\":\"API key exposed in README file\",\"recommendation\":\"Remove the API_KEY from the README file. Never commit sensitive information to version control.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"config/database.py\",\"line\":9,\"description\":\"Hardcoded database credentials in source code\",\"recommendation\":\"Remove hardcoded credentials and use environment variables or a secure configuration management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"config/database.py\",\"line\":15,\"description\":\"AWS credentials exposed in source code\",\"recommendation\":\"Remove AWS credentials from source code. Use AWS IAM roles or environment variables instead.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"config/database.py\",\"line\":19,\"description\":\"Stripe and GitHub tokens exposed in source code\",\"recommendation\":\"Remove Stripe and GitHub tokens from source code. Use environment variables or a secure secret management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/file_upload.py\",\"line\":24,\"description\":\"Arbitrary code execution vulnerability in file upload\",\"recommendation\":\"Remove the os.system call. Never execute uploaded files directly. Implement proper file validation and sandboxing.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/file_upload.py\",\"line\":33,\"description\":\"Path traversal vulnerability in file download\",\"recommendation\":\"Validate and sanitize the filename to prevent path traversal attacks. Use os.path.basename() and restrict to a specific directory.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":15,\"description\":\"SQL injection vulnerability in authentication query\",\"recommendation\":\"Use parameterized queries instead of string formatting to prevent SQL injection attacks.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":32,\"description\":\"Weak password hashing algorithm (MD5)\",\"recommendation\":\"Replace MD5 with a strong, modern hashing algorithm like bcrypt, Argon2, or PBKDF2.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":40,\"description\":\"SQL injection vulnerability in password reset functionality\",\"recommendation\":\"Use parameterized queries instead of string formatting to prevent SQL injection attacks.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":48,\"description\":\"Insecure admin access check using request headers\",\"recommendation\":\"Remove the header-based admin override. Implement proper authentication and authorization checks.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"test-production-v2.txt\",\"line\":3,\"description\":\"Sensitive API keys and tokens exposed in plain text file\",\"recommendation\":\"Remove all API keys, tokens, and secrets from this file. Use environment variables or a secure secrets management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"test-production.txt\",\"line\":3,\"description\":\"Sensitive API keys and tokens exposed in plain text file\",\"recommendation\":\"Remove all API keys and tokens from this file. Use environment variables or a secure secrets management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Best Practices\",\"priority\":\"medium\",\"file\":\"Dockerfile\",\"line\":3,\"description\":\"Using outdated Ubuntu base image\",\"recommendation\":\"Update to a more recent Ubuntu LTS version or consider using a more lightweight base image like Alpine.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"medium\",\"file\":\"Dockerfile\",\"line\":6,\"description\":\"Running container as root user\",\"recommendation\":\"Create a non-root user and use the USER instruction to run the container with least privileges.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"medium\",\"file\":\"Dockerfile\",\"line\":26,\"description\":\"Unnecessary ports exposed in Dockerfile\",\"recommendation\":\"Only expose the ports that are actually needed for the application to function.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"package.json\",\"line\":1,\"description\":\"Multiple outdated dependencies with known vulnerabilities\",\"recommendation\":\"Update all dependencies to their latest secure versions, especially lodash, moment, express, mongoose, and others.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"requirements.txt\",\"line\":1,\"description\":\"Multiple outdated Python dependencies with known vulnerabilities\",\"recommendation\":\"Update all dependencies to their latest secure versions, especially Django, requests, PyYAML, urllib3, Flask, and others.\"},{\"type\":\"ai_suggestion\",\"category\":\"Maintainability\",\"priority\":\"medium\",\"file\":\"src/file_upload.py\",\"line\":1,\"description\":\"Lack of input validation and error handling in file operations\",\"recommendation\":\"Implement proper input validation, error handling, and logging for all file operations.\"},{\"type\":\"ai_suggestion\",\"category\":\"Maintainability\",\"priority\":\"medium\",\"file\":\"src/user_auth.py\",\"line\":1,\"description\":\"Lack of proper error handling and logging in authentication functions\",\"recommendation\":\"Implement proper error handling, logging, and security event auditing for all authentication-related functions.\"}],\"summary\":{\"total_findings\":21,\"high_priority\":16,\"medium_priority\":5,\"low_priority\":0}},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"305be4c6-9ff3-4077-93f5-a11917966695\"],\"Content-Length\":[\"6524\"],\"Date\":[\"Sat, 28 Jun 2025 08:11:58 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=6a7d674b55504166;Sampled=0;Lineage=2:c73855c7:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"6524\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:11:58 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"305be4c6-9ff3-4077-93f5-a11917966695\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=6a7d674b55504166;Sampled=0;Lineage=2:c73855c7:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"305be4c6-9ff3-4077-93f5-a11917966695\"},\"StatusCode\":200}","outputDetails":{"truncated":false}},"timestamp":"2025-06-28T08:11:58.147Z","type":"TaskStateExited","redriveId":0,"stepName":"RunScanner"}],"redriveCount":0,"availableVariables":{},"resource":{"parameters":{"FunctionName":"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-AIReviewerFunction-O4EWbVoTnbOd","Payload":{"repo_details":{"pull_request_id":"2625925773","repository_full_name":"belumume/sentinel-testbed","commit_sha":"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f","pr_number":32}}},"region":"us-east-1","resource":"invoke","resourceType":"lambda"},"meta":{"id":6,"expandable":false,"expanded":false,"matched":true,"lastChild":true,"hasDisplayedChildren":false,"path":"[\"ParallelScans\",\"2\",\"RunScanner\"]"}}}}}}},"AggregateResults":{"path":"[\"AggregateResults\"]","iteration":0,"transition":{"stepType":"Task","stepName":"AggregateResults","status":3,"firstId":27,"lastId":31,"firstTimestamp":1751098318147,"lastTimestamp":1751098320342,"tries":[{"status":3,"startTimestamp":1751098318147,"dataFlow":{"output":"{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"aggregation_complete\":true,\"findings_summary\":{\"secrets_found\":22,\"vulnerabilities_found\":0,\"ai_suggestions\":21},\"github_comment_posted\":true},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"4a4c99d8-b8ff-4451-84ec-783a29b803f5\"],\"Content-Length\":[\"173\"],\"Date\":[\"Sat, 28 Jun 2025 08:12:00 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=2ef7bb7fce192f6a;Sampled=0;Lineage=2:d0648a6a:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"173\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:12:00 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"4a4c99d8-b8ff-4451-84ec-783a29b803f5\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=2ef7bb7fce192f6a;Sampled=0;Lineage=2:d0648a6a:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"4a4c99d8-b8ff-4451-84ec-783a29b803f5\"},\"StatusCode\":200}","failDetails":{}},"isRedriveEvent":false,"endTimestamp":1751098320342}],"dataFlow":{"input":"{\"repo_details\":{\"pull_request_id\":\"2625925773\",\"repository_full_name\":\"belumume/sentinel-testbed\",\"commit_sha\":\"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\",\"pr_number\":32},\"analysis_types\":[{\"type\":\"secrets\",\"function_name\":\"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-SecretScannerFunction-w0XQI2GV65HU\",\"payload\":{\"repo_details\":{\"pull_request_id\":\"2625925773\",\"repository_full_name\":\"belumume/sentinel-testbed\",\"commit_sha\":\"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\",\"pr_number\":32}}},{\"type\":\"vulnerabilities\",\"function_name\":\"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-VulnerabilityScannerFunction-Fk7ek2H2Mdqn\",\"payload\":{\"repo_details\":{\"pull_request_id\":\"2625925773\",\"repository_full_name\":\"belumume/sentinel-testbed\",\"commit_sha\":\"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\",\"pr_number\":32}}},{\"type\":\"ai_review\",\"function_name\":\"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-AIReviewerFunction-O4EWbVoTnbOd\",\"payload\":{\"repo_details\":{\"pull_request_id\":\"2625925773\",\"repository_full_name\":\"belumume/sentinel-testbed\",\"commit_sha\":\"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\",\"pr_number\":32}}}],\"scan_results\":[{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"scanner_type\":\"secrets\",\"findings\":[{\"type\":\"API Key (Pattern Match)\",\"file\":\"test-production-v2.txt\",\"line\":3,\"raw\":\"sk-1234567890abcdef1234567890abcdef12345678\"},{\"type\":\"GitHub Token (Pattern Match)\",\"file\":\"test-production-v2.txt\",\"line\":4,\"raw\":\"ghp_1234567890abcdef1234567890abcdef1234\"},{\"type\":\"AWS Secret Key (Pattern Match)\",\"file\":\"test-production-v2.txt\",\"line\":5,\"raw\":\"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\"test-production.txt\",\"line\":3,\"raw\":\"sk-1234567890abcdef1234567890abcdef12345678\"},{\"type\":\"GitHub Token (Pattern Match)\",\"file\":\"test-production.txt\",\"line\":4,\"raw\":\"ghp_1234567890abcdef1234567890abcdef1234\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\"Dockerfile\",\"line\":15,\"raw\":\"sk_test_1234567890abcdef\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"Dockerfile\",\"line\":16,\"raw\":\"supersecret123\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"Dockerfile\",\"line\":16,\"raw\":\"supersecret123\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\".env.example\",\"line\":2,\"raw\":\"another_secret_password_123\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\".env.example\",\"line\":2,\"raw\":\"another_secret_password_123\"},{\"type\":\"Connection String (Pattern Match)\",\"file\":\".env.example\",\"line\":3,\"raw\":\"postgresql://user:secret123@localhost:5432/mydb\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\".env.example\",\"line\":6,\"raw\":\"sk-1234567890abcdefghijklmnopqrstuvwxyz1234567890a...\"},{\"type\":\"OpenAI API Key (Pattern Match)\",\"file\":\".env.example\",\"line\":6,\"raw\":\"sk-1234567890abcdefghijklmnopqrstuvwxyz1234567890a...\"},{\"type\":\"JWT Secret (Pattern Match)\",\"file\":\".env.example\",\"line\":10,\"raw\":\"my_super_secret_jwt_key_that_should_not_be_hardcod...\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\"README.md\",\"line\":6,\"raw\":\"sk_test_1234567890abcdef\"},{\"type\":\"AWS Access Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":15,\"raw\":\"AKIAIOSFODNN7EXAMPLE\"},{\"type\":\"AWS Secret Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":16,\"raw\":\"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"},{\"type\":\"Secret Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":19,\"raw\":\"sk_test_4eC39HqLyjWDarjtT1zdp7dc\"},{\"type\":\"Stripe Test Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":19,\"raw\":\"sk_test_4eC39HqLyjWDarjtT1zdp7dc\"},{\"type\":\"GitHub Token (Pattern Match)\",\"file\":\"config/database.py\",\"line\":20,\"raw\":\"ghp_1234567890abcdefghijklmnopqrstuvwxyz\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"config/database.py\",\"line\":29,\"raw\":\"DATABASE_CONFIG[\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"src/user_auth.py\",\"line\":15,\"raw\":\"{self.hash_password(password)}\"}],\"summary\":{\"total_findings\":22}},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"d13672c8-f96d-4a9c-a382-6944b79168ac\"],\"Content-Length\":[\"2886\"],\"Date\":[\"Sat, 28 Jun 2025 08:11:39 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=5e0356b90ed3a285;Sampled=0;Lineage=2:06d0fbab:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"2886\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:11:39 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"d13672c8-f96d-4a9c-a382-6944b79168ac\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=5e0356b90ed3a285;Sampled=0;Lineage=2:06d0fbab:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"d13672c8-f96d-4a9c-a382-6944b79168ac\"},\"StatusCode\":200},{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"scanner_type\":\"vulnerabilities\",\"findings\":[],\"summary\":{\"total_findings\":0,\"by_severity\":{},\"by_language\":{}}},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"0f8f7504-f819-429a-bce4-4c7615c218a3\"],\"Content-Length\":[\"142\"],\"Date\":[\"Sat, 28 Jun 2025 08:11:23 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=0fe9df82f88a24aa;Sampled=0;Lineage=2:9da352f3:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"142\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:11:23 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"0f8f7504-f819-429a-bce4-4c7615c218a3\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=0fe9df82f88a24aa;Sampled=0;Lineage=2:9da352f3:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"0f8f7504-f819-429a-bce4-4c7615c218a3\"},\"StatusCode\":200},{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"scanner_type\":\"ai_review\",\"findings\":[{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\".env.example\",\"line\":1,\"description\":\"Sensitive information exposed in .env.example file\",\"recommendation\":\"Remove all real API keys, passwords, and secrets from .env.example. Use placeholder values instead.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"Dockerfile\",\"line\":15,\"description\":\"Sensitive environment variables hardcoded in Dockerfile\",\"recommendation\":\"Remove API_KEY and DB_PASSWORD from Dockerfile. Use environment variables or secrets management instead.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"README.md\",\"line\":6,\"description\":\"API key exposed in README file\",\"recommendation\":\"Remove the API_KEY from the README file. Never commit sensitive information to version control.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"config/database.py\",\"line\":9,\"description\":\"Hardcoded database credentials in source code\",\"recommendation\":\"Remove hardcoded credentials and use environment variables or a secure configuration management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"config/database.py\",\"line\":15,\"description\":\"AWS credentials exposed in source code\",\"recommendation\":\"Remove AWS credentials from source code. Use AWS IAM roles or environment variables instead.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"config/database.py\",\"line\":19,\"description\":\"Stripe and GitHub tokens exposed in source code\",\"recommendation\":\"Remove Stripe and GitHub tokens from source code. Use environment variables or a secure secret management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/file_upload.py\",\"line\":24,\"description\":\"Arbitrary code execution vulnerability in file upload\",\"recommendation\":\"Remove the os.system call. Never execute uploaded files directly. Implement proper file validation and sandboxing.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/file_upload.py\",\"line\":33,\"description\":\"Path traversal vulnerability in file download\",\"recommendation\":\"Validate and sanitize the filename to prevent path traversal attacks. Use os.path.basename() and restrict to a specific directory.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":15,\"description\":\"SQL injection vulnerability in authentication query\",\"recommendation\":\"Use parameterized queries instead of string formatting to prevent SQL injection attacks.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":32,\"description\":\"Weak password hashing algorithm (MD5)\",\"recommendation\":\"Replace MD5 with a strong, modern hashing algorithm like bcrypt, Argon2, or PBKDF2.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":40,\"description\":\"SQL injection vulnerability in password reset functionality\",\"recommendation\":\"Use parameterized queries instead of string formatting to prevent SQL injection attacks.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":48,\"description\":\"Insecure admin access check using request headers\",\"recommendation\":\"Remove the header-based admin override. Implement proper authentication and authorization checks.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"test-production-v2.txt\",\"line\":3,\"description\":\"Sensitive API keys and tokens exposed in plain text file\",\"recommendation\":\"Remove all API keys, tokens, and secrets from this file. Use environment variables or a secure secrets management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"test-production.txt\",\"line\":3,\"description\":\"Sensitive API keys and tokens exposed in plain text file\",\"recommendation\":\"Remove all API keys and tokens from this file. Use environment variables or a secure secrets management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Best Practices\",\"priority\":\"medium\",\"file\":\"Dockerfile\",\"line\":3,\"description\":\"Using outdated Ubuntu base image\",\"recommendation\":\"Update to a more recent Ubuntu LTS version or consider using a more lightweight base image like Alpine.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"medium\",\"file\":\"Dockerfile\",\"line\":6,\"description\":\"Running container as root user\",\"recommendation\":\"Create a non-root user and use the USER instruction to run the container with least privileges.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"medium\",\"file\":\"Dockerfile\",\"line\":26,\"description\":\"Unnecessary ports exposed in Dockerfile\",\"recommendation\":\"Only expose the ports that are actually needed for the application to function.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"package.json\",\"line\":1,\"description\":\"Multiple outdated dependencies with known vulnerabilities\",\"recommendation\":\"Update all dependencies to their latest secure versions, especially lodash, moment, express, mongoose, and others.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"requirements.txt\",\"line\":1,\"description\":\"Multiple outdated Python dependencies with known vulnerabilities\",\"recommendation\":\"Update all dependencies to their latest secure versions, especially Django, requests, PyYAML, urllib3, Flask, and others.\"},{\"type\":\"ai_suggestion\",\"category\":\"Maintainability\",\"priority\":\"medium\",\"file\":\"src/file_upload.py\",\"line\":1,\"description\":\"Lack of input validation and error handling in file operations\",\"recommendation\":\"Implement proper input validation, error handling, and logging for all file operations.\"},{\"type\":\"ai_suggestion\",\"category\":\"Maintainability\",\"priority\":\"medium\",\"file\":\"src/user_auth.py\",\"line\":1,\"description\":\"Lack of proper error handling and logging in authentication functions\",\"recommendation\":\"Implement proper error handling, logging, and security event auditing for all authentication-related functions.\"}],\"summary\":{\"total_findings\":21,\"high_priority\":16,\"medium_priority\":5,\"low_priority\":0}},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"305be4c6-9ff3-4077-93f5-a11917966695\"],\"Content-Length\":[\"6524\"],\"Date\":[\"Sat, 28 Jun 2025 08:11:58 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=6a7d674b55504166;Sampled=0;Lineage=2:c73855c7:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"6524\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:11:58 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"305be4c6-9ff3-4077-93f5-a11917966695\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=6a7d674b55504166;Sampled=0;Lineage=2:c73855c7:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"305be4c6-9ff3-4077-93f5-a11917966695\"},\"StatusCode\":200}]}","output":"{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"aggregation_complete\":true,\"findings_summary\":{\"secrets_found\":22,\"vulnerabilities_found\":0,\"ai_suggestions\":21},\"github_comment_posted\":true},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"4a4c99d8-b8ff-4451-84ec-783a29b803f5\"],\"Content-Length\":[\"173\"],\"Date\":[\"Sat, 28 Jun 2025 08:12:00 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=2ef7bb7fce192f6a;Sampled=0;Lineage=2:d0648a6a:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"173\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:12:00 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"4a4c99d8-b8ff-4451-84ec-783a29b803f5\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=2ef7bb7fce192f6a;Sampled=0;Lineage=2:d0648a6a:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"4a4c99d8-b8ff-4451-84ec-783a29b803f5\"},\"StatusCode\":200}","taskResult":"{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"aggregation_complete\":true,\"findings_summary\":{\"secrets_found\":22,\"vulnerabilities_found\":0,\"ai_suggestions\":21},\"github_comment_posted\":true},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"4a4c99d8-b8ff-4451-84ec-783a29b803f5\"],\"Content-Length\":[\"173\"],\"Date\":[\"Sat, 28 Jun 2025 08:12:00 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=2ef7bb7fce192f6a;Sampled=0;Lineage=2:d0648a6a:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"173\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:12:00 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"4a4c99d8-b8ff-4451-84ec-783a29b803f5\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=2ef7bb7fce192f6a;Sampled=0;Lineage=2:d0648a6a:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"4a4c99d8-b8ff-4451-84ec-783a29b803f5\"},\"StatusCode\":200}","taskResultTruncated":false,"failDetails":{}},"events":[{"id":27,"previousEventId":26,"stateEnteredEventDetails":{"input":"{\"repo_details\":{\"pull_request_id\":\"2625925773\",\"repository_full_name\":\"belumume/sentinel-testbed\",\"commit_sha\":\"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\",\"pr_number\":32},\"analysis_types\":[{\"type\":\"secrets\",\"function_name\":\"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-SecretScannerFunction-w0XQI2GV65HU\",\"payload\":{\"repo_details\":{\"pull_request_id\":\"2625925773\",\"repository_full_name\":\"belumume/sentinel-testbed\",\"commit_sha\":\"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\",\"pr_number\":32}}},{\"type\":\"vulnerabilities\",\"function_name\":\"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-VulnerabilityScannerFunction-Fk7ek2H2Mdqn\",\"payload\":{\"repo_details\":{\"pull_request_id\":\"2625925773\",\"repository_full_name\":\"belumume/sentinel-testbed\",\"commit_sha\":\"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\",\"pr_number\":32}}},{\"type\":\"ai_review\",\"function_name\":\"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-AIReviewerFunction-O4EWbVoTnbOd\",\"payload\":{\"repo_details\":{\"pull_request_id\":\"2625925773\",\"repository_full_name\":\"belumume/sentinel-testbed\",\"commit_sha\":\"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f\",\"pr_number\":32}}}],\"scan_results\":[{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"scanner_type\":\"secrets\",\"findings\":[{\"type\":\"API Key (Pattern Match)\",\"file\":\"test-production-v2.txt\",\"line\":3,\"raw\":\"sk-1234567890abcdef1234567890abcdef12345678\"},{\"type\":\"GitHub Token (Pattern Match)\",\"file\":\"test-production-v2.txt\",\"line\":4,\"raw\":\"ghp_1234567890abcdef1234567890abcdef1234\"},{\"type\":\"AWS Secret Key (Pattern Match)\",\"file\":\"test-production-v2.txt\",\"line\":5,\"raw\":\"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\"test-production.txt\",\"line\":3,\"raw\":\"sk-1234567890abcdef1234567890abcdef12345678\"},{\"type\":\"GitHub Token (Pattern Match)\",\"file\":\"test-production.txt\",\"line\":4,\"raw\":\"ghp_1234567890abcdef1234567890abcdef1234\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\"Dockerfile\",\"line\":15,\"raw\":\"sk_test_1234567890abcdef\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"Dockerfile\",\"line\":16,\"raw\":\"supersecret123\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"Dockerfile\",\"line\":16,\"raw\":\"supersecret123\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\".env.example\",\"line\":2,\"raw\":\"another_secret_password_123\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\".env.example\",\"line\":2,\"raw\":\"another_secret_password_123\"},{\"type\":\"Connection String (Pattern Match)\",\"file\":\".env.example\",\"line\":3,\"raw\":\"postgresql://user:secret123@localhost:5432/mydb\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\".env.example\",\"line\":6,\"raw\":\"sk-1234567890abcdefghijklmnopqrstuvwxyz1234567890a...\"},{\"type\":\"OpenAI API Key (Pattern Match)\",\"file\":\".env.example\",\"line\":6,\"raw\":\"sk-1234567890abcdefghijklmnopqrstuvwxyz1234567890a...\"},{\"type\":\"JWT Secret (Pattern Match)\",\"file\":\".env.example\",\"line\":10,\"raw\":\"my_super_secret_jwt_key_that_should_not_be_hardcod...\"},{\"type\":\"API Key (Pattern Match)\",\"file\":\"README.md\",\"line\":6,\"raw\":\"sk_test_1234567890abcdef\"},{\"type\":\"AWS Access Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":15,\"raw\":\"AKIAIOSFODNN7EXAMPLE\"},{\"type\":\"AWS Secret Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":16,\"raw\":\"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"},{\"type\":\"Secret Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":19,\"raw\":\"sk_test_4eC39HqLyjWDarjtT1zdp7dc\"},{\"type\":\"Stripe Test Key (Pattern Match)\",\"file\":\"config/database.py\",\"line\":19,\"raw\":\"sk_test_4eC39HqLyjWDarjtT1zdp7dc\"},{\"type\":\"GitHub Token (Pattern Match)\",\"file\":\"config/database.py\",\"line\":20,\"raw\":\"ghp_1234567890abcdefghijklmnopqrstuvwxyz\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"config/database.py\",\"line\":29,\"raw\":\"DATABASE_CONFIG[\"},{\"type\":\"Database Password (Pattern Match)\",\"file\":\"src/user_auth.py\",\"line\":15,\"raw\":\"{self.hash_password(password)}\"}],\"summary\":{\"total_findings\":22}},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"d13672c8-f96d-4a9c-a382-6944b79168ac\"],\"Content-Length\":[\"2886\"],\"Date\":[\"Sat, 28 Jun 2025 08:11:39 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=5e0356b90ed3a285;Sampled=0;Lineage=2:06d0fbab:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"2886\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:11:39 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"d13672c8-f96d-4a9c-a382-6944b79168ac\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=5e0356b90ed3a285;Sampled=0;Lineage=2:06d0fbab:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"d13672c8-f96d-4a9c-a382-6944b79168ac\"},\"StatusCode\":200},{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"scanner_type\":\"vulnerabilities\",\"findings\":[],\"summary\":{\"total_findings\":0,\"by_severity\":{},\"by_language\":{}}},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"0f8f7504-f819-429a-bce4-4c7615c218a3\"],\"Content-Length\":[\"142\"],\"Date\":[\"Sat, 28 Jun 2025 08:11:23 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=0fe9df82f88a24aa;Sampled=0;Lineage=2:9da352f3:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"142\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:11:23 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"0f8f7504-f819-429a-bce4-4c7615c218a3\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=0fe9df82f88a24aa;Sampled=0;Lineage=2:9da352f3:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"0f8f7504-f819-429a-bce4-4c7615c218a3\"},\"StatusCode\":200},{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"scanner_type\":\"ai_review\",\"findings\":[{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\".env.example\",\"line\":1,\"description\":\"Sensitive information exposed in .env.example file\",\"recommendation\":\"Remove all real API keys, passwords, and secrets from .env.example. Use placeholder values instead.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"Dockerfile\",\"line\":15,\"description\":\"Sensitive environment variables hardcoded in Dockerfile\",\"recommendation\":\"Remove API_KEY and DB_PASSWORD from Dockerfile. Use environment variables or secrets management instead.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"README.md\",\"line\":6,\"description\":\"API key exposed in README file\",\"recommendation\":\"Remove the API_KEY from the README file. Never commit sensitive information to version control.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"config/database.py\",\"line\":9,\"description\":\"Hardcoded database credentials in source code\",\"recommendation\":\"Remove hardcoded credentials and use environment variables or a secure configuration management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"config/database.py\",\"line\":15,\"description\":\"AWS credentials exposed in source code\",\"recommendation\":\"Remove AWS credentials from source code. Use AWS IAM roles or environment variables instead.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"config/database.py\",\"line\":19,\"description\":\"Stripe and GitHub tokens exposed in source code\",\"recommendation\":\"Remove Stripe and GitHub tokens from source code. Use environment variables or a secure secret management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/file_upload.py\",\"line\":24,\"description\":\"Arbitrary code execution vulnerability in file upload\",\"recommendation\":\"Remove the os.system call. Never execute uploaded files directly. Implement proper file validation and sandboxing.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/file_upload.py\",\"line\":33,\"description\":\"Path traversal vulnerability in file download\",\"recommendation\":\"Validate and sanitize the filename to prevent path traversal attacks. Use os.path.basename() and restrict to a specific directory.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":15,\"description\":\"SQL injection vulnerability in authentication query\",\"recommendation\":\"Use parameterized queries instead of string formatting to prevent SQL injection attacks.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":32,\"description\":\"Weak password hashing algorithm (MD5)\",\"recommendation\":\"Replace MD5 with a strong, modern hashing algorithm like bcrypt, Argon2, or PBKDF2.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":40,\"description\":\"SQL injection vulnerability in password reset functionality\",\"recommendation\":\"Use parameterized queries instead of string formatting to prevent SQL injection attacks.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"src/user_auth.py\",\"line\":48,\"description\":\"Insecure admin access check using request headers\",\"recommendation\":\"Remove the header-based admin override. Implement proper authentication and authorization checks.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"test-production-v2.txt\",\"line\":3,\"description\":\"Sensitive API keys and tokens exposed in plain text file\",\"recommendation\":\"Remove all API keys, tokens, and secrets from this file. Use environment variables or a secure secrets management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"test-production.txt\",\"line\":3,\"description\":\"Sensitive API keys and tokens exposed in plain text file\",\"recommendation\":\"Remove all API keys and tokens from this file. Use environment variables or a secure secrets management system.\"},{\"type\":\"ai_suggestion\",\"category\":\"Best Practices\",\"priority\":\"medium\",\"file\":\"Dockerfile\",\"line\":3,\"description\":\"Using outdated Ubuntu base image\",\"recommendation\":\"Update to a more recent Ubuntu LTS version or consider using a more lightweight base image like Alpine.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"medium\",\"file\":\"Dockerfile\",\"line\":6,\"description\":\"Running container as root user\",\"recommendation\":\"Create a non-root user and use the USER instruction to run the container with least privileges.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"medium\",\"file\":\"Dockerfile\",\"line\":26,\"description\":\"Unnecessary ports exposed in Dockerfile\",\"recommendation\":\"Only expose the ports that are actually needed for the application to function.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"package.json\",\"line\":1,\"description\":\"Multiple outdated dependencies with known vulnerabilities\",\"recommendation\":\"Update all dependencies to their latest secure versions, especially lodash, moment, express, mongoose, and others.\"},{\"type\":\"ai_suggestion\",\"category\":\"Security\",\"priority\":\"high\",\"file\":\"requirements.txt\",\"line\":1,\"description\":\"Multiple outdated Python dependencies with known vulnerabilities\",\"recommendation\":\"Update all dependencies to their latest secure versions, especially Django, requests, PyYAML, urllib3, Flask, and others.\"},{\"type\":\"ai_suggestion\",\"category\":\"Maintainability\",\"priority\":\"medium\",\"file\":\"src/file_upload.py\",\"line\":1,\"description\":\"Lack of input validation and error handling in file operations\",\"recommendation\":\"Implement proper input validation, error handling, and logging for all file operations.\"},{\"type\":\"ai_suggestion\",\"category\":\"Maintainability\",\"priority\":\"medium\",\"file\":\"src/user_auth.py\",\"line\":1,\"description\":\"Lack of proper error handling and logging in authentication functions\",\"recommendation\":\"Implement proper error handling, logging, and security event auditing for all authentication-related functions.\"}],\"summary\":{\"total_findings\":21,\"high_priority\":16,\"medium_priority\":5,\"low_priority\":0}},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"305be4c6-9ff3-4077-93f5-a11917966695\"],\"Content-Length\":[\"6524\"],\"Date\":[\"Sat, 28 Jun 2025 08:11:58 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=6a7d674b55504166;Sampled=0;Lineage=2:c73855c7:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"6524\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:11:58 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"305be4c6-9ff3-4077-93f5-a11917966695\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=6a7d674b55504166;Sampled=0;Lineage=2:c73855c7:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"305be4c6-9ff3-4077-93f5-a11917966695\"},\"StatusCode\":200}]}","inputDetails":{"truncated":false},"name":"AggregateResults"},"timestamp":"2025-06-28T08:11:58.147Z","type":"TaskStateEntered","redriveId":0,"stepName":"AggregateResults"},{"id":28,"previousEventId":27,"taskScheduledEventDetails":{"parameters":{"FunctionName":"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-AggregatorFunction-Y2rymTfjXt28","Payload":{"repo_details":{"pull_request_id":"2625925773","repository_full_name":"belumume/sentinel-testbed","commit_sha":"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f","pr_number":32},"analysis_types":[{"type":"secrets","function_name":"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-SecretScannerFunction-w0XQI2GV65HU","payload":{"repo_details":{"pull_request_id":"2625925773","repository_full_name":"belumume/sentinel-testbed","commit_sha":"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f","pr_number":32}}},{"type":"vulnerabilities","function_name":"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-VulnerabilityScannerFunction-Fk7ek2H2Mdqn","payload":{"repo_details":{"pull_request_id":"2625925773","repository_full_name":"belumume/sentinel-testbed","commit_sha":"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f","pr_number":32}}},{"type":"ai_review","function_name":"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-AIReviewerFunction-O4EWbVoTnbOd","payload":{"repo_details":{"pull_request_id":"2625925773","repository_full_name":"belumume/sentinel-testbed","commit_sha":"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f","pr_number":32}}}],"scan_results":[{"ExecutedVersion":"$LATEST","Payload":{"statusCode":200,"scanner_type":"secrets","findings":[{"type":"API Key (Pattern Match)","file":"test-production-v2.txt","line":3,"raw":"sk-1234567890abcdef1234567890abcdef12345678"},{"type":"GitHub Token (Pattern Match)","file":"test-production-v2.txt","line":4,"raw":"ghp_1234567890abcdef1234567890abcdef1234"},{"type":"AWS Secret Key (Pattern Match)","file":"test-production-v2.txt","line":5,"raw":"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY"},{"type":"API Key (Pattern Match)","file":"test-production.txt","line":3,"raw":"sk-1234567890abcdef1234567890abcdef12345678"},{"type":"GitHub Token (Pattern Match)","file":"test-production.txt","line":4,"raw":"ghp_1234567890abcdef1234567890abcdef1234"},{"type":"API Key (Pattern Match)","file":"Dockerfile","line":15,"raw":"sk_test_1234567890abcdef"},{"type":"Database Password (Pattern Match)","file":"Dockerfile","line":16,"raw":"supersecret123"},{"type":"Database Password (Pattern Match)","file":"Dockerfile","line":16,"raw":"supersecret123"},{"type":"Database Password (Pattern Match)","file":".env.example","line":2,"raw":"another_secret_password_123"},{"type":"Database Password (Pattern Match)","file":".env.example","line":2,"raw":"another_secret_password_123"},{"type":"Connection String (Pattern Match)","file":".env.example","line":3,"raw":"postgresql://user:secret123@localhost:5432/mydb"},{"type":"API Key (Pattern Match)","file":".env.example","line":6,"raw":"sk-1234567890abcdefghijklmnopqrstuvwxyz1234567890a..."},{"type":"OpenAI API Key (Pattern Match)","file":".env.example","line":6,"raw":"sk-1234567890abcdefghijklmnopqrstuvwxyz1234567890a..."},{"type":"JWT Secret (Pattern Match)","file":".env.example","line":10,"raw":"my_super_secret_jwt_key_that_should_not_be_hardcod..."},{"type":"API Key (Pattern Match)","file":"README.md","line":6,"raw":"sk_test_1234567890abcdef"},{"type":"AWS Access Key (Pattern Match)","file":"config/database.py","line":15,"raw":"AKIAIOSFODNN7EXAMPLE"},{"type":"AWS Secret Key (Pattern Match)","file":"config/database.py","line":16,"raw":"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY"},{"type":"Secret Key (Pattern Match)","file":"config/database.py","line":19,"raw":"sk_test_4eC39HqLyjWDarjtT1zdp7dc"},{"type":"Stripe Test Key (Pattern Match)","file":"config/database.py","line":19,"raw":"sk_test_4eC39HqLyjWDarjtT1zdp7dc"},{"type":"GitHub Token (Pattern Match)","file":"config/database.py","line":20,"raw":"ghp_1234567890abcdefghijklmnopqrstuvwxyz"},{"type":"Database Password (Pattern Match)","file":"config/database.py","line":29,"raw":"DATABASE_CONFIG["},{"type":"Database Password (Pattern Match)","file":"src/user_auth.py","line":15,"raw":"{self.hash_password(password)}"}],"summary":{"total_findings":22}},"SdkHttpMetadata":{"AllHttpHeaders":{"X-Amz-Executed-Version":["$LATEST"],"x-amzn-Remapped-Content-Length":["0"],"Connection":["keep-alive"],"x-amzn-RequestId":["d13672c8-f96d-4a9c-a382-6944b79168ac"],"Content-Length":["2886"],"Date":["Sat, 28 Jun 2025 08:11:39 GMT"],"X-Amzn-Trace-Id":["Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=5e0356b90ed3a285;Sampled=0;Lineage=2:06d0fbab:0"],"Content-Type":["application/json"]},"HttpHeaders":{"Connection":"keep-alive","Content-Length":"2886","Content-Type":"application/json","Date":"Sat, 28 Jun 2025 08:11:39 GMT","X-Amz-Executed-Version":"$LATEST","x-amzn-Remapped-Content-Length":"0","x-amzn-RequestId":"d13672c8-f96d-4a9c-a382-6944b79168ac","X-Amzn-Trace-Id":"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=5e0356b90ed3a285;Sampled=0;Lineage=2:06d0fbab:0"},"HttpStatusCode":200},"SdkResponseMetadata":{"RequestId":"d13672c8-f96d-4a9c-a382-6944b79168ac"},"StatusCode":200},{"ExecutedVersion":"$LATEST","Payload":{"statusCode":200,"scanner_type":"vulnerabilities","findings":[],"summary":{"total_findings":0,"by_severity":{},"by_language":{}}},"SdkHttpMetadata":{"AllHttpHeaders":{"X-Amz-Executed-Version":["$LATEST"],"x-amzn-Remapped-Content-Length":["0"],"Connection":["keep-alive"],"x-amzn-RequestId":["0f8f7504-f819-429a-bce4-4c7615c218a3"],"Content-Length":["142"],"Date":["Sat, 28 Jun 2025 08:11:23 GMT"],"X-Amzn-Trace-Id":["Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=0fe9df82f88a24aa;Sampled=0;Lineage=2:9da352f3:0"],"Content-Type":["application/json"]},"HttpHeaders":{"Connection":"keep-alive","Content-Length":"142","Content-Type":"application/json","Date":"Sat, 28 Jun 2025 08:11:23 GMT","X-Amz-Executed-Version":"$LATEST","x-amzn-Remapped-Content-Length":"0","x-amzn-RequestId":"0f8f7504-f819-429a-bce4-4c7615c218a3","X-Amzn-Trace-Id":"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=0fe9df82f88a24aa;Sampled=0;Lineage=2:9da352f3:0"},"HttpStatusCode":200},"SdkResponseMetadata":{"RequestId":"0f8f7504-f819-429a-bce4-4c7615c218a3"},"StatusCode":200},{"ExecutedVersion":"$LATEST","Payload":{"statusCode":200,"scanner_type":"ai_review","findings":[{"type":"ai_suggestion","category":"Security","priority":"high","file":".env.example","line":1,"description":"Sensitive information exposed in .env.example file","recommendation":"Remove all real API keys, passwords, and secrets from .env.example. Use placeholder values instead."},{"type":"ai_suggestion","category":"Security","priority":"high","file":"Dockerfile","line":15,"description":"Sensitive environment variables hardcoded in Dockerfile","recommendation":"Remove API_KEY and DB_PASSWORD from Dockerfile. Use environment variables or secrets management instead."},{"type":"ai_suggestion","category":"Security","priority":"high","file":"README.md","line":6,"description":"API key exposed in README file","recommendation":"Remove the API_KEY from the README file. Never commit sensitive information to version control."},{"type":"ai_suggestion","category":"Security","priority":"high","file":"config/database.py","line":9,"description":"Hardcoded database credentials in source code","recommendation":"Remove hardcoded credentials and use environment variables or a secure configuration management system."},{"type":"ai_suggestion","category":"Security","priority":"high","file":"config/database.py","line":15,"description":"AWS credentials exposed in source code","recommendation":"Remove AWS credentials from source code. Use AWS IAM roles or environment variables instead."},{"type":"ai_suggestion","category":"Security","priority":"high","file":"config/database.py","line":19,"description":"Stripe and GitHub tokens exposed in source code","recommendation":"Remove Stripe and GitHub tokens from source code. Use environment variables or a secure secret management system."},{"type":"ai_suggestion","category":"Security","priority":"high","file":"src/file_upload.py","line":24,"description":"Arbitrary code execution vulnerability in file upload","recommendation":"Remove the os.system call. Never execute uploaded files directly. Implement proper file validation and sandboxing."},{"type":"ai_suggestion","category":"Security","priority":"high","file":"src/file_upload.py","line":33,"description":"Path traversal vulnerability in file download","recommendation":"Validate and sanitize the filename to prevent path traversal attacks. Use os.path.basename() and restrict to a specific directory."},{"type":"ai_suggestion","category":"Security","priority":"high","file":"src/user_auth.py","line":15,"description":"SQL injection vulnerability in authentication query","recommendation":"Use parameterized queries instead of string formatting to prevent SQL injection attacks."},{"type":"ai_suggestion","category":"Security","priority":"high","file":"src/user_auth.py","line":32,"description":"Weak password hashing algorithm (MD5)","recommendation":"Replace MD5 with a strong, modern hashing algorithm like bcrypt, Argon2, or PBKDF2."},{"type":"ai_suggestion","category":"Security","priority":"high","file":"src/user_auth.py","line":40,"description":"SQL injection vulnerability in password reset functionality","recommendation":"Use parameterized queries instead of string formatting to prevent SQL injection attacks."},{"type":"ai_suggestion","category":"Security","priority":"high","file":"src/user_auth.py","line":48,"description":"Insecure admin access check using request headers","recommendation":"Remove the header-based admin override. Implement proper authentication and authorization checks."},{"type":"ai_suggestion","category":"Security","priority":"high","file":"test-production-v2.txt","line":3,"description":"Sensitive API keys and tokens exposed in plain text file","recommendation":"Remove all API keys, tokens, and secrets from this file. Use environment variables or a secure secrets management system."},{"type":"ai_suggestion","category":"Security","priority":"high","file":"test-production.txt","line":3,"description":"Sensitive API keys and tokens exposed in plain text file","recommendation":"Remove all API keys and tokens from this file. Use environment variables or a secure secrets management system."},{"type":"ai_suggestion","category":"Best Practices","priority":"medium","file":"Dockerfile","line":3,"description":"Using outdated Ubuntu base image","recommendation":"Update to a more recent Ubuntu LTS version or consider using a more lightweight base image like Alpine."},{"type":"ai_suggestion","category":"Security","priority":"medium","file":"Dockerfile","line":6,"description":"Running container as root user","recommendation":"Create a non-root user and use the USER instruction to run the container with least privileges."},{"type":"ai_suggestion","category":"Security","priority":"medium","file":"Dockerfile","line":26,"description":"Unnecessary ports exposed in Dockerfile","recommendation":"Only expose the ports that are actually needed for the application to function."},{"type":"ai_suggestion","category":"Security","priority":"high","file":"package.json","line":1,"description":"Multiple outdated dependencies with known vulnerabilities","recommendation":"Update all dependencies to their latest secure versions, especially lodash, moment, express, mongoose, and others."},{"type":"ai_suggestion","category":"Security","priority":"high","file":"requirements.txt","line":1,"description":"Multiple outdated Python dependencies with known vulnerabilities","recommendation":"Update all dependencies to their latest secure versions, especially Django, requests, PyYAML, urllib3, Flask, and others."},{"type":"ai_suggestion","category":"Maintainability","priority":"medium","file":"src/file_upload.py","line":1,"description":"Lack of input validation and error handling in file operations","recommendation":"Implement proper input validation, error handling, and logging for all file operations."},{"type":"ai_suggestion","category":"Maintainability","priority":"medium","file":"src/user_auth.py","line":1,"description":"Lack of proper error handling and logging in authentication functions","recommendation":"Implement proper error handling, logging, and security event auditing for all authentication-related functions."}],"summary":{"total_findings":21,"high_priority":16,"medium_priority":5,"low_priority":0}},"SdkHttpMetadata":{"AllHttpHeaders":{"X-Amz-Executed-Version":["$LATEST"],"x-amzn-Remapped-Content-Length":["0"],"Connection":["keep-alive"],"x-amzn-RequestId":["305be4c6-9ff3-4077-93f5-a11917966695"],"Content-Length":["6524"],"Date":["Sat, 28 Jun 2025 08:11:58 GMT"],"X-Amzn-Trace-Id":["Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=6a7d674b55504166;Sampled=0;Lineage=2:c73855c7:0"],"Content-Type":["application/json"]},"HttpHeaders":{"Connection":"keep-alive","Content-Length":"6524","Content-Type":"application/json","Date":"Sat, 28 Jun 2025 08:11:58 GMT","X-Amz-Executed-Version":"$LATEST","x-amzn-Remapped-Content-Length":"0","x-amzn-RequestId":"305be4c6-9ff3-4077-93f5-a11917966695","X-Amzn-Trace-Id":"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=6a7d674b55504166;Sampled=0;Lineage=2:c73855c7:0"},"HttpStatusCode":200},"SdkResponseMetadata":{"RequestId":"305be4c6-9ff3-4077-93f5-a11917966695"},"StatusCode":200}]}},"region":"us-east-1","resource":"invoke","resourceType":"lambda"},"timestamp":"2025-06-28T08:11:58.147Z","type":"TaskScheduled","redriveId":0,"stepName":"AggregateResults"},{"id":29,"previousEventId":28,"taskStartedEventDetails":{"resource":"invoke","resourceType":"lambda"},"timestamp":"2025-06-28T08:11:58.236Z","type":"TaskStarted","redriveId":0,"stepName":"AggregateResults"},{"id":30,"previousEventId":29,"taskSucceededEventDetails":{"output":"{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"aggregation_complete\":true,\"findings_summary\":{\"secrets_found\":22,\"vulnerabilities_found\":0,\"ai_suggestions\":21},\"github_comment_posted\":true},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"4a4c99d8-b8ff-4451-84ec-783a29b803f5\"],\"Content-Length\":[\"173\"],\"Date\":[\"Sat, 28 Jun 2025 08:12:00 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=2ef7bb7fce192f6a;Sampled=0;Lineage=2:d0648a6a:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"173\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:12:00 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"4a4c99d8-b8ff-4451-84ec-783a29b803f5\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=2ef7bb7fce192f6a;Sampled=0;Lineage=2:d0648a6a:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"4a4c99d8-b8ff-4451-84ec-783a29b803f5\"},\"StatusCode\":200}","outputDetails":{"truncated":false},"resource":"invoke","resourceType":"lambda"},"timestamp":"2025-06-28T08:12:00.311Z","type":"TaskSucceeded","redriveId":0,"stepName":"AggregateResults"},{"id":31,"previousEventId":30,"stateExitedEventDetails":{"name":"AggregateResults","output":"{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"statusCode\":200,\"aggregation_complete\":true,\"findings_summary\":{\"secrets_found\":22,\"vulnerabilities_found\":0,\"ai_suggestions\":21},\"github_comment_posted\":true},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"4a4c99d8-b8ff-4451-84ec-783a29b803f5\"],\"Content-Length\":[\"173\"],\"Date\":[\"Sat, 28 Jun 2025 08:12:00 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=2ef7bb7fce192f6a;Sampled=0;Lineage=2:d0648a6a:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"173\",\"Content-Type\":\"application/json\",\"Date\":\"Sat, 28 Jun 2025 08:12:00 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"4a4c99d8-b8ff-4451-84ec-783a29b803f5\",\"X-Amzn-Trace-Id\":\"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=2ef7bb7fce192f6a;Sampled=0;Lineage=2:d0648a6a:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"4a4c99d8-b8ff-4451-84ec-783a29b803f5\"},\"StatusCode\":200}","outputDetails":{"truncated":false}},"timestamp":"2025-06-28T08:12:00.342Z","type":"TaskStateExited","redriveId":0,"stepName":"AggregateResults"}],"redriveCount":0,"availableVariables":{},"resource":{"parameters":{"FunctionName":"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-AggregatorFunction-Y2rymTfjXt28","Payload":{"repo_details":{"pull_request_id":"2625925773","repository_full_name":"belumume/sentinel-testbed","commit_sha":"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f","pr_number":32},"analysis_types":[{"type":"secrets","function_name":"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-SecretScannerFunction-w0XQI2GV65HU","payload":{"repo_details":{"pull_request_id":"2625925773","repository_full_name":"belumume/sentinel-testbed","commit_sha":"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f","pr_number":32}}},{"type":"vulnerabilities","function_name":"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-VulnerabilityScannerFunction-Fk7ek2H2Mdqn","payload":{"repo_details":{"pull_request_id":"2625925773","repository_full_name":"belumume/sentinel-testbed","commit_sha":"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f","pr_number":32}}},{"type":"ai_review","function_name":"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-AIReviewerFunction-O4EWbVoTnbOd","payload":{"repo_details":{"pull_request_id":"2625925773","repository_full_name":"belumume/sentinel-testbed","commit_sha":"ba67c8c5d09c1c53353a1323ed400f0e0476fb6f","pr_number":32}}}],"scan_results":[{"ExecutedVersion":"$LATEST","Payload":{"statusCode":200,"scanner_type":"secrets","findings":[{"type":"API Key (Pattern Match)","file":"test-production-v2.txt","line":3,"raw":"sk-1234567890abcdef1234567890abcdef12345678"},{"type":"GitHub Token (Pattern Match)","file":"test-production-v2.txt","line":4,"raw":"ghp_1234567890abcdef1234567890abcdef1234"},{"type":"AWS Secret Key (Pattern Match)","file":"test-production-v2.txt","line":5,"raw":"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY"},{"type":"API Key (Pattern Match)","file":"test-production.txt","line":3,"raw":"sk-1234567890abcdef1234567890abcdef12345678"},{"type":"GitHub Token (Pattern Match)","file":"test-production.txt","line":4,"raw":"ghp_1234567890abcdef1234567890abcdef1234"},{"type":"API Key (Pattern Match)","file":"Dockerfile","line":15,"raw":"sk_test_1234567890abcdef"},{"type":"Database Password (Pattern Match)","file":"Dockerfile","line":16,"raw":"supersecret123"},{"type":"Database Password (Pattern Match)","file":"Dockerfile","line":16,"raw":"supersecret123"},{"type":"Database Password (Pattern Match)","file":".env.example","line":2,"raw":"another_secret_password_123"},{"type":"Database Password (Pattern Match)","file":".env.example","line":2,"raw":"another_secret_password_123"},{"type":"Connection String (Pattern Match)","file":".env.example","line":3,"raw":"postgresql://user:secret123@localhost:5432/mydb"},{"type":"API Key (Pattern Match)","file":".env.example","line":6,"raw":"sk-1234567890abcdefghijklmnopqrstuvwxyz1234567890a..."},{"type":"OpenAI API Key (Pattern Match)","file":".env.example","line":6,"raw":"sk-1234567890abcdefghijklmnopqrstuvwxyz1234567890a..."},{"type":"JWT Secret (Pattern Match)","file":".env.example","line":10,"raw":"my_super_secret_jwt_key_that_should_not_be_hardcod..."},{"type":"API Key (Pattern Match)","file":"README.md","line":6,"raw":"sk_test_1234567890abcdef"},{"type":"AWS Access Key (Pattern Match)","file":"config/database.py","line":15,"raw":"AKIAIOSFODNN7EXAMPLE"},{"type":"AWS Secret Key (Pattern Match)","file":"config/database.py","line":16,"raw":"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY"},{"type":"Secret Key (Pattern Match)","file":"config/database.py","line":19,"raw":"sk_test_4eC39HqLyjWDarjtT1zdp7dc"},{"type":"Stripe Test Key (Pattern Match)","file":"config/database.py","line":19,"raw":"sk_test_4eC39HqLyjWDarjtT1zdp7dc"},{"type":"GitHub Token (Pattern Match)","file":"config/database.py","line":20,"raw":"ghp_1234567890abcdefghijklmnopqrstuvwxyz"},{"type":"Database Password (Pattern Match)","file":"config/database.py","line":29,"raw":"DATABASE_CONFIG["},{"type":"Database Password (Pattern Match)","file":"src/user_auth.py","line":15,"raw":"{self.hash_password(password)}"}],"summary":{"total_findings":22}},"SdkHttpMetadata":{"AllHttpHeaders":{"X-Amz-Executed-Version":["$LATEST"],"x-amzn-Remapped-Content-Length":["0"],"Connection":["keep-alive"],"x-amzn-RequestId":["d13672c8-f96d-4a9c-a382-6944b79168ac"],"Content-Length":["2886"],"Date":["Sat, 28 Jun 2025 08:11:39 GMT"],"X-Amzn-Trace-Id":["Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=5e0356b90ed3a285;Sampled=0;Lineage=2:06d0fbab:0"],"Content-Type":["application/json"]},"HttpHeaders":{"Connection":"keep-alive","Content-Length":"2886","Content-Type":"application/json","Date":"Sat, 28 Jun 2025 08:11:39 GMT","X-Amz-Executed-Version":"$LATEST","x-amzn-Remapped-Content-Length":"0","x-amzn-RequestId":"d13672c8-f96d-4a9c-a382-6944b79168ac","X-Amzn-Trace-Id":"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=5e0356b90ed3a285;Sampled=0;Lineage=2:06d0fbab:0"},"HttpStatusCode":200},"SdkResponseMetadata":{"RequestId":"d13672c8-f96d-4a9c-a382-6944b79168ac"},"StatusCode":200},{"ExecutedVersion":"$LATEST","Payload":{"statusCode":200,"scanner_type":"vulnerabilities","findings":[],"summary":{"total_findings":0,"by_severity":{},"by_language":{}}},"SdkHttpMetadata":{"AllHttpHeaders":{"X-Amz-Executed-Version":["$LATEST"],"x-amzn-Remapped-Content-Length":["0"],"Connection":["keep-alive"],"x-amzn-RequestId":["0f8f7504-f819-429a-bce4-4c7615c218a3"],"Content-Length":["142"],"Date":["Sat, 28 Jun 2025 08:11:23 GMT"],"X-Amzn-Trace-Id":["Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=0fe9df82f88a24aa;Sampled=0;Lineage=2:9da352f3:0"],"Content-Type":["application/json"]},"HttpHeaders":{"Connection":"keep-alive","Content-Length":"142","Content-Type":"application/json","Date":"Sat, 28 Jun 2025 08:11:23 GMT","X-Amz-Executed-Version":"$LATEST","x-amzn-Remapped-Content-Length":"0","x-amzn-RequestId":"0f8f7504-f819-429a-bce4-4c7615c218a3","X-Amzn-Trace-Id":"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=0fe9df82f88a24aa;Sampled=0;Lineage=2:9da352f3:0"},"HttpStatusCode":200},"SdkResponseMetadata":{"RequestId":"0f8f7504-f819-429a-bce4-4c7615c218a3"},"StatusCode":200},{"ExecutedVersion":"$LATEST","Payload":{"statusCode":200,"scanner_type":"ai_review","findings":[{"type":"ai_suggestion","category":"Security","priority":"high","file":".env.example","line":1,"description":"Sensitive information exposed in .env.example file","recommendation":"Remove all real API keys, passwords, and secrets from .env.example. Use placeholder values instead."},{"type":"ai_suggestion","category":"Security","priority":"high","file":"Dockerfile","line":15,"description":"Sensitive environment variables hardcoded in Dockerfile","recommendation":"Remove API_KEY and DB_PASSWORD from Dockerfile. Use environment variables or secrets management instead."},{"type":"ai_suggestion","category":"Security","priority":"high","file":"README.md","line":6,"description":"API key exposed in README file","recommendation":"Remove the API_KEY from the README file. Never commit sensitive information to version control."},{"type":"ai_suggestion","category":"Security","priority":"high","file":"config/database.py","line":9,"description":"Hardcoded database credentials in source code","recommendation":"Remove hardcoded credentials and use environment variables or a secure configuration management system."},{"type":"ai_suggestion","category":"Security","priority":"high","file":"config/database.py","line":15,"description":"AWS credentials exposed in source code","recommendation":"Remove AWS credentials from source code. Use AWS IAM roles or environment variables instead."},{"type":"ai_suggestion","category":"Security","priority":"high","file":"config/database.py","line":19,"description":"Stripe and GitHub tokens exposed in source code","recommendation":"Remove Stripe and GitHub tokens from source code. Use environment variables or a secure secret management system."},{"type":"ai_suggestion","category":"Security","priority":"high","file":"src/file_upload.py","line":24,"description":"Arbitrary code execution vulnerability in file upload","recommendation":"Remove the os.system call. Never execute uploaded files directly. Implement proper file validation and sandboxing."},{"type":"ai_suggestion","category":"Security","priority":"high","file":"src/file_upload.py","line":33,"description":"Path traversal vulnerability in file download","recommendation":"Validate and sanitize the filename to prevent path traversal attacks. Use os.path.basename() and restrict to a specific directory."},{"type":"ai_suggestion","category":"Security","priority":"high","file":"src/user_auth.py","line":15,"description":"SQL injection vulnerability in authentication query","recommendation":"Use parameterized queries instead of string formatting to prevent SQL injection attacks."},{"type":"ai_suggestion","category":"Security","priority":"high","file":"src/user_auth.py","line":32,"description":"Weak password hashing algorithm (MD5)","recommendation":"Replace MD5 with a strong, modern hashing algorithm like bcrypt, Argon2, or PBKDF2."},{"type":"ai_suggestion","category":"Security","priority":"high","file":"src/user_auth.py","line":40,"description":"SQL injection vulnerability in password reset functionality","recommendation":"Use parameterized queries instead of string formatting to prevent SQL injection attacks."},{"type":"ai_suggestion","category":"Security","priority":"high","file":"src/user_auth.py","line":48,"description":"Insecure admin access check using request headers","recommendation":"Remove the header-based admin override. Implement proper authentication and authorization checks."},{"type":"ai_suggestion","category":"Security","priority":"high","file":"test-production-v2.txt","line":3,"description":"Sensitive API keys and tokens exposed in plain text file","recommendation":"Remove all API keys, tokens, and secrets from this file. Use environment variables or a secure secrets management system."},{"type":"ai_suggestion","category":"Security","priority":"high","file":"test-production.txt","line":3,"description":"Sensitive API keys and tokens exposed in plain text file","recommendation":"Remove all API keys and tokens from this file. Use environment variables or a secure secrets management system."},{"type":"ai_suggestion","category":"Best Practices","priority":"medium","file":"Dockerfile","line":3,"description":"Using outdated Ubuntu base image","recommendation":"Update to a more recent Ubuntu LTS version or consider using a more lightweight base image like Alpine."},{"type":"ai_suggestion","category":"Security","priority":"medium","file":"Dockerfile","line":6,"description":"Running container as root user","recommendation":"Create a non-root user and use the USER instruction to run the container with least privileges."},{"type":"ai_suggestion","category":"Security","priority":"medium","file":"Dockerfile","line":26,"description":"Unnecessary ports exposed in Dockerfile","recommendation":"Only expose the ports that are actually needed for the application to function."},{"type":"ai_suggestion","category":"Security","priority":"high","file":"package.json","line":1,"description":"Multiple outdated dependencies with known vulnerabilities","recommendation":"Update all dependencies to their latest secure versions, especially lodash, moment, express, mongoose, and others."},{"type":"ai_suggestion","category":"Security","priority":"high","file":"requirements.txt","line":1,"description":"Multiple outdated Python dependencies with known vulnerabilities","recommendation":"Update all dependencies to their latest secure versions, especially Django, requests, PyYAML, urllib3, Flask, and others."},{"type":"ai_suggestion","category":"Maintainability","priority":"medium","file":"src/file_upload.py","line":1,"description":"Lack of input validation and error handling in file operations","recommendation":"Implement proper input validation, error handling, and logging for all file operations."},{"type":"ai_suggestion","category":"Maintainability","priority":"medium","file":"src/user_auth.py","line":1,"description":"Lack of proper error handling and logging in authentication functions","recommendation":"Implement proper error handling, logging, and security event auditing for all authentication-related functions."}],"summary":{"total_findings":21,"high_priority":16,"medium_priority":5,"low_priority":0}},"SdkHttpMetadata":{"AllHttpHeaders":{"X-Amz-Executed-Version":["$LATEST"],"x-amzn-Remapped-Content-Length":["0"],"Connection":["keep-alive"],"x-amzn-RequestId":["305be4c6-9ff3-4077-93f5-a11917966695"],"Content-Length":["6524"],"Date":["Sat, 28 Jun 2025 08:11:58 GMT"],"X-Amzn-Trace-Id":["Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=6a7d674b55504166;Sampled=0;Lineage=2:c73855c7:0"],"Content-Type":["application/json"]},"HttpHeaders":{"Connection":"keep-alive","Content-Length":"6524","Content-Type":"application/json","Date":"Sat, 28 Jun 2025 08:11:58 GMT","X-Amz-Executed-Version":"$LATEST","x-amzn-Remapped-Content-Length":"0","x-amzn-RequestId":"305be4c6-9ff3-4077-93f5-a11917966695","X-Amzn-Trace-Id":"Root=1-685fa3ab-535cd3d725b0cb3a37fa4c04;Parent=6a7d674b55504166;Sampled=0;Lineage=2:c73855c7:0"},"HttpStatusCode":200},"SdkResponseMetadata":{"RequestId":"305be4c6-9ff3-4077-93f5-a11917966695"},"StatusCode":200}]}},"region":"us-east-1","resource":"invoke","resourceType":"lambda"},"meta":{"id":7,"expandable":false,"expanded":false,"matched":true,"lastChild":true,"hasDisplayedChildren":false,"path":"[\"AggregateResults\"]"}}}}},"stateMachine":{"$metadata":{"httpStatusCode":200,"requestId":"c50cf986-c50c-4246-b046-dbd3fbd1f33b","attempts":1,"totalRetryDelay":0},"definition":"{\n    \"Comment\": \"State machine for orchestrating DevSecOps Sentinel scans.\",\n    \"StartAt\": \"ParallelScans\",\n    \"States\": {\n        \"AggregateResults\": {\n            \"End\": true,\n            \"Parameters\": {\n                \"FunctionName\": \"arn:aws:lambda:us-east-1:390402580689:function:devsecops-sentinel-AggregatorFunction-Y2rymTfjXt28\",\n                \"Payload.$\": \"$\"\n            },\n            \"Resource\": \"arn:aws:states:::lambda:invoke\",\n            \"Type\": \"Task\"\n        },\n        \"ParallelScans\": {\n            \"ItemsPath\": \"$.analysis_types\",\n            \"Iterator\": {\n                \"StartAt\": \"RunScanner\",\n                \"States\": {\n                    \"RunScanner\": {\n                        \"End\": true,\n                        \"Parameters\": {\n                            \"FunctionName.$\": \"$.function_name\",\n                            \"Payload.$\": \"$.payload\"\n                        },\n                        \"Resource\": \"arn:aws:states:::lambda:invoke\",\n                        \"Type\": \"Task\"\n                    }\n                }\n            },\n            \"Next\": \"AggregateResults\",\n            \"ResultPath\": \"$.scan_results\",\n            \"Type\": \"Map\"\n        }\n    }\n}","encryptionConfiguration":{"__type":"com.amazonaws.swf.base.model#EncryptionConfiguration","type":"AWS_OWNED_KEY"},"loggingConfiguration":{"__type":"com.amazonaws.swf.base.model#LoggingConfiguration","includeExecutionData":false,"level":"OFF"},"name":"AnalysisStateMachine-zuJ7oO11tsut","revisionId":"cf2d5f21-f585-44ce-947a-c306c20f50b4","roleArn":"arn:aws:iam::390402580689:role/devsecops-sentinel-StateMachineRole-pLZD37MpMyDm","stateMachineArn":"arn:aws:states:us-east-1:390402580689:stateMachine:AnalysisStateMachine-zuJ7oO11tsut","tracingConfiguration":{"__type":"com.amazonaws.swf.base.model#TracingConfiguration","enabled":false},"updateDate":"2025-06-12T16:49:49.232Z"},"status":"3","transitionCount":7,"eventCount":32,"type":"standard","eventStatus":1,"hasDistributedMap":false,"isChildExecutionOfDistributedMap":false,"isExecutionRedriven":false,"queryLanguage":"JSONPath","executionArn":"arn:aws:states:us-east-1:390402580689:execution:AnalysisStateMachine-zuJ7oO11tsut:pr-belumume-sentinel-testbed-32-ba67c8c","variablesSnapshot":{"[]":{},"[\"ParallelScans\"]":{},"[\"ParallelScans\",\"0\"]":{},"[\"ParallelScans\",\"1\"]":{},"[\"ParallelScans\",\"2\"]":{}}}